<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>文字型</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.5文書"
HREF="index.html"><LINK
REL="UP"
TITLE="データ型"
HREF="datatype.html"><LINK
REL="PREVIOUS"
TITLE="通貨型"
HREF="datatype-money.html"><LINK
REL="NEXT"
TITLE="バイナリ列データ型"
HREF="datatype-binary.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2018-02-10T07:29:51"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.5文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="通貨型"
HREF="datatype-money.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="datatype.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 8章データ型</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="バイナリ列データ型"
HREF="datatype-binary.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="DATATYPE-CHARACTER"
>8.3. 文字型</A
></H1
><DIV
CLASS="TABLE"
><A
NAME="DATATYPE-CHARACTER-TABLE"
></A
><P
><B
>表 8-4. 文字型</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
>型名</TH
><TH
>説明</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="TYPE"
>character varying(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>, <TT
CLASS="TYPE"
>varchar(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
></TD
><TD
>上限付き可変長</TD
></TR
><TR
><TD
><TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>, <TT
CLASS="TYPE"
>char(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
></TD
><TD
>空白で埋められた固定長</TD
></TR
><TR
><TD
><TT
CLASS="TYPE"
>text</TT
></TD
><TD
>制限なし可変長</TD
></TR
></TBODY
></TABLE
></DIV
><P
><A
HREF="datatype-character.html#DATATYPE-CHARACTER-TABLE"
>表8-4</A
>は<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>で使用可能な汎用文字型を示したものです。
   </P
><P
><ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>は2つの主要な文字データ型を定義しています。
<TT
CLASS="TYPE"
>character varying(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>と<TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>です。
ここで<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>は正の整数です。
これらのデータ型は2つとも<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>文字長（バイト数ではなく）までの文字列を保存できます。
上限を越えた文字列をこれらの型の列に保存しようとするとエラーになります。
ただし、上限を超えた部分にある文字がすべて空白の場合はエラーにはならず、文字列の最大長にまで切り詰められます。
（この一風変わった例外は標準<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>で要求されています。）
もし宣言された上限よりも文字列が短い時は<TT
CLASS="TYPE"
>character</TT
>の値は空白で埋められ、<TT
CLASS="TYPE"
>character varying</TT
>の値は単にその短い文字列で保存されます。
   </P
><P
>明示的に値を<TT
CLASS="TYPE"
>character varying(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>または<TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>にキャストした場合、指定長を超えるとエラーなしで<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>文字まで切り詰められます。
（これもまた標準<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>の仕様です。）
   </P
><P
><TT
CLASS="TYPE"
>char(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>および<TT
CLASS="TYPE"
>varchar(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>という表記法はそれぞれ<TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>と<TT
CLASS="TYPE"
>character varying(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>の別名です。
長さ指定がない<TT
CLASS="TYPE"
>character</TT
>は<TT
CLASS="TYPE"
>character(1)</TT
>と同じです。
<TT
CLASS="TYPE"
>character varying</TT
>が長さ指定なしで使われた時は、いかなる長さの文字列でも受け付けます。
後者は<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の拡張です。
   </P
><P
>さらに<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>は、いかなる長さの文字列でも格納できる<TT
CLASS="TYPE"
>text</TT
>をサポートします。
<TT
CLASS="TYPE"
>text</TT
>型は標準<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>にはありませんが、多くの他のSQLデータベース管理システムも同様にサポートしています。
   </P
><P
><TT
CLASS="TYPE"
>character</TT
>型の値は、指定長<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>になるまで物理的に空白で埋められ、そのまま格納、表示されます。
しかし、最後の空白は、重要ではないものとして扱われ、2つの<TT
CLASS="TYPE"
>character</TT
>型の値を比べる際には無視されます。
空白が重要な照合順序では、この挙動は予期しない結果を返す可能性があります。例えば、<TT
CLASS="COMMAND"
>SELECT 'a '::CHAR(2) collate "C" &lt; E'a\n'::CHAR(2)</TT
>は<TT
CLASS="LITERAL"
>C</TT
>ロケールでスペースが改行よりも大きいにも関わらず真を返します。
<TT
CLASS="TYPE"
>character</TT
>値を他の文字列型に変換する際は、文字列の終わりの空白は除去されます。
<TT
CLASS="TYPE"
>character varying</TT
>型と<TT
CLASS="TYPE"
>text</TT
>型の値の中や、パターンマッチを行なう際、すなわち<TT
CLASS="LITERAL"
>LIKE</TT
>や正規表現では、最後の空白は意味的に重要なもの<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>です</I
></SPAN
>ので、注意してください。
   </P
><P
>短い文字列（126バイトまで）の保存には、実際の文字列に１バイト加えたサイズが必要です。
<TT
CLASS="TYPE"
>character</TT
>では空白埋め込み分もこれに含まれます。
より長い文字列では１バイトではなく４バイトのオーバーヘッドになります。
長い文字列はシステムにより自動的に圧縮されますので、ディスク上の物理的必要容量サイズはより小さくなるかもしれません。
また、非常に長い値はより短い列の値への高速アクセスに干渉しないように、バックグラウンドテーブルに格納されます。
いずれの場合にあっても保存できる最長の文字列は約1ギガバイトです。
（データ型宣言に使われる<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>に許される最大値はこれより小さいものです。
マルチバイト文字符号化方式においては文字数とバイト数はまったく異なっているため、この値の変更は便利ではありません。
特定の上限を設けずに長い文字列を保存したい場合は、適当な上限を設けるよりも、<TT
CLASS="TYPE"
>text</TT
>もしくは長さの指定がない<TT
CLASS="TYPE"
>character varying</TT
>を使用してください。）
   </P
><DIV
CLASS="TIP"
><BLOCKQUOTE
CLASS="TIP"
><P
><B
>ティップ: </B
>空白で埋められる型を使用した場合の保存領域の増加、および、長さ制限付きの列に格納する際に長さを検査するためにいくつか余計なCPUサイクルが加わる点を別にして、これら3つの型の間で性能に関する差異はありません。
他の一部のデータベースシステムでは<TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>には性能的な優位性がありますが、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>ではこうした利点はありません。
実際には、格納の際に追加のコストがあるため、<TT
CLASS="TYPE"
>character(<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
>)</TT
>は3つの中でもっとも低速です。
多くの場合、代わりに<TT
CLASS="TYPE"
>text</TT
>か<TT
CLASS="TYPE"
>character varying</TT
>を使うのがお薦めです。
    </P
></BLOCKQUOTE
></DIV
><P
>文字列リテラルの構文については<A
HREF="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS"
>項4.1.2.1</A
>、利用可能な演算子と関数については<A
HREF="functions.html"
>第9章</A
>を参照してください。
データベースの文字セットは、テキストの値を格納する時に使用される文字セットを決定します。
文字セットのサポートに関する詳細については<A
HREF="multibyte.html"
>項23.3</A
>を参照してください。
   </P
><DIV
CLASS="EXAMPLE"
><A
NAME="AEN5684"
></A
><P
><B
>例 8-1. 文字データ型の使用</B
></P
><PRE
CLASS="PROGRAMLISTING"
>CREATE TABLE test1 (a character(4));
INSERT INTO test1 VALUES ('ok');
SELECT a, char_length(a) FROM test1; -- <A
NAME="CO.DATATYPE-CHAR"
><B
>(1)</B
></A
>
<SAMP
CLASS="COMPUTEROUTPUT"
>  a   | char_length
------+-------------
 ok   |           2</SAMP
>

CREATE TABLE test2 (b varchar(5));
INSERT INTO test2 VALUES ('ok');
INSERT INTO test2 VALUES ('good      ');
INSERT INTO test2 VALUES ('too long');
<SAMP
CLASS="COMPUTEROUTPUT"
>ERROR:  value too long for type character varying(5)</SAMP
>
INSERT INTO test2 VALUES ('too long'::varchar(5)); -- 明示的な切り捨て
SELECT b, char_length(b) FROM test2;
<SAMP
CLASS="COMPUTEROUTPUT"
>   b   | char_length
-------+-------------
 ok    |           2
 good  |           5
 too l |           5</SAMP
></PRE
><DIV
CLASS="CALLOUTLIST"
><DL
COMPACT="COMPACT"
><DT
><A
HREF="datatype-character.html#CO.DATATYPE-CHAR"
><B
>(1)</B
></A
></DT
><DD
><CODE
CLASS="FUNCTION"
>char_length</CODE
>関数は<A
HREF="functions-string.html"
>項9.4</A
>で説明されています。
      </DD
></DL
></DIV
></DIV
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>には、<A
HREF="datatype-character.html#DATATYPE-CHARACTER-SPECIAL-TABLE"
>表8-5</A
>に示すように、この他2つの固定長文字型があります。
<TT
CLASS="TYPE"
>name</TT
>型は内部のシステムカタログ内の識別子の格納のために<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>のみ</I
></SPAN
>存在するもので、一般ユーザによって使用されることを意図していません。
現在長さは64バイト（63バイトの利用可能文字と終止文字）と定義されていますが、<TT
CLASS="LITERAL"
>C</TT
>ソースコードにある<TT
CLASS="SYMBOL"
>NAMEDATALEN</TT
>定数を使って参照される必要があります。
この長さはコンパイル時に設定されます（そのため特別な用途に合わせ調整できます）。
デフォルトの最大長は今後のリリースで変更される可能性があります。
<TT
CLASS="TYPE"
>"char"</TT
>（二重引用符に注意）は、<TT
CLASS="TYPE"
>char(1)</TT
>とは異なり、1バイトの領域しか使用しません。
過度に単純化した列挙型としてシステムカタログで内部的に使用されます。
   </P
><DIV
CLASS="TABLE"
><A
NAME="DATATYPE-CHARACTER-SPECIAL-TABLE"
></A
><P
><B
>表 8-5. 特別な文字データ型</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
>型名</TH
><TH
>格納サイズ</TH
><TH
>説明</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="TYPE"
>"char"</TT
></TD
><TD
>1バイト</TD
><TD
>単一バイト内部データ型</TD
></TR
><TR
><TD
><TT
CLASS="TYPE"
>name</TT
></TD
><TD
>64バイト</TD
><TD
>オブジェクト名用の内部データ型</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="datatype-money.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="datatype-binary.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>通貨型</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="datatype.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>バイナリ列データ型</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>