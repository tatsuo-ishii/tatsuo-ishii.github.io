<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>リリース9.4</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.0文書"
HREF="index.html"><LINK
REL="UP"
TITLE="リリースノート"
HREF="release.html"><LINK
REL="PREVIOUS"
TITLE="リリース9.4.1"
HREF="release-9-4-1.html"><LINK
REL="NEXT"
TITLE="リリース9.3.14"
HREF="release-9-3-14.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2016-10-20T00:12:21"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.0文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="リリース9.4.1"
HREF="release-9-4-1.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="release.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>付録 E. リリースノート</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="リリース9.3.14"
HREF="release-9-3-14.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RELEASE-9-4"
>E.16. リリース9.4</A
></H1
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>リリース日: </B
>2014-12-18</P
></BLOCKQUOTE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN134868"
>E.16.1. 概要</A
></H2
><P
>    <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>9.4の主な強化点には以下のものがあります。
   </P
><P
></P
><UL
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>JSON</ACRONYM
>を格納するためのより高機能で効率的な<A
HREF="datatype-json.html"
><TT
CLASS="TYPE"
>jsonb</TT
></A
>データ型が追加されました。
      </P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>postgresql.conf</TT
>設定ファイルの項目を変更する新たな
<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>コマンド<A
HREF="sql-altersystem.html"
>ALTER SYSTEM</A
>を追加しました。
      </P
></LI
><LI
><P
>いくつかの<A
HREF="sql-altertable.html"
>ALTER TABLE</A
>コマンドでロックを軽減しました。
      </P
></LI
><LI
><P
><A
HREF="rules-materializedviews.html"
>マテリアライズドビュー</A
>を同時実行の読み取りを
妨げずにリフレッシュできるようにしました。
      </P
></LI
><LI
><P
>データベース変更をカスタマイズ可能な形式でストリーミング出力する、
WALデータの<A
HREF="logicaldecoding.html"
>ロジカルデコーディング</A
>をサポートしました。
      </P
></LI
><LI
><P
><A
HREF="bgworker.html"
>バックグラウンドワーカプロセス</A
>を動的に登録、開始、終了
できるようにしました。
      </P
></LI
></UL
><P
>上記の項目については、以下でより詳細に説明します。
   </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN134896"
>E.16.2. バージョン9.4への移行</A
></H2
><P
>以前のリリースからデータを移行したい時は、どのリリースについても、
<SPAN
CLASS="APPLICATION"
>pg_dump</SPAN
>を利用したダンプとリストア、
あるいは<SPAN
CLASS="APPLICATION"
>pg_upgrade</SPAN
>の利用が必要です。
   </P
><P
>バージョン9.4には、以前のバージョンとの互換性に影響する多くの変更点が含まれています。
以下の非互換性に注意してください。
   </P
><P
></P
><UL
><LI
><P
>多次元<A
HREF="arrays.html"
>配列</A
>の入力検査を厳格にしました。
(Bruce Momjian)
     </P
><P
>これまでは、単一要素の副配列から始まる入力配列文字列が、後に複数要素の副配列を
含むことができました。例えば <TT
CLASS="LITERAL"
>'{{1}, {2,3}}'::int[]</TT
> は受け付けられます。
     </P
></LI
><LI
><P
><A
HREF="datatype-json.html"
><TT
CLASS="TYPE"
>JSON</TT
></A
>文字列値におけるユニコードエスケープで、バックスラッシュではエスケープされなくなりました。
(Andrew Dunstan)
     </P
><P
>これまで、JSONに整形されるテキスト中のすべてのバックスラッシュはエスケープされていました。
エスケープしなくとも正しいJSON文字列値であり、エスケープすることでひねくれた結果がもたらされていたことから、これからは、<TT
CLASS="LITERAL"
>u</TT
>と16進数4桁に続くバックスラッシュはエスケープされません。
     </P
><P
>訳注：9.4.1で本修正は取り消されています。
オリジナルの9.4.1マニュアルでは、9.4.0リリースノートから本項目自体が削除されていますが、9.4.0バージョンの情報を残すため、日本語訳では項目を残しました。
     </P
></LI
><LI
><P
><TT
CLASS="TYPE"
>date</TT
>型、<TT
CLASS="TYPE"
>timestamp</TT
>型、<TT
CLASS="TYPE"
>timestamptz</TT
>型の値を
<A
HREF="datatype-json.html"
><TT
CLASS="TYPE"
>JSON</TT
></A
>に変換するとき、
ISO 8601に従った書式にします。
(Andrew Dunstan)
     </P
><P
>これまでは現在の<A
HREF="runtime-config-client.html#GUC-DATESTYLE"
>DateStyle</A
>設定に基づいて処理されていました。
しかし、多くのJSONプロセッサはタイムスタンプにISO 8601形式を要求します。
必要であれば、JSON変換関数に渡す前に日付時刻の値を<TT
CLASS="TYPE"
>text</TT
>に明示的
キャストすることで以前の振る舞いを実現できます。
     </P
></LI
><LI
><P
>パス展開演算子 <A
HREF="functions-json.html#FUNCTIONS-JSON-OP-TABLE"
><TT
CLASS="TYPE"
>json</TT
>
 <TT
CLASS="LITERAL"
>#&gt;</TT
> <TT
CLASS="TYPE"
>text[]</TT
></A
> は、配列が空であるとき、
これからはNULLではなく左辺値を返すようになります。
     </P
><P
>これは、フィールド/要素を取り出す演算子 <TT
CLASS="LITERAL"
>-&gt;</TT
> の適用を
全く行わないという意味で一貫性があります。
同様に <TT
CLASS="TYPE"
>json</TT
> <TT
CLASS="LITERAL"
>#&gt;&gt;</TT
> <TT
CLASS="TYPE"
>text[]</TT
> は、
単にその左辺値を強制的にテキストに変換します。
     </P
></LI
><LI
><P
><A
HREF="functions-json.html#FUNCTIONS-JSON-OP-TABLE"
><TT
CLASS="TYPE"
>JSON</TT
>のフィールド、要素、
パスを取り出す演算子</A
>は境界条件で、これからはエラーでなくNULLを返すようにしました。
(Tom Lane)
     </P
><P
>例えば、JSON配列にフィールド取り出し演算子（-&gt;）を適用するとき、
これからは、エラーでなくNULLがでます。これはより一貫性のある振る舞いです
（類似の指定フィールドが無い場合では既にNULLが返ります）。
また、正当な任意のJSONに対して決してエラーを投げないことから、これら演算子を
使った式インデックスの作成を安全にします。
     </P
></LI
><LI
><P
><A
HREF="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE"
><CODE
CLASS="FUNCTION"
>to_timestamp()</CODE
></A
>と<CODE
CLASS="FUNCTION"
>to_date()</CODE
>の書式文字列の連続した空白が、（空白文字以外を含め）入力文字列から対応した数だけ文字を消費するため、<TT
CLASS="LITERAL"
>FX</TT
>モードでなくても条件付きで隣接した空白を消費します。
(Jeevan Chalke)
     </P
><P
>これまでは、<TT
CLASS="LITERAL"
>FX</TT
>書式以外での連続する空白文字は、単一の空白文字の
ように振る舞い、入力文字列中の全ての隣接した空白を消費しました。例えば、
以前は3つの空白の書式文字列は<TT
CLASS="LITERAL"
>' 12'</TT
>の最初の空白のみ消費しました。
これからは、3文字すべてが消費されます。
     </P
></LI
><LI
><P
><A
HREF="functions-textsearch.html#TEXTSEARCH-FUNCTIONS-TABLE"
><CODE
CLASS="FUNCTION"
>ts_rank_cd()</CODE
></A
>関数を除去された語彙素を無視するように修正しました。
     </P
><P
>これまでは除去された語彙素がデフォルト位置を持つかのように扱われ、
有効であるか疑わしい順位が生じていました。
     </P
></LI
><LI
><P
>引数に<A
HREF="xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS"
><TT
CLASS="LITERAL"
>VARIADIC "any"</TT
></A
>を取る関数で、<TT
CLASS="LITERAL"
>VARIADIC</TT
>と指定された引数は決定可能な配列型でなければならなくなりました。
     </P
><P
>そのような引数に修飾されていない文字列リテラルや<TT
CLASS="LITERAL"
>NULL</TT
>を書くことが
できなくなり、これからは適切な配列データ型でキャストが必要となります。
なお、本変更は<TT
CLASS="LITERAL"
>VARIADIC</TT
>が指定されていない引数には影響しません。
     </P
></LI
><LI
><P
>行全体の変数で期待される列名が、複合型引数を取り列名に注意を払う関数に
伝わることを、保証するようになりました。
(Tom Lane)
     </P
><P
><TT
CLASS="LITERAL"
>row_to_json(tab.*)</TT
>などのデータ構成で、これからは、常に呼び出し時点の
テーブル<TT
CLASS="LITERAL"
>tab</TT
>の列別名に一致する列名を出力します。
以前のリリースでは、列名がクエリに割り当てられた別名に関係なく
テーブルの実際の列名になっていました。
     </P
></LI
><LI
><P
><A
HREF="sql-discard.html"
>DISCARD</A
>がこれからはシーケンス関連の状態も廃棄します。
(Fabr&iacute;zio de Royes Mello, Robert Haas)
     </P
></LI
><LI
><P
><A
HREF="sql-explain.html"
><TT
CLASS="COMMAND"
>EXPLAIN ANALYZE</TT
></A
>の出力で
<SPAN
CLASS="QUOTE"
>"total runtime"</SPAN
>から、<SPAN
CLASS="QUOTE"
>"execution time"</SPAN
>に
項目名を変更しました。
(Tom Lane)
     </P
><P
>これからはプラン時間も報告されるため、従来の項目名では紛らわしいです。
     </P
></LI
><LI
><P
><A
HREF="sql-show.html"
><TT
CLASS="COMMAND"
>SHOW TIME ZONE</TT
></A
>は、これからは
<ACRONYM
CLASS="ACRONYM"
>POSIX</ACRONYM
>時間帯形式の簡素な数値のUTCオフセットを出力します。
(Tom Lane)
     </P
><P
>これまでは、timezone設定を<A
HREF="datatype-datetime.html#DATATYPE-INTERVAL-OUTPUT"
><TT
CLASS="TYPE"
>interval</TT
></A
>
の値として表示していました。
単純な文字列が渡されたとき、
旧出力では正しく再解析されるように特別な扱いが必要であるのに対して、
新出力では<TT
CLASS="COMMAND"
>SET TIME ZONE</TT
>により適切に解釈されます。
     </P
></LI
><LI
><P
>外部テーブルの更新に対応した外部データラッパは、<TT
CLASS="LITERAL"
>AFTER ROW</TT
>トリガが
存在する可能性に考慮しなければいけません。
(Noah Misch)
     </P
><P
><TT
CLASS="LITERAL"
>AFTER ROW</TT
>トリガがある場合、トリガが読むかもしれないので、
更新動作でテーブルのすべての列を返されなければいけません。
これまでは、外部テーブルはトリガを持つことがなかったので、外部データラッパが
<TT
CLASS="LITERAL"
>RETURNING</TT
>句で言及されていない列の取得を省略して最適化しているかもしれません。
     </P
></LI
><LI
><P
><A
HREF="ddl-constraints.html#DDL-CONSTRAINTS-CHECK-CONSTRAINTS"
><TT
CLASS="LITERAL"
>CHECK</TT
></A
>制約が
<TT
CLASS="STRUCTFIELD"
>tableoid</TT
>以外のシステム列を参照できないようにしました。
(Amit Kapila)
     </P
><P
>これまではそのようなチェック制約が許されていましたが、リストア時にしばしばエラーを
引き起こしていました。
     </P
></LI
><LI
><P
>複数の<A
HREF="recovery-target-settings.html"
>リカバリターゲット設定</A
>が
指定されていた場合、最後の指定を使用するようにしました。
(Heikki Linnakangas)
     </P
><P
>これまでは<TT
CLASS="LITERAL"
>recovery_target_<TT
CLASS="REPLACEABLE"
><I
>xxx</I
></TT
></TT
>設定の優先順位が
文書化されていませんでした。
     </P
></LI
><LI
><P
>Windowsで、機械的にユーザが書いたコマンド文字列内のクオートを維持します。
(Heikki Linnakangas)
     </P
><P
>クオートを維持するようにしているユーザコマンドではおそらく修正が必要です。
<A
HREF="runtime-config-wal.html#GUC-ARCHIVE-COMMAND"
>archive_command</A
>や<A
HREF="archive-recovery-settings.html#RESTORE-COMMAND"
>restore_command</A
>、
<A
HREF="sql-copy.html"
><TT
CLASS="COMMAND"
>COPY TO/FROM PROGRAM</TT
></A
>の
コマンドで問題がありそうです。
     </P
></LI
><LI
><P
>システムカタログの列
<A
HREF="catalog-pg-class.html"
><TT
CLASS="STRUCTFIELD"
>pg_class.reltoastidxid</TT
></A
>
が取り除かれました。
(Michael Paquier)
     </P
></LI
><LI
><P
>システムカタログの列
<A
HREF="catalog-pg-rewrite.html"
><TT
CLASS="STRUCTFIELD"
>pg_rewrite.ev_attr</TT
></A
>
が取り除かれました。
(Kevin Grittner)
     </P
><P
>列単位のルールは<SPAN
CLASS="APPLICATION"
>PostgreSQL</SPAN
> 7.3以来サポートされていませんでした。
     </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>Kerberos</SPAN
>認証のネイティブサポート（<TT
CLASS="OPTION"
>--with-krb5</TT
>など）が除去されました。
(Magnus Hagander)
     </P
><P
><SPAN
CLASS="APPLICATION"
>Kerberos</SPAN
>認証の使用は<ACRONYM
CLASS="ACRONYM"
>GSSAPI</ACRONYM
>でサポートされます。
ネイティブコードは<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 8.3から非推奨となっていました。
     </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>PL/Python</SPAN
>で、配列のドメインを配列型を基底とするように扱います。
(Rodolfo Campero)
     </P
><P
>これまでは文字列として扱われていました。
     </P
></LI
><LI
><P
>libpq の
<A
HREF="libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS"
><CODE
CLASS="FUNCTION"
>PQconnectdbParams()</CODE
></A
>、
<A
HREF="libpq-connect.html#LIBPQ-PQPINGPARAMS"
><CODE
CLASS="FUNCTION"
>PQpingParams()</CODE
></A
>関数が
空文字列をデフォルトとして処理します。
(Adrian Vondendriesch)
     </P
><P
>これまでは、これらの関数では一部の場合だけ空文字列でデフォルトを選んでいました。
     </P
></LI
><LI
><P
><A
HREF="intarray.html"
>intarray</A
>モジュールが空配列を返すときゼロ次元配列になるように変更しました。
(Bruce Momjian)
     </P
><P
>これまでは、空配列を長さゼロの１次元配列として返していました。それらのテキスト表現はゼロ次元配列としたときと同じ（<TT
CLASS="LITERAL"
>{}</TT
>）ですが、配列操作での動作が異なります。
この部分で<SPAN
CLASS="APPLICATION"
>intarray</SPAN
>の振る舞いが組み込みの配列演算子と同じになります。
     </P
></LI
><LI
><P
><A
HREF="pgupgrade.html"
><SPAN
CLASS="APPLICATION"
>pg_upgrade</SPAN
></A
>は、これからは<TT
CLASS="OPTION"
>-U</TT
>または<TT
CLASS="OPTION"
>--username</TT
>
でユーザ名を指定するようになります。
(Bruce Momjian)
     </P
><P
>これまでは本オプションは<TT
CLASS="OPTION"
>-u</TT
>または<TT
CLASS="OPTION"
>--user</TT
>でしたが、
他のツールとの一貫性に欠けていました。
     </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN135055"
>E.16.3. 変更点</A
></H2
><P
>これまでのメジャーリリースからの<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 9.4
の変更点の詳細説明を以下に示します。
   </P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135059"
>E.16.3.1. サーバ</A
></H3
><P
></P
><UL
><LI
><P
><A
HREF="bgworker.html"
>バックグラウンドワーカプロセス</A
>を動的に
登録、開始、終了できるようにしました。
(Robert Haas)
       </P
><P
>新たな<TT
CLASS="FILENAME"
>worker_spi</TT
>モジュールで本新機能の例を示します。
       </P
></LI
><LI
><P
>共有メモリセグメントを動的に割り当てできるようにしました。
(Robert Haas, Amit Kapila)
       </P
><P
>本機能は<TT
CLASS="FILENAME"
>test_shm_mq</TT
>モジュールで例示されています。
       </P
></LI
><LI
><P
>クラッシュリカバリ、あるいは、immediateシャットダウンの際に、
即座に停止しない子プロセスにキャッチできないシグナル（<SPAN
CLASS="SYSTEMITEM"
>SIGKILL</SPAN
>）
を送るようになりました。
(MauMau, &Aacute;lvaro Herrera)
       </P
><P
>これにより、<A
HREF="app-postmaster.html"
><SPAN
CLASS="APPLICATION"
>postmaster</SPAN
></A
>シャットダウン後に子プロセスが
残ってしまう可能性を減らし、また、いくつかの子プロセスが<SPAN
CLASS="QUOTE"
>"刺った"</SPAN
>
場合でもクラッシュリカバリの進行を保証します。
       </P
></LI
><LI
><P
>データベースのシステム識別子のランダム性を改善しました。
(Tom Lane)
       </P
></LI
><LI
><P
><A
HREF="sql-vacuum.html"
>VACUUM</A
>が、削除済(dead)であるけれど未だ除去できない行に
ついて統計情報コレクタに適切に報告するようにしました。
(Hari Babu)
       </P
><P
>これまでは有効(live)行であるものと報告されていました。
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135083"
>E.16.3.1.1. インデックス</A
></H4
><P
></P
><UL
><LI
><P
>GINインデックスのサイズを減らしました。
(Alexander Korotkov, Heikki Linnakangas)
       </P
><P
><A
HREF="pgupgrade.html"
><SPAN
CLASS="APPLICATION"
>pg_upgrade</SPAN
></A
>を使ってアップグレードした場合、動作しますが、
従来のサイズの大きいGIN形式のままです。<A
HREF="sql-reindex.html"
>REINDEX</A
>
で新たな形式でインデックスを作り直す必要があります。
       </P
></LI
><LI
><P
>複合キーでの<A
HREF="gin.html"
><ACRONYM
CLASS="ACRONYM"
>GIN</ACRONYM
></A
>
インデックス照会の速度を改善しました。
(Alexander Korotkov, Heikki Linnakangas)
       </P
></LI
><LI
><P
><A
HREF="gist.html"
><ACRONYM
CLASS="ACRONYM"
>GiST</ACRONYM
></A
> 
インデックスが<A
HREF="datatype-net-types.html#DATATYPE-INET"
><TT
CLASS="TYPE"
>inet</TT
></A
>型、
<A
HREF="datatype-net-types.html#DATATYPE-CIDR"
><TT
CLASS="TYPE"
>cidr</TT
></A
>型に対応しました。
(Emre Hasegeli)
       </P
><P
>これらインデックス改善は、
<A
HREF="functions-net.html#CIDR-INET-OPERATORS-TABLE"
>サブネット・スーパーネット</A
>
の照会や並べ替えのための比較を性能向上させます。
       </P
></LI
><LI
><P
>B-treeインデックスのページ削除における稀な競合状態を修正しました。
(Heikki Linnakangas)
       </P
></LI
><LI
><P
>割り込みされたB-treeインデックスのページ分割の扱いをより頑健にしました。
(Heikki Linnakangas)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135109"
>E.16.3.1.2. 性能全般</A
></H4
><P
></P
><UL
><LI
><P
>複数バックエンドから<A
HREF="wal.html"
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
></A
>バッファに
並行に挿入できるようになりました。
(Heikki Linnakangas)
       </P
><P
>本変更は並列書き込み性能を改善します。
       </P
></LI
><LI
><P
>条件によって、更新された行のうち変更部分だけを
<A
HREF="wal.html"
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
></A
>に書き込むようにしました。
(Amit Kapila)
       </P
></LI
><LI
><P
><A
HREF="sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS"
>WINDOW関数</A
>
として使われる集約関数の性能を改善しました。
(David Rowley, Florian Pflug, Tom Lane)
       </P
></LI
><LI
><P
><A
HREF="datatype-numeric.html"
><TT
CLASS="TYPE"
>numeric</TT
></A
>型を
状態値に使う集約処理の速度を改善しました。
       </P
></LI
><LI
><P
>テーブルが<A
HREF="sql-cluster.html"
>CLUSTER</A
>または<A
HREF="sql-vacuum.html"
><TT
CLASS="COMMAND"
>VACUUM FULL</TT
></A
>コマンドで書き直されたときにタプルの
<A
HREF="routine-vacuuming.html#VACUUM-FOR-WRAPAROUND"
>凍結</A
>を試みます。
(Robert Haas, Andres Freund)
       </P
><P
>これにより将来にタプル凍結が必要になることを避けられます。
       </P
></LI
><LI
><P
>デフォルトがシーケンスの
<A
HREF="functions-sequence.html#FUNCTIONS-SEQUENCE-TABLE"
><CODE
CLASS="FUNCTION"
>nextval()</CODE
></A
>
である列に対する<A
HREF="sql-copy.html"
>COPY</A
>の速度を改善しました。
(Simon Riggs)
       </P
></LI
><LI
><P
>一つの接続で多数の<A
HREF="sql-createsequence.html"
>シーケンス</A
>
にアクセスする場合の速度を改善しました。
(David Rowley)
       </P
></LI
><LI
><P
>メモリ上でソートやB-treeインデックス構築をする際のタプル数の固定上限を引き上げました。
(Noah Misch)
       </P
></LI
><LI
><P
>PL/pgSQL手続き言語の<A
HREF="sql-do.html"
>DO</A
>ブロックによるメモリ割り当てを
小さくしました。
(Tom Lane)
       </P
></LI
><LI
><P
>プランナが<TT
CLASS="LITERAL"
>AND</TT
>/<TT
CLASS="LITERAL"
>OR</TT
>句が混在する中から、
より積極的に制約句を抽出するようにしました。
(Tom Lane)
       </P
></LI
><LI
><P
>揮発性の<TT
CLASS="LITERAL"
>WHERE</TT
>句を<TT
CLASS="LITERAL"
>DISTINCT</TT
>サブクエリに
プッシュダウンしないようにしました。
(Tom Lane) 
       </P
><P
><TT
CLASS="LITERAL"
>WHERE</TT
>句のプッシュダウンは概してプラン改善に効果的ですが、
問い合わせ文によっては句の評価コストがより多くなると考えられます。
そのため、句がVOLATILE関数を含むときにはプッシュダウンを実施しません。
       </P
></LI
><LI
><P
>カタログキャッシュが自動でサイズ変更されるようにしました。
(Heikki Linnakangas)
       </P
><P
>これは少数のテーブルにだけアクセスする接続に対してメモリ消費を減らし、
また、多数のテーブルにアクセスする接続に対しては性能を向上させます。
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135161"
>E.16.3.1.3. 監視</A
></H4
><P
></P
><UL
><LI
><P
><A
HREF="wal.html"
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
></A
>アーカイバの活動を報告する
<A
HREF="monitoring-stats.html#PG-STAT-ARCHIVER-VIEW"
>pg_stat_archiver</A
>システムビューを追加しました。
(Gabriele Bartolini)
       </P
></LI
><LI
><P
><TT
CLASS="STRUCTFIELD"
>n_mod_since_analyze</TT
>列を
<A
HREF="monitoring-stats.html#PG-STAT-ALL-TABLES-VIEW"
>pg_stat_all_tables</A
>と関連するシステムビューに追加しました。
(Mark Kirkwood)
       </P
><P
>この列は最後に<A
HREF="sql-analyze.html"
>ANALYZE</A
>が行われて以降のタプル変更回数の推計値を表示します。この推計値が自動ANALYZEの駆動を決めるために使われます。
       </P
></LI
><LI
><P
><TT
CLASS="STRUCTFIELD"
>backend_xid</TT
>列、<TT
CLASS="STRUCTFIELD"
>backend_xmin</TT
>列を、
システムビュー<A
HREF="monitoring-stats.html#PG-STAT-ACTIVITY-VIEW"
>pg_stat_activity</A
>に追加し、
<TT
CLASS="STRUCTFIELD"
>backend_xmin</TT
>列が<A
HREF="monitoring-stats.html#PG-STAT-REPLICATION-VIEW"
>pg_stat_replication</A
>
に追加しました。
(Christian Kruse)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135182"
>E.16.3.1.4. <ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
></A
></H4
><P
></P
><UL
><LI
><P
>SSLでECDH鍵交換をサポートしました。
(Marko Kreen)
       </P
><P
>楕円曲線鍵でサーバ認証ができるようになります。
この鍵は<ACRONYM
CLASS="ACRONYM"
>RSA</ACRONYM
>鍵よりも高速で安全です。
新たな設定パラメータ<A
HREF="runtime-config-connection.html#GUC-SSL-ECDH-CURVE"
>ssl_ecdh_curve</A
>でどの曲線を
<ACRONYM
CLASS="ACRONYM"
>ECDH</ACRONYM
>に使うかを制御します。
       </P
></LI
><LI
><P
><A
HREF="runtime-config-connection.html#GUC-SSL-CIPHERS"
>ssl_ciphers</A
>設定のデフォルト値を改善しました。
(Marko Kreen)
       </P
></LI
><LI
><P
>デフォルトでクライアント側でなくサーバ側の
<ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
>暗号の優先順設定を使用するようにしました。
(Marko Kreen)
       </P
><P
>これまでは、<A
HREF="runtime-config-connection.html#GUC-SSL-CIPHERS"
>ssl_ciphers</A
>で指定した順番が、
クライアント側のデフォルトの好みによってたいてい無視されていました。
これはほとんどの<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>クライアントで設定不能です。
望むなら新たな設定パラメータ<A
HREF="runtime-config-connection.html#GUC-SSL-PREFER-SERVER-CIPHERS"
>ssl_prefer_server_ciphers</A
>により従来の振る舞いに戻すこともできます。
       </P
></LI
><LI
><P
><A
HREF="runtime-config-logging.html#GUC-LOG-CONNECTIONS"
>log_connections</A
>で<ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
>暗号化情報を出力するようにしました。
(Andreas Kunert)
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
>再ネゴシエーション処理を改善しました。
(&Aacute;lvaro Herrera)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135209"
>E.16.3.1.5. サーバ設定</A
></H4
><P
></P
><UL
><LI
><P
><TT
CLASS="FILENAME"
>postgresql.conf</TT
>設定ファイルの項目を変更できる新たな<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>コマンド<A
HREF="sql-altersystem.html"
>ALTER SYSTEM</A
>を追加しました。
(Amit Kapila)
       </P
><P
>従来は設定変更するには<TT
CLASS="FILENAME"
>postgresql.conf</TT
>を手で編集するほかありませんでした。
       </P
></LI
><LI
><P
>自動VACUUMワーカーのメモリ使用量を調整する<A
HREF="runtime-config-resource.html#GUC-AUTOVACUUM-WORK-MEM"
>autovacuum_work_mem</A
>設定パラメータを追加しました。
(Peter Geoghegan)
       </P
></LI
><LI
><P
>Linuxのhuge pagesを利用できる<A
HREF="runtime-config-resource.html#GUC-HUGE-PAGES"
>huge_pages</A
>設定パラメータを追加しました。
(Christian Kruse, Richard Poole, Abhijit Menon-Sen)
       </P
><P
>これにより巨大メモリを持つシステムの性能を改善できます。
       </P
></LI
><LI
><P
>バックグラウンドワーカの数を制限する <A
HREF="runtime-config-resource.html#GUC-MAX-WORKER-PROCESSES"
>max_worker_processes</A
>パラメータを追加しました。
(Robert Haas)
       </P
><P
>スタンバイサーバに必要な（プライマリと同じ）ワーカプロセス数を調整するときに役立ちます。
       </P
></LI
><LI
><P
>スーパーユーザのみ使用できるセッション開始時にライブラリをロードする<A
HREF="runtime-config-client.html#GUC-SESSION-PRELOAD-LIBRARIES"
>session_preload_libraries</A
>パラメータを追加しました。
       </P
><P
><A
HREF="runtime-config-client.html#GUC-LOCAL-PRELOAD-LIBRARIES"
>local_preload_libraries</A
>と違い、<TT
CLASS="FILENAME"
>$libdir/plugins</TT
>ディレクトリにあるものに限られず、本パラメータでは、どの共有ライブラリでもロードできます。
       </P
></LI
><LI
><P
>ヒントビットの変更もWAL出力するようにする<A
HREF="runtime-config-wal.html#GUC-WAL-LOG-HINTS"
>wal_log_hints</A
>パラメータを追加しました。
(Sawada Masahiko)
       </P
><P
>チェックサムを有効にしているときを除き、通常ヒントビットはWAL記録されません。
本設定は、<SPAN
CLASS="APPLICATION"
>pg_rewind</SPAN
>のような外部ツールにおいて有用です。
       </P
></LI
><LI
><P
><A
HREF="runtime-config-resource.html#GUC-WORK-MEM"
>work_mem</A
>と<A
HREF="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM"
>maintenance_work_mem</A
>
のデフォルト設定値を４倍に増やしました。
<A
HREF="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM"
>maintenance_work_mem</A
>
(Bruce Momjian)
       </P
><P
>それぞれ4MBと64MBが新たなデフォルト値となります。
       </P
></LI
><LI
><P
><A
HREF="runtime-config-query.html#GUC-EFFECTIVE-CACHE-SIZE"
>effective_cache_size</A
>のデフォルト値を4GBに増やしました。
(Bruce Momjian, Tom Lane)
       </P
></LI
><LI
><P
><A
HREF="runtime-config-logging.html#GUC-LOG-LINE-PREFIX"
>log_line_prefix</A
>で<CODE
CLASS="FUNCTION"
>printf</CODE
>形式の空白パディングを指定できるようにしました。
(David Rowley)
       </P
></LI
><LI
><P
>設定ファイルにテラバイト単位 (<TT
CLASS="LITERAL"
>TB</TT
>)を記述できるようにしました。
(Simon Riggs)
       </P
></LI
><LI
><P
><A
HREF="runtime-config-logging.html#GUC-LOG-LOCK-WAITS"
>log_lock_waits</A
>によるログメッセージで、
ロックを保持しているプロセス、待っているプロセスの<ACRONYM
CLASS="ACRONYM"
>PID</ACRONYM
>、
および、改善されたリレーション情報が出力されるようにしました。
(Christian Kruse)
       </P
></LI
><LI
><P
>共有ライブラリをロードした際のログレベルをDEBUG1に下げました。
(Peter Geoghegan) 
       </P
><P
>これまでは<TT
CLASS="LITERAL"
>LOG</TT
>レベルでしたが、接続ごとにロードされるライブラリの場合には冗長すぎました。
       </P
></LI
><LI
><P
>Windowsにて<TT
CLASS="LITERAL"
>SQL_ASCII</TT
>エンコーディングのデータベースとサーバプロセス（例えば <A
HREF="app-postmaster.html"
><SPAN
CLASS="APPLICATION"
>postmaster</SPAN
></A
>）が、サーバのWindowsユーザロケールの文字エンコーディングでメッセージを出力するようになりました。
(Alexander Law, Noah Misch)
       </P
><P
>これまでは、Windowsの<ACRONYM
CLASS="ACRONYM"
>ANSI</ACRONYM
>コードページでメッセージが出力されていました。
       </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135271"
>E.16.3.2. レプリケーションとリカバリ</A
></H3
><P
></P
><UL
><LI
><P
>ストリーミングレプリケーション元ノードでスタンバイの活動を調整する
<A
HREF="warm-standby.html#STREAMING-REPLICATION-SLOTS"
>レプリケーションスロット</A
>
を追加しました。
(Andres Freund, Robert Haas)
       </P
><P
>レプリケーションスロットにより、プライマリ上の<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>ファイル等リソースをスタンバイサーバが必要としなくなるまで保持することができます。
       </P
></LI
><LI
><P
>レプリケーションを遅延させるリカバリ設定パラメータ<A
HREF="standby-settings.html#RECOVERY-MIN-APPLY-DELAY"
>recovery_min_apply_delay</A
>を追加しました。
(Robert Haas, Fabr&iacute;zio de Royes Mello, Simon Riggs)
       </P
><P
>スタンバイサーバでの再生を遅らせることは、ユーザによる誤りから復旧するのに役立ちます。
       </P
></LI
><LI
><P
>リカバリ設定パラメータ<A
HREF="recovery-target-settings.html#RECOVERY-TARGET"
>recovery_target</A
>にオプション<TT
CLASS="OPTION"
>immediate</TT
>を追加しました。<A
HREF="wal.html"
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
></A
>リカバリを整合性のある状態に到達したらすぐに停止します。
(MauMau, Heikki Linnakangas)
       </P
></LI
><LI
><P
>リカバリターゲットの処理を改善しました。
(Heikki Linnakangas)
       </P
><P
>停止を判定する<A
HREF="functions-admin.html#FUNCTIONS-RECOVERY-INFO-TABLE"
><CODE
CLASS="FUNCTION"
>pg_last_xact_replay_timestamp()</CODE
></A
>が報告するタイムスタンプが、コミットされるであろうトランザクションでなく、コミット済みのレコードを反映するようにしました。
リストアポイントよりも早すぎる時点で再生が止まってしまうのを防ぎます。
       </P
></LI
><LI
><P
><A
HREF="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE"
><CODE
CLASS="FUNCTION"
>pg_switch_xlog()</CODE
></A
>が古い<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>ファイル上の使われない末尾領域をクリアするようにしました。
(Heikki Linnakangas)
       </P
><P
>これは<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>ファイルの圧縮率を改善します。
       </P
></LI
><LI
><P
><A
HREF="archive-recovery-settings.html"
>リカバリ用外部コマンド</A
>からの
リターンコードを報告するようにしました。
(Peter Eisentraut)
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>再生中のスピンロック競合を減らしました。
(Heikki Linnakangas)
       </P
></LI
><LI
><P
>トランザクション実行の<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>レコードの書き出しをより頻繁にしました。
       </P
><P
>これによりスタンバイサーバで起動が速くなり、より積極的にリソースの片づけができるようになります。
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135311"
>E.16.3.2.1. <A
HREF="logicaldecoding.html"
>ロジカルデコーディング</A
></A
></H4
><P
>ロジカルデコーディングにより、データベース変更を可変な形式で流し出すことができるようになります。
データは<A
HREF="wal.html"
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
></A
>から読みとり、望む形式に変換されます。本機能を実装するため、以下の改修が行われました。
      </P
><P
></P
><UL
><LI
><P
>データベース変更をカスタマイズ可能な形式で連続的に出力できる、WALデータの<A
HREF="logicaldecoding.html"
>ロジカルデコーディング</A
>をサポートしました。
(Andres Freund)
        </P
></LI
><LI
><P
><A
HREF="runtime-config-wal.html#GUC-WAL-LEVEL"
>wal_level</A
>設定パラメータに、<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>に論理変更セットのエンコードを有効にする新たなオプション<TT
CLASS="OPTION"
>logical</TT
>を追加しました。
(Andres Freund)
        </P
></LI
><LI
><P
>論理レプリケーションの制御用にテーブル単位のパラメータ
<A
HREF="catalog-pg-class.html"
><TT
CLASS="LITERAL"
>REPLICA IDENTITY</TT
></A
>
を追加しました。
(Andres Freund)
        </P
></LI
><LI
><P
>論理変更セットのエンコードにおいてユーザ作成テーブルを識別するためのテーブル単位のパラメータ
<A
HREF="sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS"
><TT
CLASS="OPTION"
>user_catalog_table</TT
></A
>
を追加しました。
(Andres Freund)
        </P
></LI
><LI
><P
>ロジカルデコーディングデータを受け取るアプリケーション<A
HREF="app-pgrecvlogical.html"
><SPAN
CLASS="APPLICATION"
>pg_recvlogical</SPAN
></A
>を追加しました。
(Andres Freund)
        </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>レベルでロジカルデコーディングを例示する<A
HREF="test-decoding.html"
>test_decoding</A
>モジュールを追加しました。
(Andres Freund)
        </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135341"
>E.16.3.3. 問い合わせ</A
></H3
><P
></P
><UL
><LI
><P
><TT
CLASS="LITERAL"
>FROM</TT
>句の集合を返す関数から返される行に番号をつける
<A
HREF="queries-table-expressions.html#QUERIES-TABLEFUNCTIONS"
><TT
CLASS="LITERAL"
>WITH ORDINALITY</TT
></A
>構文を追加しました。
(Andrew Gierth, David Fetter)
       </P
><P
><CODE
CLASS="FUNCTION"
>unnest()</CODE
>のような関数で特に役立ちます。
       </P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>FROM</TT
>句で集合を返す関数の水平結合ができる
<A
HREF="queries-table-expressions.html#QUERIES-TABLEFUNCTIONS"
><TT
CLASS="LITERAL"
>ROWS FROM()</TT
></A
>構文を追加しました。
(Andrew Gierth)
       </P
></LI
><LI
><P
><A
HREF="sql-select.html"
>SELECT</A
>で空のターゲットリストを持てるようにしました。
       </P
><P
>これにより、ゼロ個の列を選択するビューを正しくダンプ、リストアできるようになります。
       </P
></LI
><LI
><P
><A
HREF="sql-select.html"
><TT
CLASS="LITERAL"
>SELECT ... FOR UPDATE NOWAIT</TT
></A
>が例外的なケースでも既に同時更新されているタプルを待たないようにしました。
(Craig Ringer and Thomas Munro)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135364"
>E.16.3.4. ユーティリティコマンド</A
></H3
><P
></P
><UL
><LI
><P
>キャッシュされたシーケンス関連の状態を破棄する<A
HREF="sql-discard.html"
><TT
CLASS="COMMAND"
>DISCARD SEQUENCES</TT
></A
>コマンドを追加しました。
(Fabr&iacute;zio de Royes Mello, Robert Haas)
       </P
><P
>これからは<TT
CLASS="COMMAND"
>DISCARD ALL</TT
>もシーケンス関連の状態情報を破棄します。
       </P
></LI
><LI
><P
><A
HREF="sql-copy.html"
><TT
CLASS="COMMAND"
>COPY FROM</TT
></A
>に、
<TT
CLASS="LITERAL"
>CSV</TT
>モードで指定のNULL文字列に一致するクオートされた文字列をNULLに変換する、
<TT
CLASS="LITERAL"
>FORCE NULL</TT
>オプションを追加しました。
(Ian Barwick, Michael Paquier)
        </P
><P
>本オプションが無い場合、クオートされていなくてマッチした文字列だけNULLとして扱われます。
        </P
></LI
><LI
><P
>トランザクションブロックの外で意味をなさないコマンドを実行したとき、警告を出すようにしました。
(Bruce Momjian)
       </P
><P
>新たに<TT
CLASS="COMMAND"
>SET LOCAL</TT
>、<TT
CLASS="COMMAND"
>SET CONSTRAINTS</TT
>、
<TT
CLASS="COMMAND"
>SET TRANSACTION</TT
>、および、<TT
CLASS="COMMAND"
>ABORT</TT
>について、トランザクション外で使うと警告がでるようになります。
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135387"
>E.16.3.4.1. <A
HREF="sql-explain.html"
>EXPLAIN</A
></A
></H4
><P
></P
><UL
><LI
><P
><TT
CLASS="COMMAND"
>EXPLAIN ANALYZE</TT
>がプラン時間を表示するようにしました。
(Andreas Karlsson)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>EXPLAIN</TT
>がAgg、Groupプラン要素にて集約している列を出力するようにしました。
(Tom Lane)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>EXPLAIN ANALYZE</TT
>でビットマップヒープスキャンのexactブロックカウントとlossyブロックカウントを出力するようにしました。
(Etsuro Fujita)
        </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135400"
>E.16.3.4.2. ビュー</A
></H4
><P
></P
><UL
><LI
><P
><A
HREF="rules-materializedviews.html"
>マテリアライズドビュー</A
>を他セッションの同時参照を妨げずにリフレッシュできるようにしました。
(Kevin Grittner)
       </P
><P
><A
HREF="sql-refreshmaterializedview.html"
><TT
CLASS="COMMAND"
>REFRESH MATERIALIZED VIEW CONCURRENTLY</TT
></A
>コマンドで行います。
       </P
></LI
><LI
><P
>たとえ更新できない列が含まれていても、ビューが<A
HREF="sql-createview.html#SQL-CREATEVIEW-UPDATABLE-VIEWS"
>自動更新可能</A
>になります。
(Dean Rasheed)
       </P
><P
>これまでは、式や定数、関数呼び出しなどの更新不能な出力列があると、ビューは自動更新可能にはなりませんでした。
これからは、更新不能な列に新しい値を割り当てしようとしないなら<TT
CLASS="COMMAND"
>INSERT</TT
>、<TT
CLASS="COMMAND"
>UPDATE</TT
>、<TT
CLASS="COMMAND"
>DELETE</TT
>がサポートされます。
       </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>INSERT</TT
>や<TT
CLASS="COMMAND"
>UPDATE</TT
>で、
自動更新可能ビューにそのビューにはあらわれない行を加えることができるかを制御できるようにしました。
(Dean Rasheed)
       </P
><P
>新たに追加された<A
HREF="sql-createview.html"
>CREATE VIEW</A
>の<TT
CLASS="LITERAL"
>WITH CHECK OPTION</TT
>句で制御します。
       </P
></LI
><LI
><P
><A
HREF="rules-privileges.html"
>セキュリティバリアビュー</A
>も自動更新可能になれるようにしました。
(Dean Rasheed)
       </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135426"
>E.16.3.5. オブジェクトの操作</A
></H3
><P
></P
><UL
><LI
><P
><A
HREF="sql-createforeigntable.html"
>外部テーブル</A
>のトリガをサポートしました。
(Ronan Dunklau)
       </P
></LI
><LI
><P
><A
HREF="sql-altertable.html"
>ALTER TABLE</A
>、<A
HREF="sql-alterindex.html"
>ALTER INDEX</A
>、
<A
HREF="sql-altermaterializedview.html"
>ALTER MATERIALIZED VIEW</A
>にて、
<TT
CLASS="LITERAL"
>ALL IN TABLESPACE ... SET TABLESPACE</TT
>指定を使って、
テーブルスペースのオブジェクト群をまとめて別テーブルスペースに移動できるようにしました。
(Stephen Frost)
       </P
></LI
><LI
><P
><A
HREF="sql-altertable.html"
>ALTER TABLE</A
> ... <TT
CLASS="LITERAL"
>ALTER CONSTRAINT</TT
>で外部キー制約が遅延できるかを変更できるようにしました。
(Simon Riggs)
       </P
></LI
><LI
><P
>いくつかの<A
HREF="sql-altertable.html"
>ALTER TABLE</A
>コマンドでロックの強さを下げました。
(Simon Riggs, Noah Misch, Robert Haas)
       </P
><P
>特に、<TT
CLASS="LITERAL"
>VALIDATE CONSTRAINT</TT
>、<TT
CLASS="LITERAL"
>CLUSTER ON</TT
>、
<TT
CLASS="LITERAL"
>SET WITHOUT CLUSTER</TT
>、<TT
CLASS="LITERAL"
>ALTER COLUMN SET STATISTICS</TT
>、
<TT
CLASS="LITERAL"
>ALTER COLUMN</TT
> <TT
CLASS="LITERAL"
>SET</TT
> <TT
CLASS="OPTION"
>(attribute_option)</TT
>、
<TT
CLASS="LITERAL"
>ALTER COLUMN RESET</TT
> <TT
CLASS="OPTION"
>(attribute_option)</TT
>は、もはや
<TT
CLASS="LITERAL"
>ACCESS EXCLUSIVE</TT
>ロックを必要としません。
       </P
></LI
><LI
><P
>テーブルスペースのオプションを
<A
HREF="sql-createtablespace.html"
>CREATE TABLESPACE</A
>で設定できるようにしました。
(Vik Fearing)
       </P
><P
>以前はこれらのオプションは<A
HREF="sql-altertablespace.html"
>ALTER TABLESPACE</A
>でしか設定できませんでした。
       </P
></LI
><LI
><P
><A
HREF="sql-createaggregate.html"
>CREATE AGGREGATE</A
>で集約の遷移状態データの推定サイズを指定できるようにしました。
(Hadi Moshayedi)
       </P
><P
>この機能を適切に使うことでプランナが集約での必要メモリ量をよりよく見積もれます。
       </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>DROP IF EXISTS</TT
>が場合によってはオブジェクトが無いことでエラーになるのを修正しました。
(Pavel Stehule, Dean Rasheed)
       </P
></LI
><LI
><P
>システムリレーションの識別方法を改善しました。
(Andres Freund, Robert Haas)
       </P
><P
>これまでは、一度<TT
CLASS="LITERAL"
>pg_catalog</TT
>スキーマに移動したリレーションは、変更も削除もできませんでした。
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135472"
>E.16.3.6. データ型</A
></H3
><P
></P
><UL
><LI
><P
><A
HREF="datatype-geometric.html#DATATYPE-LINE"
><TT
CLASS="TYPE"
>line</TT
></A
>データ型を完全に実装しました。
(Peter Eisentraut)
       </P
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>線分</I
></SPAN
>データ型(<A
HREF="datatype-geometric.html#DATATYPE-LSEG"
><TT
CLASS="TYPE"
>lseg</TT
></A
>)
は既にサポートされています。
従来の<TT
CLASS="TYPE"
>line</TT
>データ型（コンパイルオプションでのみ有効にできます）は、バイナリでもダンプでも新しい実装と互換性がありません。
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>のログシーケンス番号(<ACRONYM
CLASS="ACRONYM"
>LSN</ACRONYM
>)をあらわす<A
HREF="datatype-pg-lsn.html"
><TT
CLASS="TYPE"
>pg_lsn</TT
></A
>データ型を追加しました。
(Robert Haas, Michael Paquier)
       </P
></LI
><LI
><P
>一点だけの<A
HREF="datatype-geometric.html#DATATYPE-POLYGON"
><TT
CLASS="TYPE"
>polygon</TT
></A
>を
<A
HREF="datatype-geometric.html#DATATYPE-CIRCLE"
><TT
CLASS="TYPE"
>circle</TT
></A
>に変換できるようにしました。
(Bruce Momjian)
       </P
></LI
><LI
><P
>UTCオフセットが変化するタイムゾーン略称をサポートしました。
(Tom Lane)
       </P
><P
>これまで<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>では（<TT
CLASS="LITERAL"
>EST</TT
>などの）一つのタイムゾーン略称に関連づけられたUTCオフセットは、いかなるロケールでの使用でも変化しないと仮定していました。
しかしながら、実世界においてこの仮定は失敗しました。そこで、意味するUTCオフセットをときに変更できるタイムゾーン略称を導入しました。
1970年以来の略称のUTCオフセットが変更されたタイムゾーンロケールで本機能を使えるように（IANAタイムゾーンデータベースに基づいて）ゾーン略称定義ファイルを刷新しました。これからは<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>は、略称に日付に応じた適切なUTCオフセットを関連づけます。
       </P
></LI
><LI
><P
><A
HREF="datatype-datetime.html"
><TT
CLASS="TYPE"
>timestamp</TT
></A
>と
<TT
CLASS="TYPE"
>date</TT
>のISO形式以外の文字列で5桁以上の年を使用可能にしました。
(Bruce Momjian)
       </P
></LI
><LI
><P
><A
HREF="datatype-datetime.html"
><TT
CLASS="TYPE"
>interval</TT
></A
>値のオーバーフロー、アンダーフローのチェックを加えました。
(Bruce Momjian)
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135511"
>E.16.3.6.1. <A
HREF="datatype-json.html"
><ACRONYM
CLASS="ACRONYM"
>JSON</ACRONYM
></A
></A
></H4
><P
></P
><UL
><LI
><P
>より高機能で効率的な<ACRONYM
CLASS="ACRONYM"
>JSON</ACRONYM
>文字列のデータ型<A
HREF="datatype-json.html"
><TT
CLASS="TYPE"
>jsonb</TT
></A
>を追加しました。
(Oleg Bartunov, Teodor Sigaev, Alexander Korotkov, Peter Geoghegan, Andrew Dunstan)
        </P
><P
>この新しいデータ型は、JSON文書により高速にアクセスでき、また、JSON列により高速で有用なインデックス適用ができます。
従来の<TT
CLASS="TYPE"
>json</TT
>型がJSON文書全体をテキストとして格納するのに対し、
<TT
CLASS="TYPE"
>jsonb</TT
>文書のスカラ値は適当なSQLデータ型として格納され、JSON文書の構造は事前解析されます。
        </P
></LI
><LI
><P
>任意の複雑なJSONツリーを構築できる新たなJSON関数を追加しました。
(Andrew Dunstan, Laurence Rowe)
        </P
><P
>新たな関数には、
<A
HREF="functions-json.html#FUNCTIONS-JSON-PROCESSING-TABLE"
><CODE
CLASS="FUNCTION"
>json_array_elements_text()</CODE
></A
>、
<CODE
CLASS="FUNCTION"
>json_build_array()</CODE
>、<CODE
CLASS="FUNCTION"
>json_object()</CODE
>、
<CODE
CLASS="FUNCTION"
>json_object_agg()</CODE
>、<CODE
CLASS="FUNCTION"
>json_to_record()</CODE
>、
<CODE
CLASS="FUNCTION"
>json_to_recordset()</CODE
>が含まれます。
        </P
></LI
><LI
><P
><TT
CLASS="TYPE"
>json</TT
>値のデータ型を返す
<A
HREF="functions-json.html#FUNCTIONS-JSON-PROCESSING-TABLE"
><CODE
CLASS="FUNCTION"
>json_typeof()</CODE
></A
>を追加しました。
(Andrew Tipton)
        </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135539"
>E.16.3.7. 関数</A
></H3
><P
></P
><UL
><LI
><P
>より柔軟に遅延を指定できる<A
HREF="functions-datetime.html#FUNCTIONS-DATETIME-DELAY"
><CODE
CLASS="FUNCTION"
>pg_sleep_for(interval)</CODE
></A
>と<CODE
CLASS="FUNCTION"
>pg_sleep_until(timestamp)</CODE
>を追加しました。
(Vik Fearing, Julien Rouhaud)
       </P
><P
>既存の<CODE
CLASS="FUNCTION"
>pg_sleep()</CODE
>関数は秒指定の遅延のみをサポートしていました。
       </P
></LI
><LI
><P
>配列を引数とする<A
HREF="functions-array.html#ARRAY-FUNCTIONS-TABLE"
><CODE
CLASS="FUNCTION"
>cardinality()</CODE
></A
>関数を追加しました。
(Marko Tiikkaja)
       </P
><P
>この関数は、配列要素の総数、要素が無い場合にはゼロを返します。
       </P
></LI
><LI
><P
>任意のオフセットで<A
HREF="lo-funcs.html"
>ラージオブジェクトを読み書き</A
>できる<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>関数を追加しました。
(Pavel Stehule)
       </P
></LI
><LI
><P
><A
HREF="functions-array.html#ARRAY-FUNCTIONS-TABLE"
><CODE
CLASS="FUNCTION"
>unnest()</CODE
></A
>を複数引数をとれるようにしました。引数は各々に展開され、水平に結合されます。
(Andrew Gierth)
       </P
></LI
><LI
><P
>文字列ではなく個別の値から、<TT
CLASS="TYPE"
>time</TT
>、<TT
CLASS="TYPE"
>date</TT
>、<TT
CLASS="TYPE"
>timestamp</TT
>、<TT
CLASS="TYPE"
>timestamptz</TT
>、<TT
CLASS="TYPE"
>interval</TT
>の各データ型を構築する関数を追加しました。
(Pavel Stehule)
       </P
><P
>これらの関数には<TT
CLASS="LITERAL"
>make_</TT
>という接頭辞が付きます（例えば<A
HREF="functions-datetime.html#FUNCTIONS-DATETIME-TABLE"
><CODE
CLASS="FUNCTION"
>make_date()</CODE
></A
>）。
       </P
></LI
><LI
><P
><A
HREF="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE"
><CODE
CLASS="FUNCTION"
>to_char()</CODE
></A
>関数の<TT
CLASS="LITERAL"
>TZ</TT
>書式指示子が、数値であらわれたタイムゾーンオフセットに対して有効な値を返すようにしました。
(Tom Lane)
       </P
><P
>これまでは、
<TT
CLASS="LITERAL"
>timezone</TT
>に「<TT
CLASS="LITERAL"
>-4</TT
>」のような定数が設定されていると、
<TT
CLASS="LITERAL"
>to_char(CURRENT_TIMESTAMP, 'TZ')</TT
>が空文字列を返していました。
       </P
></LI
><LI
><P
><A
HREF="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE"
><CODE
CLASS="FUNCTION"
>to_char()</CODE
></A
>で
タイムゾーンオフセットの書式指示子「<TT
CLASS="LITERAL"
>OF</TT
>」がサポートされました。
(Bruce Momjian)
       </P
></LI
><LI
><P
><A
HREF="functions-math.html#FUNCTIONS-MATH-RANDOM-TABLE"
><CODE
CLASS="FUNCTION"
>random()</CODE
></A
>
のランダムシードを改善しました。
(Honza Horak)
       </P
></LI
><LI
><P
><A
HREF="functions-string.html#FUNCTIONS-STRING-OTHER"
><CODE
CLASS="FUNCTION"
>chr(int)</CODE
></A
>で
ユニコードのコードポイントの正当性チェックをより厳しくしました。
(Tom Lane)
       </P
><P
>本関数はRFC 3629に従ったUTF8文字のみを有効な値として受けるようになります。
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135596"
>E.16.3.7.1. システム情報関数</A
></H4
><P
></P
><UL
><LI
><P
>システムテーブル<TT
CLASS="STRUCTNAME"
>pg_class</TT
>、<TT
CLASS="STRUCTNAME"
>pg_proc</TT
>、<TT
CLASS="STRUCTNAME"
>pg_type</TT
>、<TT
CLASS="STRUCTNAME"
>pg_operator</TT
>を検索して、オブジェクトが無くてもエラーを返さない関数をいくつか追加しました。
(Yugo Nagata, Nozomi Anzai, Robert Haas)
       </P
><P
>例えば、<A
HREF="functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE"
><CODE
CLASS="FUNCTION"
>to_regclass()</CODE
></A
>は<TT
CLASS="STRUCTNAME"
>pg_class</TT
>を<TT
CLASS="TYPE"
>regclass</TT
>入力関数と同様に検索しますが、オブジェクトが無い場合には失敗するのでなくNULLを返します。
<TT
CLASS="TYPE"
>regclass</TT
> 
       </P
></LI
><LI
><P
>リレーション名をファイルノードからより効率的に検索できる<A
HREF="functions-admin.html#FUNCTIONS-ADMIN-DBLOCATION"
><CODE
CLASS="FUNCTION"
>pg_filenode_relation()</CODE
></A
>関数を追加しました。
(Andres Freund)
       </P
></LI
><LI
><P
><A
HREF="infoschema-parameters.html"
><TT
CLASS="STRUCTNAME"
>information_schema.parameters</TT
></A
>ビューに<TT
CLASS="STRUCTFIELD"
>parameter_default</TT
>列を追加しました。
(Peter Eisentraut)
       </P
></LI
><LI
><P
><A
HREF="infoschema-schemata.html"
><TT
CLASS="STRUCTNAME"
>information_schema.schemata</TT
></A
>が全てのアクセス可能なスキーマを表示するようにしました。
(Peter Eisentraut)
       </P
><P
>これまでは現在ユーザが所有者のスキーマだけ表示していました。
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135625"
>E.16.3.7.2. 集約</A
></H4
><P
></P
><UL
><LI
><P
>どの行を集約関数に渡すかを制御する<A
HREF="sql-expressions.html#SYNTAX-AGGREGATES"
><TT
CLASS="LITERAL"
>FILTER</TT
></A
>句が追加されました。
(David Fetter)
       </P
></LI
><LI
><P
>順序付けされた集合(<A
HREF="sql-expressions.html#SYNTAX-AGGREGATES"
><TT
CLASS="LITERAL"
>WITHIN GROUP</TT
></A
>)の集約をサポートしました。
(Atri Sharma, Andrew Gierth, Tom Lane)
       </P
></LI
><LI
><P
>SQL標準の順序集合の集約関数
<A
HREF="functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE"
><CODE
CLASS="FUNCTION"
>percentile_cont()</CODE
></A
>、
<CODE
CLASS="FUNCTION"
>percentile_disc()</CODE
>、
<CODE
CLASS="FUNCTION"
>mode()</CODE
>、
<A
HREF="functions-aggregate.html#FUNCTIONS-HYPOTHETICAL-TABLE"
><CODE
CLASS="FUNCTION"
>rank()</CODE
></A
>、
<CODE
CLASS="FUNCTION"
>dense_rank()</CODE
>、
<CODE
CLASS="FUNCTION"
>percent_rank()</CODE
>、
<CODE
CLASS="FUNCTION"
>cume_dist()</CODE
>が追加されました。
(Atri Sharma, Andrew Gierth)
       </P
></LI
><LI
><P
>集約関数で<A
HREF="xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS"
><TT
CLASS="LITERAL"
>VARIADIC</TT
></A
>
をサポートしました。
(Tom Lane)
       </P
></LI
><LI
><P
>引数に多態集約が多態でない状態データ型を持てるようにしました。
(Tom Lane)
       </P
><P
>組み込みの<CODE
CLASS="FUNCTION"
>array_agg()</CODE
>のような集約関数をSQLで適切に宣言できるようになります。
       </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135655"
>E.16.3.8. サーバサイド言語</A
></H3
><P
></P
><UL
><LI
><P
><A
HREF="plperl.html"
>PL/Perl</A
>と<A
HREF="pltcl.html"
>PL/Tcl</A
>にイベントトリガのサポートを加えました。
(Dimitri Fontaine)
      </P
></LI
><LI
><P
><A
HREF="datatype-numeric.html"
><TT
CLASS="TYPE"
>numeric</TT
></A
>型の値を
<A
HREF="plpython.html"
>PL/Python</A
>で<TT
CLASS="TYPE"
>decimal</TT
>型に変換するようにしました。
(Szymon Guz, Ronan Dunklau)
      </P
><P
>これまでは、値をPythonの<TT
CLASS="TYPE"
>float</TT
>型の値に変換していました。
      </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135670"
>E.16.3.8.1. <A
HREF="plpgsql.html"
>PL/pgSQL</A
>サーバサイド言語</A
></H4
><P
></P
><UL
><LI
><P
><A
HREF="plpgsql-control-structures.html#PLPGSQL-CALL-STACK"
><TT
CLASS="COMMAND"
>GET DIAGNOSTICS</TT
></A
>
を使ってPL/PgSQLの現在のコールスタックを取得できるようにしました。
(Pavel Stehule, Stephen Frost)
       </P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>STRICT</TT
>制約に違反したクエリを表示する
<A
HREF="plpgsql-statements.html#PLPGSQL-STATEMENTS-SQL-ONEROW"
><TT
CLASS="OPTION"
>print_strict_params</TT
></A
>オプションを追加しました。
(Marko Tiikkaja)
       </P
></LI
><LI
><P
>追加的なPL/pgSQLの警告とエラーを有効にする
<A
HREF="plpgsql-development-tips.html#PLPGSQL-EXTRA-CHECKS"
><TT
CLASS="VARNAME"
>plpgsql.extra_warnings</TT
></A
>変数、
<TT
CLASS="VARNAME"
>plpgsql.extra_errors</TT
>変数を追加しました。
(Marko Tiikkaja, Petr Jelinek)
       </P
><P
>いまのところ隠し変数についての警告、エラーが有効になるだけです。
       </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135689"
>E.16.3.9. <A
HREF="libpq.html"
><SPAN
CLASS="APPLICATION"
>libpq</SPAN
></A
></A
></H3
><P
></P
><UL
><LI
><P
>libpqの<A
HREF="libpq-connect.html#LIBPQ-PQCONNDEFAULTS"
><CODE
CLASS="FUNCTION"
>PQconndefaults()</CODE
></A
>が
無効なサービスファイルを無視するようにしました。
(Steve Singer, Bruce Momjian)
       </P
><P
>これまでは、不正なサービスファイルに遭遇するとNULLを返していました。
       </P
></LI
><LI
><P
><TT
CLASS="LITERAL"
>TLSv1</TT
>以降バージョンの<ACRONYM
CLASS="ACRONYM"
>TLS</ACRONYM
>プロトコルを受け付けます。
(Marko Kreen)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135703"
>E.16.3.10. クライアントアプリケーション</A
></H3
><P
></P
><UL
><LI
><P
><A
HREF="app-createuser.html"
><SPAN
CLASS="APPLICATION"
>createuser</SPAN
></A
>に、所属するロールを指定する<TT
CLASS="OPTION"
>-g</TT
>オプションを追加しました。
(Chistopher Browne)
       </P
></LI
><LI
><P
><A
HREF="app-vacuumdb.html"
><SPAN
CLASS="APPLICATION"
>vacuumdb</SPAN
></A
>粒度を増やして複数段階で解析を行う<TT
CLASS="OPTION"
>--analyze-in-stages</TT
>オプションが追加されました。
       </P
><P
>これにより最小限の統計情報を素早く生成できます。
       </P
></LI
><LI
><P
><A
HREF="app-pgresetxlog.html"
><SPAN
CLASS="APPLICATION"
>pg_resetxlog</SPAN
></A
>が<TT
CLASS="OPTION"
>-n</TT
>オプションにて現在値ともしかすると変更された値を出力するようにしました。
(Rajeev Rastogi)
       </P
></LI
><LI
><P
><A
HREF="app-initdb.html"
>initdb</A
>が誤ったロケール設定に黙って代替にデフォルトを選択するのでなくエラーを出すようにしました。
(Tom Lane)
       </P
></LI
><LI
><P
><A
HREF="app-pg-ctl.html"
><SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
></A
>がデータディレクトリにアクセスできないとき終了コード<TT
CLASS="LITERAL"
>4</TT
>を返すようにしました。
(Amit Kapila, Bruce Momjian)
       </P
><P
>この振る舞いはLinux Standard Base(<ACRONYM
CLASS="ACRONYM"
>LSB</ACRONYM
>)のコア仕様により厳密に適合します。
       </P
></LI
><LI
><P
>Windowsで相対パスで指定された<TT
CLASS="OPTION"
>-D</TT
>オプションを<A
HREF="app-pg-ctl.html"
><SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
></A
>のカレントディレクトリからの相対パスと解釈することを保証します。
(Kumar Rajeev Rastogi) 
       </P
><P
>これまでは、元となるWindowsサービスが開始されたディレクトリを起点にして解釈されていました。
       </P
></LI
><LI
><P
><A
HREF="ecpg.html"
>ECPG</A
>でC言語の配列定義に<CODE
CLASS="FUNCTION"
>sizeof()</CODE
>を使用可能にしました。
(Michael Meskes)
       </P
></LI
><LI
><P
><A
HREF="ecpg.html"
>ECPG</A
>で入れ子になったC言語スタイルのコメントをC言語中でも
<ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>中でも適切に扱えるようにしました。
(Michael Meskes)
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135741"
>E.16.3.10.1. <A
HREF="app-psql.html"
><SPAN
CLASS="APPLICATION"
>psql</SPAN
></A
></A
></H4
><P
></P
><UL
><LI
><P
><SPAN
CLASS="APPLICATION"
>psql</SPAN
>の<A
HREF="app-psql.html#APP-PSQL-META-COMMANDS"
><TT
CLASS="OPTION"
>expanded</TT
></A
>
モードでfooterが無効であるときには、<SPAN
CLASS="QUOTE"
>"No rows"</SPAN
>出力を抑止します。
(Bruce Momjian)
       </P
></LI
><LI
><P
>コネクション開始時にハングアップしたとき、Control-C押下で終了できるようにしました。
(Peter Eisentraut)
       </P
></LI
></UL
><DIV
CLASS="SECT5"
><H5
CLASS="SECT5"
><A
NAME="AEN135753"
>E.16.3.10.1.1. <A
HREF="app-psql.html#APP-PSQL-META-COMMANDS"
>バックスラッシュコマンド</A
></A
></H5
><P
></P
><UL
><LI
><P
><SPAN
CLASS="APPLICATION"
>psql</SPAN
>の<TT
CLASS="COMMAND"
>\db+</TT
>でテーブルスペースオプションが
表示されるようにしました。
(Magnus Hagander)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\do+</TT
>で演算子を実装している関数が表示されるようにしました。
(Marko Tiikkaja)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\d+</TT
>でテーブルに<TT
CLASS="LITERAL"
>oid</TT
>列がある場合だけ
<TT
CLASS="LITERAL"
>OID</TT
>行を表示するようにしました。
(Bruce Momjian)
        </P
><P
>これまでは<TT
CLASS="LITERAL"
>oid</TT
>列の有無にかかわらず常に報告されていました。
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\d</TT
>で無効になっているシステムトリガを表示するようにしました。
(Bruce Momjian)
        </P
><P
>これまでは、すべてのトリガを無効にした場合、ユーザトリガだけが無効であるものとして表示されていました。
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\copy</TT
>で「<TT
CLASS="LITERAL"
>stdin</TT
>」とセミコロンの間の空白を不要にしました。
(Etsuro Fujita)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>COPY</TT
>ですでにそうなっているように、
<TT
CLASS="COMMAND"
>\copy</TT
>で最後に行数を出力します。
(Kumar Rajeev Rastogi)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\conninfo</TT
>で<TT
CLASS="LITERAL"
>hostaddr</TT
>を使って接続した場合に
サーバの<ACRONYM
CLASS="ACRONYM"
>IP</ACRONYM
>アドレスを表示するように修正しました。
(Fujii Masao)
        </P
><P
>これまでは<TT
CLASS="COMMAND"
>\conninfo</TT
>はこのようなケースでサーバの
<ACRONYM
CLASS="ACRONYM"
>IP</ACRONYM
>アドレスを表示できませんでした。
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\conninfo</TT
>で<ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
>プロトコルバージョンを表示します。
(Marko Kreen)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\pset</TT
>のためのタブ補完が追加しました。
(Pavel Stehule)
        </P
></LI
><LI
><P
>引数無しの<TT
CLASS="COMMAND"
>\pset</TT
>で設定一覧を表示するようにしました。
(Gilles Darold)
        </P
></LI
><LI
><P
><TT
CLASS="COMMAND"
>\s</TT
>で書き出すヒストリファイル名を絶対パスに変換せずに表示するようにしました。
(Tom Lane)
        </P
><P
>これまでのコードでは表示するのに相対パスを絶対パスに変換しようと試みていましたが、しばしば誤っていました。
        </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135805"
>E.16.3.10.2. <A
HREF="app-pgdump.html"
>pg_dump</A
></A
></H4
><P
></P
><UL
><LI
><P
><A
HREF="app-pgrestore.html"
>pg_restore</A
>のオプション<TT
CLASS="OPTION"
>-I</TT
>、<TT
CLASS="OPTION"
>-P</TT
>、<TT
CLASS="OPTION"
>-T</TT
>、<TT
CLASS="OPTION"
>-n</TT
>を複数指定できるようにしました。
(Heikki Linnakangas)
       </P
><P
>これにより一度の操作で複数オブジェクトをリストアできます。
       </P
></LI
><LI
><P
>古いオブジェクトをリストア時に削除する場合にオプションで<TT
CLASS="LITERAL"
>IF EXISTS</TT
>句を<TT
CLASS="COMMAND"
>DROP</TT
>コマンド出力に加えることができます。
(Pavel Stehule)
       </P
><P
>本変更は古いオブジェクトを削除する際に不要なエラーがでるのを防ぎます。
新たな<TT
CLASS="OPTION"
>--if-exists</TT
>オプションは、<A
HREF="app-pgdump.html"
>pg_dump</A
>、
<A
HREF="app-pg-dumpall.html"
><SPAN
CLASS="APPLICATION"
>pg_dumpall</SPAN
></A
>、<A
HREF="app-pgrestore.html"
>pg_restore</A
>で
<TT
CLASS="OPTION"
>--clean</TT
>オプションも指定している場合に使用できます。
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN135827"
>E.16.3.10.3. <A
HREF="app-pgbasebackup.html"
>pg_basebackup</A
></A
></H4
><P
></P
><UL
><LI
><P
><SPAN
CLASS="APPLICATION"
>pg_basebackup</SPAN
>に<TT
CLASS="FILENAME"
>pg_xlog</TT
>ディレクトリを指定するオプション
<TT
CLASS="OPTION"
>--xlogdir</TT
>を追加しました。
(Haribabu Kommi)
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pg_basebackup</SPAN
>でバックアップコピー内のテーブルスペースを
新しい場所に移すことができます。
(Steeve Lennmark)
       </P
><P
>これは特に、プライマリと同マシンで<SPAN
CLASS="APPLICATION"
>pg_basebackup</SPAN
>を使用するときに便利です。
       </P
></LI
><LI
><P
>ネットワークストリーム経由のベースバックアップ取得を減速できるようにしました。
(Antonin Houska)
       </P
><P
><SPAN
CLASS="APPLICATION"
>pg_basebackup</SPAN
>の<TT
CLASS="OPTION"
>--max-rate</TT
>パラメータで制御できます。
       </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135846"
>E.16.3.11. ソースコード</A
></H3
><P
></P
><UL
><LI
><P
>タプルを調査情報を保持して凍結する方法を改善しました。
(Robert Haas, Andres Freund)
       </P
><P
>この変更は、タプルをできるだけ早く凍結させることの難点を除去します。
タプルのフラグビットを解析するコードは修正が必要となります。
       </P
></LI
><LI
><P
>関数宣言には<A
HREF="xfunc-c.html"
><CODE
CLASS="FUNCTION"
>PG_FUNCTION_INFO_V1</CODE
></A
>
マクロでの印づけを不要にしました。
(Peter Eisentraut)
       </P
><P
>本変更は定形的なプロトタイプ記述の必要を除去します。
なお、コンパイラ警告を避けるため、<CODE
CLASS="FUNCTION"
>PG_FUNCTION_INFO_V1</CODE
>
マクロは対応する関数定義の手前では必要です。
       </P
></LI
><LI
><P
><TT
CLASS="VARNAME"
>SnapshotNow</TT
>と<CODE
CLASS="FUNCTION"
>HeapTupleSatisfiesNow()</CODE
>を除去しました。
(Robert Haas)
       </P
><P
>既存の使用箇所はより適切なスナップショットタイプに切り替えられます。
これからはカタログスキャンに<ACRONYM
CLASS="ACRONYM"
>MVCC</ACRONYM
>スナップショットが使われます。
       </P
></LI
><LI
><P
>1GB以上のメモリ割り当てが可能な<ACRONYM
CLASS="ACRONYM"
>API</ACRONYM
>を追加しました。
(Noah Misch)
       </P
></LI
><LI
><P
>文字列構成用のメモリ割り当てを簡単にする<CODE
CLASS="FUNCTION"
>psprintf()</CODE
>を追加しました。
(Peter Eisentraut, Tom Lane)
       </P
></LI
><LI
><P
><TT
CLASS="TYPE"
>size_t</TT
>値を表示する
<CODE
CLASS="FUNCTION"
>printf()</CODE
>のサイズ修飾子<TT
CLASS="LITERAL"
>z</TT
>をサポートしました。
(Andres Freund)
       </P
></LI
><LI
><P
><CODE
CLASS="FUNCTION"
>vsnprintf()</CODE
>をよりよく使用するように
<CODE
CLASS="FUNCTION"
>appendStringInfoVA()</CODE
><ACRONYM
CLASS="ACRONYM"
>API</ACRONYM
>が変更されました。
(David Rowley, Tom Lane)
       </P
></LI
><LI
><P
>新たな種類の外部TOASTデータを作成できるようにしました。
(Andres Freund)
       </P
></LI
><LI
><P
>単一リーダ、単一ライタの軽量な共有メッセージキューを追加しました。
(Robert Haas)
       </P
></LI
><LI
><P
>x86_64 <ACRONYM
CLASS="ACRONYM"
>CPU</ACRONYM
>のスピンロックスピードを改善しました。
(Heikki Linnakangas)
       </P
></LI
><LI
><P
>サポートされないプラットフォーム<SPAN
CLASS="PRODUCTNAME"
>SINIX</SPAN
>、<SPAN
CLASS="PRODUCTNAME"
>Sun3</SPAN
>、<SPAN
CLASS="PRODUCTNAME"
>NS32K</SPAN
>のスピンロックサポートを除去しました。
(Robert Haas)
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>IRIX</ACRONYM
>移植を無くしました。
(Robert Haas)
       </P
></LI
><LI
><P
><TT
CLASS="OPTION"
>--disable-spinlocks</TT
>指定でビルドしたことによる必要セマフォ数を減らしました。
(Robert Haas)
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>duplicate_oids</SPAN
>シェルスクリプトを<SPAN
CLASS="APPLICATION"
>Perl</SPAN
>で書き直しました。
(Andrew Dunstan)
       </P
></LI
><LI
><P
>クライアントプログラムむけにTest Anything Protocol(<ACRONYM
CLASS="ACRONYM"
>TAP</ACRONYM
>)のテストを追加しました。
(Peter Eisentraut)
       </P
><P
>現在、これらのテストは<TT
CLASS="LITERAL"
>make check-world</TT
>で
<TT
CLASS="OPTION"
>--enable-tap-tests</TT
>が<SPAN
CLASS="APPLICATION"
>configure</SPAN
>に指定されたときのみ実行されます。
将来の機能リリースでデフォルトの振る舞いになるかもしれません。
       </P
></LI
><LI
><P
>makeターゲットに、選択した個々のテストを実行できる<TT
CLASS="OPTION"
>check-tests</TT
>と<TT
CLASS="OPTION"
>installcheck-tests</TT
>を追加しました。(Andrew Dunstan)
       </P
></LI
><LI
><P
>makefileルールの<TT
CLASS="OPTION"
>maintainer-check</TT
>を除去しました。
(Peter Eisentraut)
       </P
><P
>これからはデフォルトのビルドルールに以前はオプションであったテストが全て含まれます。
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>PGXS</ACRONYM
>モジュールの<TT
CLASS="ENVAR"
>VPATH</TT
>ビルドのサポートを改善しました。
(C&eacute;dric Villemain, Andrew Dunstan, Peter Eisentraut)
       </P
></LI
><LI
><P
>Autoconf 2.69にアップグレードしました。
(Peter Eisentraut)
       </P
></LI
><LI
><P
><TT
CLASS="ENVAR"
>PG_VERSION</TT
>文字列に任意のカスタム文字列を追加できる<SPAN
CLASS="APPLICATION"
>configure</SPAN
>フラグを追加しました。
(Oskari Saarenmaa)
       </P
><P
>パッケージ製作者がカスタムバイナリを作るのに有用です。
       </P
></LI
><LI
><P
>DocBookの<ACRONYM
CLASS="ACRONYM"
>XML</ACRONYM
>検証が改善されました。
(Peter Eisentraut)
       </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>Coverity</SPAN
>スキャナーで報告された、多様な細かなセキュリティと健全性の問題を修正しました。
(Stephen Frost)
       </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を<SPAN
CLASS="APPLICATION"
>Valgrind</SPAN
>でテストしたときの
不正なメモリ利用の検出を改善しました。
(Noah Misch)
       </P
></LI
><LI
><P
>サンプル<SPAN
CLASS="APPLICATION"
>Emacs</SPAN
>設定ファイル<TT
CLASS="FILENAME"
>emacs.samples</TT
>を改善しました。
(Peter Eisentraut)
       </P
><P
>また、<TT
CLASS="FILENAME"
>.dir-locals.el</TT
>をソースツリーのトップに加えました。
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgindent</SPAN
>がtypedefsのコマンドラインリストを受け入れるようにしました。
(Bruce Momjian)
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgindent</SPAN
>を条件プリプロセッサ周辺の空行についてより賢くしました。
(Bruce Momjian)
       </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>Cygwin</SPAN
>と<SPAN
CLASS="PRODUCTNAME"
>Mingw</SPAN
>でのビルドで
<TT
CLASS="COMMAND"
>dlltool</TT
>をほとんど使用しないようにしました。
(Marco Atzeri, Hiroshi Inoue)
       </P
></LI
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>MSVC</ACRONYM
>(Windows)ビルドでクライアントのみインストールをサポートしました。
(MauMau)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN135958"
>E.16.3.12. 追加モジュール</A
></H3
><P
></P
><UL
><LI
><P
>サーバ起動時にリレーションデータを共有バッファに事前読み込みする<A
HREF="pgprewarm.html"
>pg_prewarm</A
>拡張を追加しました。
(Robert Haas)
       </P
><P
>これにより素早く完全な運用性能に達することができます。
       </P
></LI
><LI
><P
><A
HREF="pgcrypto.html"
>pgcrypto</A
>に
<ACRONYM
CLASS="ACRONYM"
>UUID</ACRONYM
>乱数を生成をする<CODE
CLASS="FUNCTION"
>gen_random_uuid()</CODE
>を追加しました。
(Oskari Saarenmaa)
       </P
><P
><A
HREF="uuid-ossp.html"
>uuid-ossp</A
>をインストールすることなく、
バージョン 4 <ACRONYM
CLASS="ACRONYM"
>UUID</ACRONYM
>が生成可能です。
       </P
></LI
><LI
><P
><A
HREF="uuid-ossp.html"
>uuid-ossp</A
>が<SPAN
CLASS="SYSTEMITEM"
>OSSP</SPAN
>UUIDライブラリだけでなく、
<SPAN
CLASS="SYSTEMITEM"
>BSD</SPAN
>や<SPAN
CLASS="SYSTEMITEM"
>e2fsprogs</SPAN
>のUUIDライブラリで動作するようにしました。
(Matteo Beccati)
       </P
><P
>この改善は、もはや廃れつつあるOSSPライブラリを必要としないので、
<SPAN
CLASS="APPLICATION"
>uuid-ossp</SPAN
>モジュールの移植性を改善します。
モジュール名は今や不適切ですが変更しないつもりです。
       </P
></LI
><LI
><P
><A
HREF="auto-explain.html"
>auto_explain</A
>に実行時間を含めるオプションを追加しました。
(Horiguchi Kyotaro)
       </P
></LI
><LI
><P
>コミットされていないトランザクションの行をdeadと報告しないように
<A
HREF="pgstattuple.html"
>pgstattuple</A
>を修正しました。
(Robert Haas)
       </P
></LI
><LI
><P
><A
HREF="pgstattuple.html"
>pgstattuple</A
>関数が<TT
CLASS="TYPE"
>regclass</TT
>型の引数を使うようにしました。
(Satoshi Nagayasu)
       </P
><P
>しばらくは<TT
CLASS="TYPE"
>text</TT
>型引数も未だサポートしますが、将来のメジャーリリースで除かれるでしょう。
       </P
></LI
><LI
><P
>スナップショット規則を一貫して尊重して<A
HREF="pgrowlocks.html"
>pgrowlocks</A
>
出力の一貫性を改善しました。
(Robert Haas)
       </P
></LI
><LI
><P
><A
HREF="pgtrgm.html"
>pg_trgm</A
>でインデックス付けされた正規表現検索のためのトリグラム選択を
改善しました。
(Alexander Korotkov)
       </P
><P
>本変更は通常低い選択性である空白文字を含むトリグラムの使用を抑止します。
       </P
></LI
><LI
><P
><A
HREF="pgxlogdump.html"
><SPAN
CLASS="APPLICATION"
>pg_xlogdump</SPAN
></A
>が<TT
CLASS="OPTION"
>--follow</TT
>オプションで活動中の
ログストリームについて報告できるようにしました。
(Heikki Linnakangas)
       </P
></LI
><LI
><P
><A
HREF="cube.html"
>cube</A
>データをより小さく格納します。
(Stas Kelvich)
       </P
><P
>既存データはダンプ、リストアで新フォーマットにする必要があります。
旧フォーマットも未だ読み取り可能です。
       </P
></LI
><LI
><P
>カーソルを使うことで<A
HREF="vacuumlo.html"
><SPAN
CLASS="APPLICATION"
>vacuumlo</SPAN
></A
>のクライアント側メモリ使用量を減らしました。
(Andrew Dunstan)
       </P
></LI
><LI
><P
><A
HREF="pgupgrade.html"
><SPAN
CLASS="APPLICATION"
>pg_upgrade</SPAN
></A
>のメモリ使用量を大幅に削減しました。
(Bruce Momjian)
       </P
></LI
><LI
><P
><A
HREF="pgupgrade.html"
><SPAN
CLASS="APPLICATION"
>pg_upgrade</SPAN
></A
>でユーザ指定する<TT
CLASS="OPTION"
>-U</TT
>オプションを
生成される解析スクリプトに渡すようにしました。
(Bruce Momjian)
       </P
></LI
></UL
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN136018"
>E.16.3.12.1. <A
HREF="pgbench.html"
><SPAN
CLASS="APPLICATION"
>pgbench</SPAN
></A
></A
></H4
><P
></P
><UL
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgbench</SPAN
>スクリプトの行の長さ制限をなくしました。
(Sawada Masahiko)
       </P
><P
>以前は<TT
CLASS="ENVAR"
>BUFSIZ</TT
>が行の長さの上限でした。
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgbench</SPAN
>に長いオプション名を追加しました。
(Fabien Coelho)
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgbench</SPAN
>にトランザクション速度を指定する<TT
CLASS="OPTION"
>--rate</TT
>オプションを追加しました。
(Fabien Coelho)
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgbench</SPAN
>に定期的に進行報告を表示する<TT
CLASS="OPTION"
>--progress</TT
>オプションを追加しました。
(Fabien Coelho)
       </P
></LI
></UL
></DIV
><DIV
CLASS="SECT4"
><H4
CLASS="SECT4"
><A
NAME="AEN136038"
>E.16.3.12.2. <A
HREF="pgstatstatements.html"
>pg_stat_statements</A
></A
></H4
><P
></P
><UL
><LI
><P
><SPAN
CLASS="APPLICATION"
>pg_stat_statements</SPAN
>がクエリ文字列の格納のために
共有メモリではなくファイルを使うようにしました。
(Peter Geoghegan)
       </P
><P
>これにより、クエリ文字列の長さの制限をなくし、デフォルトでこれまでより
たくさんの異なるステートメントを追跡できるようにしました。
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pg_stat_statements</SPAN
>の内部クエリハッシュ識別子の報告を
できるようにしました。
(Daniel Farina, Sameer Thakur, Peter Geoghegan)
       </P
></LI
><LI
><P
>クエリ文字列以外にのすべての情報について<SPAN
CLASS="APPLICATION"
>pg_stat_statements</SPAN
>を
取り出す機能を追加しました。
(Peter Geoghegan)
       </P
><P
>これにより、モニタリングツールが作成されたばかりのエントリをフェッチできるようになり、統計情報のために繰り返すクエリの性能を高めます。
       </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pg_stat_statements</SPAN
>が<TT
CLASS="COMMAND"
>DEALLOCATE</TT
>コマンドを
無視するようにしました。
(Fabien Coelho)
       </P
><P
>すでに<TT
CLASS="COMMAND"
>PREPARE</TT
>を無視するようになっていますので、より一貫性を高めます。
       </P
></LI
><LI
><P
>サーバシャットダウン時に、統計ファイルを<TT
CLASS="FILENAME"
>$PGDATA/global</TT
>ではなく、<TT
CLASS="FILENAME"
>$PGDATA/pg_stat</TT
>に保存します。
(Fujii Masao)
       </P
></LI
></UL
></DIV
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="release-9-4-1.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="release-9-3-14.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>リリース9.4.1</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="release.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>リリース9.3.14</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>