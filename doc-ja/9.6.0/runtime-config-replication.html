<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>レプリケーション</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.0文書"
HREF="index.html"><LINK
REL="UP"
TITLE="サーバの設定"
HREF="runtime-config.html"><LINK
REL="PREVIOUS"
TITLE="ログ先行書き込み（WAL）"
HREF="runtime-config-wal.html"><LINK
REL="NEXT"
TITLE="問い合わせ計画"
HREF="runtime-config-query.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2016-10-20T00:12:21"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.0文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="ログ先行書き込み（WAL）"
HREF="runtime-config-wal.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 19章サーバの設定</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="問い合わせ計画"
HREF="runtime-config-query.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RUNTIME-CONFIG-REPLICATION"
>19.6. レプリケーション</A
></H1
><P
>    
     これらの設定は組み込みの<I
CLASS="FIRSTTERM"
>ストリーミングレプリケーション</I
>機能の動作を制御します（<A
HREF="warm-standby.html#STREAMING-REPLICATION"
>項26.2.5</A
>を参照ください）。
      サーバ群のサーバはマスターかスタンバイのいずれかです。マスターはデータを送出する一方、複数のスタンバイは複製されたデータを常に受け取ります。カスケードレプリケーション（<A
HREF="warm-standby.html#CASCADING-REPLICATION"
>項26.2.7</A
>を参照）が使用されている場合、スタンバイサーバ群は受け取り手でもあり、送り手でもあります。
      パラメータは主として送出サーバとスタンバイサーバ用ですが、いくつかのパラメータはマスターサーバのみに効力を発します。
      必要とあればクラスターに渡って問題なく設定を変化させることができます。
    </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-REPLICATION-SENDER"
>19.6.1. 送出サーバ群</A
></H2
><P
>     
      これらのパラメータはレプリケーションデータを１つ、またはそれ以上複数のスタンバイサーバに送るいかなるサーバ上で設定することができます。マスターは常に送出サーバであるため、パラメータは常にマスター上に設定されなければなりません。これらのパラメータの役割と意味はスタンバイが後にマスターに昇格しても変わりません。
     </P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-MAX-WAL-SENDERS"
></A
><TT
CLASS="VARNAME"
>max_wal_senders</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
       </DT
><DD
><P
>       
       複数のスタンバイサーバ、またはストリーミングを基盤とする予備（バックアップ）クライアントからの同時接続を受ける接続最大値を設定します（つまり、同時に稼動するWAL送信プロセスの最大値です）。
       デフォルトはゼロです。その意味するところはレプリケーションは無効です。
       WAL送出プロセスは接続の総数カウントに考慮されるため、<A
HREF="runtime-config-connection.html#GUC-MAX-CONNECTIONS"
>max_connections</A
>を越えたパラメータの設定できません。

        クライアント接続が突然切断されると、タイムアウトするまで孤児接続スロットが残ってしまうかもしれません。
ですから、このパラメータは想定されるクライアント数の最大値よりも少し大きめにして、切断されたクライアントが直ちに再接続できるようにした方が良いでしょう。
       このパラメータはサーバ起動時のみ設定可能です。
スタンバイサーバからの接続を許可するには、<TT
CLASS="VARNAME"
>wal_level</TT
>を<TT
CLASS="LITERAL"
>replica</TT
>以上に設定しておかなければなりません。
       </P
></DD
><DT
><A
NAME="GUC-MAX-REPLICATION-SLOTS"
></A
><TT
CLASS="VARNAME"
>max_replication_slots</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
       </DT
><DD
><P
>        サーバが使用できるレプリケーションスロット(<A
HREF="warm-standby.html#STREAMING-REPLICATION-SLOTS"
>項26.2.6</A
>参照)の最大数を指定します。デフォルトは0です。
       このパラメータはサーバ起動時のみ設定可能です。
レプリケーションスロットが使用できるためには、<TT
CLASS="VARNAME"
>wal_level</TT
>を<TT
CLASS="LITERAL"
>replica</TT
>以上に設定しなければなりません。
         現在存在しているレプリケーションスロットの数よりも少ない値を設定すると、サーバは起動しません。
        </P
></DD
><DT
><A
NAME="GUC-WAL-KEEP-SEGMENTS"
></A
><TT
CLASS="VARNAME"
>wal_keep_segments</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
       </DT
><DD
><P
>       
        ストリーミングレプリケーションにおいて、スタンバイサーバが過去のファイルセグメントを取得する必要がある場合に備え、<TT
CLASS="FILENAME"
>pg_xlog</TT
>ディレクトリに保持しておくファイルセグメント数の最小値を指定します。
       それぞれのセグメントは通常16メガバイトです。
       もし送出サーバに接続しているスタンバイサーバが<TT
CLASS="VARNAME"
>wal_keep_segments</TT
>セグメントを越えて遅延した場合、送出サーバはスタンバイサーバが今後とも必要とするWALセグメントを削除する可能性があります。
       この場合、レプリケーション接続は終了させられます。結果として下流に対する接続も結局は終了されることがあります。（しかし、WALアーカイブが使用されていれば、スタンバイサーバはアーカイブからセグメントを取り出し、復旧することができます。）
       </P
><P
>       
       <TT
CLASS="FILENAME"
>pg_xlog</TT
>に保持され続けるセグメントの最小値のみを設定します。
       システムはWALアーカイブのため、またはチェックポイントからの復旧のため、より多くのセグメント保持が必要となることがあります。もし<TT
CLASS="VARNAME"
>wal_keep_segments</TT
>が（デフォルトの）ゼロの場合、システムはスタンバイサーバのために追加セグメントを保持することはしません。
        従って、スタンバイサーバが使用できる古いWALセグメントの数は、直前のチェックポイントの場所とWALアーカイブの状況によって算出されます。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
></DD
><DT
><A
NAME="GUC-WAL-SENDER-TIMEOUT"
></A
><TT
CLASS="VARNAME"
>wal_sender_timeout</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>       
       指定されたミリ秒単位の値より長く非活動のレプリケーション接続を停止します。
       スタンバイサーバのクラッシュ、またはネットワークの停止を送出サーバが検出することにこれが役立ちます。
       値ゼロはタイムアウト機能を無効にします。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       デフォルトの値は60秒です。
       </P
></DD
><DT
><A
NAME="GUC-TRACK-COMMIT-TIMESTAMP"
></A
><TT
CLASS="VARNAME"
>track_commit_timestamp</TT
> (<TT
CLASS="TYPE"
>bool</TT
>)
      </DT
><DD
><P
>トランザクションのコミットタイムを記録します。
このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
デフォルトは<TT
CLASS="LITERAL"
>off</TT
>です。
       </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-REPLICATION-MASTER"
>19.6.2. マスターサーバ</A
></H2
><P
>      
      これらのパラメータはレプリケーションデータを１つ、またはそれ以上複数のスタンバイサーバに送るマスター/プライマリサーバ上で設定することができます。
      これらパラメータに加え、<A
HREF="runtime-config-wal.html#GUC-WAL-LEVEL"
>wal_level</A
>はマスターサーバ上で適切に設定される必要があり、オプションとしてWALアーカイブを有効にしてもかまいません（<A
HREF="runtime-config-wal.html#RUNTIME-CONFIG-WAL-ARCHIVING"
>項19.5.3</A
>を参照してください）。
      スタンバイサーバがマスターサーバになるかもしれない状況に備え、それらのパラメータをスタンバイサーバで設定したいと考えたとしても、スタンバイサーバ上でのパラメータの値は意味をなしません。
     </P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-SYNCHRONOUS-STANDBY-NAMES"
></A
><TT
CLASS="VARNAME"
>synchronous_standby_names</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
      </DT
><DD
><P
><A
HREF="warm-standby.html#SYNCHRONOUS-REPLICATION"
>項26.2.8</A
>で説明されているように、<I
CLASS="FIRSTTERM"
>同期レプリケーション</I
>をサポート可能なスタンバイサーバの名前をコンマで区切られたリストで指定します。
活動中の同期スタンバイサーバは1つまたはそれ以上です。
コミットを待機しているトランザクションは、このスタンバイサーバがそのデータの受信を確認してから処理の継続が許可されます。
同期スタンバイサーバはこのリストの最初の方に名前が挙げられていており、現時点で接続され、そしてデータをリアルタイムでストリーミングしているものです（<A
HREF="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE"
><TT
CLASS="LITERAL"
>pg_stat_replication</TT
></A
> ビューにおいて<TT
CLASS="LITERAL"
>streaming</TT
>状態として示されています）。
このリストの後の方に記載されているその他のスタンバイサーバは潜在的に同期スタンバイサーバになることを示しています。
もし現在の同期スタンバイサーバが理由にかかわらず切断された場合、次に順位の高いスタンバイサーバがすぐに取って代わります。
二つ以上のスタンバイサーバ名を指定することでかなりの高可用性が得られます。
       </P
><P
>このパラメータは、以下の構文のいずれかを用いてスタンバイサーバのリストを指定します。
</P><PRE
CLASS="SYNOPSIS"
><TT
CLASS="REPLACEABLE"
><I
>num_sync</I
></TT
> ( <TT
CLASS="REPLACEABLE"
><I
>standby_name</I
></TT
> [, ...] )
<TT
CLASS="REPLACEABLE"
><I
>standby_name</I
></TT
> [, ...]</PRE
><P>
ここで、<TT
CLASS="REPLACEABLE"
><I
>num_sync</I
></TT
>は、トランザクションが応答を待機する必要のある同期スタンバイの数です。
<TT
CLASS="REPLACEABLE"
><I
>standby_name</I
></TT
>は、スタンバイサーバの名前です。
たとえば<TT
CLASS="LITERAL"
>3 (s1, s2, s3, s4)</TT
>とすると、<TT
CLASS="LITERAL"
>s1</TT
>、<TT
CLASS="LITERAL"
>s2</TT
>、<TT
CLASS="LITERAL"
>s3</TT
>、<TT
CLASS="LITERAL"
>s4</TT
>の中から選ばれた優先順位の高い3つのスタンバイサーバがWALレコードを受信するまでコミットは待機します。
        </P
><P
>2番目の構文は、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>9.6よりも前のバージョンで用いられていたもので、依然としてサポートされています。
最初の構文で<TT
CLASS="REPLACEABLE"
><I
>num_sync</I
></TT
>を1とした時と同じです。
たとえば<TT
CLASS="LITERAL"
>1 (s1, s2)</TT
>と<TT
CLASS="LITERAL"
>s1, s2</TT
>は同じ意味です。
どちらにおいても、<TT
CLASS="LITERAL"
>s1</TT
>か<TT
CLASS="LITERAL"
>s2</TT
>が同期スタンバイとして選ばれます。
       </P
><P
>        The name of a standby server for this purpose is the
        <TT
CLASS="VARNAME"
>application_name</TT
> setting of the standby, as set in the
        <TT
CLASS="VARNAME"
>primary_conninfo</TT
> of the standby's WAL receiver.  There is
        no mechanism to enforce uniqueness. In case of duplicates one of the
        matching standbys will be considered as higher priority, though
        exactly which one is indeterminate.
        The special entry <TT
CLASS="LITERAL"
>*</TT
> matches any
        <TT
CLASS="VARNAME"
>application_name</TT
>, including the default application name
        of <TT
CLASS="LITERAL"
>walreceiver</TT
>.
       --&#62;
この目的のスタンバイサーバの名前は、スタンバイサーバのWAL receiverの<TT
CLASS="VARNAME"
>primary_conninfo</TT
>で設定されるのと同じく、スタンバイサーバの<TT
CLASS="VARNAME"
>application_name</TT
>設定となります。
一意性を強要する仕組みにはなっていません。
重複があった場合、一致したスタンバイは優先順位が高いと見なされますが、どれが選ばれるかは非決定的です。
特別の記載である<TT
CLASS="LITERAL"
>*</TT
>は、<TT
CLASS="LITERAL"
>walreceiver</TT
>のデフォルトのアプリケーション名を含めて、全ての<TT
CLASS="VARNAME"
>application_name</TT
>にマッチします。
       </P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>注意: </B
>各々の<TT
CLASS="REPLACEABLE"
><I
>standby_name</I
></TT
>は、<TT
CLASS="LITERAL"
>*</TT
>である場合を除き、SQL識別子の形式を取らなければなりません。
二重引用符を用いることもできます。
しかし、二重引用符の有無に関わらず、<TT
CLASS="REPLACEABLE"
><I
>standby_name</I
></TT
>とスタンバイのアプリケーション名の比較は、大文字小文字の区別なしに行われることに注意してください。
        </P
></BLOCKQUOTE
></DIV
><P
>       
       ここに同期スタンバイ名が指定されていない場合、同期レプリケーションは有効とはならず、トランザクションコミットはレプリケーションを待機しません。これがデフォルトの設定です。同期レプリケーションが有効であっても、<A
HREF="runtime-config-wal.html#GUC-SYNCHRONOUS-COMMIT"
>synchronous_commit</A
>パラメータを<TT
CLASS="LITERAL"
>local</TT
> または <TT
CLASS="LITERAL"
>off</TT
>に設定することにより、個別のトランザクションをレプリケーションに対して待機しないように設定できます。
       </P
><P
>       
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
></DD
><DT
><A
NAME="GUC-VACUUM-DEFER-CLEANUP-AGE"
></A
><TT
CLASS="VARNAME"
>vacuum_defer_cleanup_age</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>       
       <TT
CLASS="COMMAND"
>VACUUM</TT
> および <ACRONYM
CLASS="ACRONYM"
>HOT</ACRONYM
>更新が不要行バージョンの回収を決めるのを延期するトランザクションの数を指定します。デフォルトはゼロトランザクションです。この意味は、不要行バージョンは速やかに削除され、いかなる開いているトランザクションから直ちに不可視となります。
       <A
HREF="hot-standby.html"
>項26.5</A
>に記載されているように、ホットスタンバイサーバをサポートしている場合、非ゼロ値に設定したい場合があります。そうすることで、スタンバイ上での問い合わせが、行の早期回収によるコンフリクトを被ることなく完了するように時間を与える。しかし、値はプライマリーサーバ上で発生している書き込みトランザクションの観点から計測されるため、スタンバイの問い合わせにたいして猶予時間がどのくらい有効となるかは予測できません。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
><P
>       
       このパラメータの使用の代わりにスタンバイサーバ上に <TT
CLASS="VARNAME"
>hot_standby_feedback</TT
>の設定を考慮する必要もあります。
       </P
><P
>        This does not prevent cleanup of dead rows which have reached the age
        specified by <TT
CLASS="VARNAME"
>old_snapshot_threshold</TT
>.
       </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-REPLICATION-STANDBY"
>19.6.3. スタンバイサーバ</A
></H2
><P
>     
      これらの設定はレプリケーションデータを受け取るスタンバイサーバの動作を管理します。
      マスターサーバ上のこれらの値は無意味です。
     </P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-HOT-STANDBY"
></A
><TT
CLASS="VARNAME"
>hot_standby</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
      </DT
><DD
><P
>       
       <A
HREF="hot-standby.html"
>項26.5</A
>に記載されている通り、リカバリの最中に接続し、そして問い合わせを実行できるか否かを設定します。デフォルト値は<TT
CLASS="LITERAL"
>off</TT
>です。
       このパラメータはサーバ起動時のみ設定可能です。これは、アーカイブリカバリ期間、又はスタンバイモードにある場合にのみ効果をもたらします。
       </P
></DD
><DT
><A
NAME="GUC-MAX-STANDBY-ARCHIVE-DELAY"
></A
><TT
CLASS="VARNAME"
>max_standby_archive_delay</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>       
        ホットスタンバイが稼動している場合、このパラメータは<A
HREF="hot-standby.html#HOT-STANDBY-CONFLICT"
>項26.5.2</A
>で記載されているように、まさに適用されようとしているWALエントリと衝突するスタンバイサーバの問い合わせをキャンセルするにはどれだけ待機しなければならないかを設定します。
        <TT
CLASS="VARNAME"
>max_standby_archive_delay</TT
>はWALデータをWALアーカイブから読み込んでいる時に適用されます（従って最新ではありません）。
       デフォルトは30秒です。特に指定が無ければ単位はミリ秒です。値-1は衝突する問い合わせが完了するまでスタンバイサーバが待ち続けられるようにします。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
><P
>       
        <TT
CLASS="VARNAME"
>max_standby_archive_delay</TT
>はキャンセル前に問い合わせが実行できる最大の時間の長さと同じでないことに注意してください。むしろ、任意の１つのWALセグメントのデータに適用される最大許可時間です。従って、ある問い合わせがWALセグメント内で時間的に初期の段階で大幅な遅延となった場合、その後の衝突する問い合わせの猶予時間はましてさらに短くなります。
       </P
></DD
><DT
><A
NAME="GUC-MAX-STANDBY-STREAMING-DELAY"
></A
><TT
CLASS="VARNAME"
>max_standby_streaming_delay</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>       
        ホットスタンバイが稼動している場合、このパラメータは<A
HREF="hot-standby.html#HOT-STANDBY-CONFLICT"
>項26.5.2</A
>で記載されているように、まさに適用されようとしているWALエントリと衝突するスタンバイサーバの問い合わせをキャンセルするにはどれだけ待機しなければならないかを設定します。
        <TT
CLASS="VARNAME"
>max_standby_streaming_delay</TT
>はWALデータをストリーミングレプリケーションから受け取っている時に適用されます。
       デフォルトは30秒です。特に指定が無ければ単位はミリ秒です。値-1は衝突する問い合わせが完了するまでスタンバイサーバが待ち続けられるようにします。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
><P
>       
        <TT
CLASS="VARNAME"
>max_standby_streaming_delay</TT
>はキャンセル前に問い合わせが実行できる最大の時間の長さと同じでないことに注意してください。むしろ、プライマリサーバから一度受け取られたWALデータを適用するための最大許可時間です。
       従って、ある問い合わせがWALセグメントにおいてそれまでに大幅な遅延となった場合、それに続いて衝突する問い合わせは、スタンバイサーバがふたたび遅れを取り戻すまで、猶予時間はさらに短くなります。
       </P
></DD
><DT
><A
NAME="GUC-WAL-RECEIVER-STATUS-INTERVAL"
></A
><TT
CLASS="VARNAME"
>wal_receiver_status_interval</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>      
       スタンバイサーバ上のWAL受信プロセスがプライマリー、または上位サーバに対してレプリケーションの進捗情報を送信する最小頻度を指定します。送信された進捗情報は<A
HREF="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE"
>       <TT
CLASS="LITERAL"
>pg_stat_replication</TT
></A
>ビューにより確認することが可能です。
       スタンバイサーバは書き込みがされた直近のログ位置、ディスクにフラッシュされた直近のログ位置、およびリカバリ適用された直近のログ位置を報告します。
       このパラメータの値がそれぞれの報告間における秒単位の最大の時間間隔です。
       書き込み、またはフラッシュ位置が変更される毎、あるいは最低でもこのパラメータで設定された頻度で更新情報が送信されます。
       このパラメータをゼロに設定すると、ステータスの更新を完全に無効化します。
       このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       デフォルトの値は10秒です。
      </P
></DD
><DT
><A
NAME="GUC-HOT-STANDBY-FEEDBACK"
></A
><TT
CLASS="VARNAME"
>hot_standby_feedback</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
      </DT
><DD
><P
>       
       ホットスタンバイがスタンバイサーバ上で現在処理を行っている問い合わせについて、プライマリーまたは上位サーバにフィードバックを送るか否かを指定します。
       このパラメータはレコードの回収に起因する問い合わせの取り消しを排除するために使用することができます。
       しかし、いくつかのワークロードに対してはプライマリーサーバ上でのデータベース肥大の原因となります。
       フィードバックメッセージは<TT
CLASS="VARNAME"
>wal_receiver_status_interval</TT
>毎に、2回以上送信されません。
       デフォルトの値は<TT
CLASS="LITERAL"
>off</TT
>です。
        このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
       </P
><P
>       
       カスケードレプリケーションが使用されている場合、フィードバックは最終的にプライマリーに到達するまで上位サーバに転送されます。スタンバイは上位に転送する以外、受け取ったフィードバックを他に使用しません。
       </P
><P
>この設定は、プライマリの<TT
CLASS="VARNAME"
>old_snapshot_threshold</TT
>の挙動を上書きしません。
プライマリの年齢上限を超えたスタンバイ上のスナップショットは無効となる可能性があり、その場合スタンバイにおいてトランザクションのキャンセルを引き起こします。
これは、<TT
CLASS="VARNAME"
>old_snapshot_threshold</TT
>が、無効行によってデータ溢れが起こる時刻の絶対的な制限を提供することを意図しているからです。
そうでなければ、スタンバイの設定によってこの目的は成立しなくなってしまいます。
       </P
></DD
><DT
><A
NAME="GUC-WAL-RECEIVER-TIMEOUT"
></A
><TT
CLASS="VARNAME"
>wal_receiver_timeout</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>       
       指定されたミリ秒より長い活動していないレプリケーション接続は停止します。
       このことは受信するスタンバイサーバがプライマリノードの機能停止、またはネットワーク停止を検出するのに便利です。
       値ゼロは時間切れメカニズムを無効にします。このパラメータは<TT
CLASS="FILENAME"
>postgresql.conf</TT
>またはサーバのコマンドラインのみで設定可能です。
       デフォルト値は60秒です。
       </P
></DD
><DT
><A
NAME="GUC-WAL-RETRIEVE-RETRY-INTERVAL"
></A
><TT
CLASS="VARNAME"
>wal_retrieve_retry_interval</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>WALデータがソース(ストリーミングレプリケーション、ローカルの<TT
CLASS="FILENAME"
>pg_xlog</TT
>、またはWALアーカイブ)から取得できない時に、スタンバイサーバがWALデータ受信をリトライするまでにどの位の時間待つべきかを指定します。
このパラメータは、<TT
CLASS="FILENAME"
>postgresql.conf</TT
>ファイル、もしくはサーバコマンドラインでのみ設定可能です。
デフォルト値は5秒です。
特に指定がなければ単位はミリ秒です。
       </P
><P
>このパラメータは、リカバリ対象のノードにおいて、新しいWALデータが読み込み可能になるまでの待ち時間を制御する必要のある時に有用です。
たとえば、アーカイブリカバリにおいては、このパラメータの値を小さくすることにより、新しいWALログファイルを検出する際にリカバリの応答を早くすることができます。
WALの生成頻度が少ないシステムでは、この値を大きくすることにより、WALアーカイブへのアクセス頻度を減らすことができます。
これは、たとえば基盤へのアクセス回数が課金対象になるクラウド環境において、有用です。
       </P
><P
>        This parameter is useful in configurations where a node in recovery
        needs to control the amount of time to wait for new WAL data to be
        available. For example, in archive recovery, it is possible to
        make the recovery more responsive in the detection of a new WAL
        log file by reducing the value of this parameter. On a system with
        low WAL activity, increasing it reduces the amount of requests necessary
        to access WAL archives, something useful for example in cloud
        environments where the amount of times an infrastructure is accessed
        is taken into account.
       </P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-config-wal.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="runtime-config-query.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>ログ先行書き込み（WAL）</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>問い合わせ計画</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>