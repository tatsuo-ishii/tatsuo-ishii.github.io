<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>インデックスの種類</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.5.2文書"
HREF="index.html"><LINK
REL="UP"
TITLE="インデックス"
HREF="indexes.html"><LINK
REL="PREVIOUS"
TITLE="序文"
HREF="indexes-intro.html"><LINK
REL="NEXT"
TITLE="複数列インデックス"
HREF="indexes-multicolumn.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2016-05-13T05:09:04"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.5.2文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="序文"
HREF="indexes-intro.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="indexes.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 11章インデックス</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="複数列インデックス"
HREF="indexes-multicolumn.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="INDEXES-TYPES"
>11.2. インデックスの種類</A
></H1
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>では、B-tree、Hash、GiST、SP-GiST、GIN、BRINといった複数の種類のインデックスを使用可能です。
インデックスの各種類は、異なる種類の問い合わせに最も適した、異なるアルゴリズムを使用します。
デフォルトで<TT
CLASS="COMMAND"
>CREATE INDEX</TT
>コマンドは、B-treeインデックスを作成し、それはほとんどの一般的状況に適合します。
  </P
><P
>   
   
B-treeインデックスは、ある順番でソート可能なデータに対する等価性や範囲を問い合わせることを扱うことができます。
具体的には、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の問い合わせプランナは、インデックスの付いた列を次の演算子を使用して比較する場合に、B-treeインデックスの使用を検討します。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

また、<TT
CLASS="LITERAL"
>BETWEEN</TT
>や<TT
CLASS="LITERAL"
>IN</TT
>などのこれらの演算子の組み合わせと等価な式をB-treeインデックス検索で実装することができます。
インデックスの付いた列に対する<TT
CLASS="LITERAL"
>IS NULL</TT
>や<TT
CLASS="LITERAL"
>IS NOT NULL</TT
>でもB-treeインデックスを使用することができます。
  </P
><P
>オプティマイザは、パターンマッチ演算子<TT
CLASS="LITERAL"
>LIKE</TT
>、<TT
CLASS="LITERAL"
>~</TT
>を含む問い合わせでも、そのパターンが定数であり、先頭文字列を指定している<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>場合</I
></SPAN
>B-treeインデックスを使用することができます。
例えば、<TT
CLASS="LITERAL"
>col LIKE 'foo%'</TT
>または<TT
CLASS="LITERAL"
>col ~ '^foo'</TT
>です。
<TT
CLASS="LITERAL"
>col LIKE '%bar'</TT
>では使用されません。
しかし、データベースがCロケールを使用していない場合、パターンマッチ問い合わせのインデックス付けをサポートする特別な演算子クラスでインデックスを作成しなければなりません。
後述の<A
HREF="indexes-opclass.html"
>項11.9</A
>を参照してください。
なお、<TT
CLASS="LITERAL"
>ILIKE</TT
>と<TT
CLASS="LITERAL"
>~*</TT
>でもB-treeインデックスを使用することができますが、パターンが英字以外の文字、つまり、大文字小文字の違いの影響がない文字で始まる場合のみです。
  </P
><P
>B-treeインデックスをソートされた順序でデータを受けとるために使用することもできます。
これは常に単純なスキャンとソート処理より高速になるものではありませんが、よく役に立つことがあります。
  </P
><P
>   
   
ハッシュインデックスは単純な等価性比較のみを扱うことができます。
問い合わせプランナでは、インデックスの付いた列を<TT
CLASS="LITERAL"
>=</TT
>演算子を使用して比較する場合に、ハッシュインデックスの使用を検討します。
ハッシュインデックスを作成するには、以下のようなコマンドを使用してください。
</P><PRE
CLASS="SYNOPSIS"
>CREATE INDEX <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> ON <TT
CLASS="REPLACEABLE"
><I
>table</I
></TT
> USING HASH (<TT
CLASS="REPLACEABLE"
><I
>column</I
></TT
>);</PRE
><P>
  </P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>注意</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>現在ハッシュインデックス操作はWALに記録されません。
そのため、データベースクラッシュの後ハッシュインデックスを<TT
CLASS="COMMAND"
>REINDEX</TT
>で再構築しなければならない可能性があります。
また、最初のバックアップを取得して以降、ストリーミングレプリケーションやファイルベースのレプリケーションでは変更が反映されないため、その後ハッシュインデックスを使うクエリは誤った結果を返します。
これらの理由により、ハッシュインデックスの使用は現在お勧めできません。
   </P
></TD
></TR
></TABLE
></DIV
><P
>   
   
GiSTインデックスは単一種類のインデックスではなく、多くの異なるインデックス戦略を実装することができる基盤です。
したがって、具体的なGiSTインデックスで使用できる演算子はインデックス戦略（<I
CLASS="FIRSTTERM"
>演算子クラス</I
>）によって異なります。
例えば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の標準配布物には、複数の二次元幾何データ型用のGiST演算子クラスが含まれています。
これらの演算子を使用してインデックス付けされた問い合わせをサポートします。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;&lt;|</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&lt;|</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>|&amp;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>|&gt;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>@&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;@</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>~=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&amp;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

（これらの演算子の意味については<A
HREF="functions-geometry.html"
>項9.11</A
>を参照してください。）
標準配布物に含まれるGiST演算子クラスは<A
HREF="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE"
>表59-1</A
>に記載されています。
他の多くのGiST演算子クラスが<TT
CLASS="LITERAL"
>contrib</TT
>群や別のプロジェクトとして利用可能です。
詳細は<A
HREF="gist.html"
>第59章</A
>を参照してください。
  </P
><P
>GiSTインデックスは以下のような<SPAN
CLASS="QUOTE"
>"最近傍"</SPAN
>検索を最適化する機能も持ちます。
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT * FROM places ORDER BY location &#60;-&#62; point '(101,456)' LIMIT 10;</PRE
><P>
これは指定された対象地点に最も近い１０箇所を見つけ出します。
繰り返しますが、これができるかどうかは使用される特定の演算子クラスに依存します。
このように利用できる演算子は<A
HREF="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE"
>表59-1</A
>の<SPAN
CLASS="QUOTE"
>"Ordering Operators"</SPAN
>列に表示されています。
  </P
><P
>   
   
SP-GiSTインデックスは、GiSTインデックスと同様に様々な種類の検索を支援する基盤を提供します。
SP-GiSTインデックスは広域な異なる不均衡でディスクベースのデータ構造、つまり、四分木,kd木、基数木のような実装を認めます。
例えば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>標準配布物には、以下の演算子を使用する問い合わせに対するインデックスをサポートする2次元の点用のSP-GiST用の演算子クラスが含まれています。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>~=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;@</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;^</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;^</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

(演算子の意味は以下を参照してください<A
HREF="functions-geometry.html"
>項9.11</A
> )
標準配布物に含まれるSP-GiSTクラスは<A
HREF="spgist-builtin-opclasses.html#SPGIST-BUILTIN-OPCLASSES-TABLE"
>表60-1</A
>に記載されています。
詳細は <A
HREF="spgist.html"
>第60章</A
>を参照してください。
  </P
><P
>   
   
GINは転置インデックスであり、例えば配列など複数のキーを持つ値を扱うことができます。
GiSTやSP-GiST同様、GINも多くの異なるユーザ定義のインデックス戦略を持つことができ、GINが使用できる具体的な演算子はインデックス戦略によって変化します。
例えば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>標準配布物には、1次元配列用のGIN演算子クラスが含まれています。
これは、以下の演算子を使用する問い合わせに対するインデックスをサポートします。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;@</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>@&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&amp;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

（これらの演算子の意味については<A
HREF="functions-array.html"
>項9.18</A
>を参照してください。）
標準配布物に含まれるGIN演算子クラスは<A
HREF="gin-builtin-opclasses.html#GIN-BUILTIN-OPCLASSES-TABLE"
>表61-1</A
>に記載されています。
他の多くのGIN演算子クラスは<TT
CLASS="LITERAL"
>contrib</TT
>群または別のプロジェクトで利用可能です。
詳細は<A
HREF="gin.html"
>第61章</A
>を参照してください。
  </P
><P
>   
   
BRINインデックス(ブロックレンジインデックス(Block Range index)を縮めたものです)は
GiST、SP-GiST、GINと同じように、BRINは多くの異なるインデックス戦略をサポートし、BRINインデックスが使用できる具体的な演算子はインデックス戦略によって変化します。
線形のソート順を持つデータ型では、インデックス付けされたデータは各ブロックレンジの列の中の値の最小値と最大値に対応しており、以下の演算子を使用したインデックス付けされた問い合わせをサポートします。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

標準配布物に含まれるBRIN演算子クラスは<A
HREF="brin-builtin-opclasses.html#BRIN-BUILTIN-OPCLASSES-TABLE"
>表62-1</A
>.に記載されています。
詳細は<A
HREF="brin.html"
>第62章</A
>を参照してください。
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="indexes-intro.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="indexes-multicolumn.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>序文</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="indexes.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>複数列インデックス</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>