<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>A.2. Release 3.6.1</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="pgpool-II 3.7devel Documentation" /><link rel="up" href="release.html" title="Appendix A. Release Notes" /><link rel="prev" href="release-3-6.html" title="A.1. Release 3.6" /><link rel="next" href="release-3-6-2.html" title="A.3. Release 3.6.2" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.2. Release 3.6.1</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="release-3-6.html">Prev</a> </td><th width="60%" align="center">Appendix A. Release Notes</th><td width="20%" align="right"> <a accesskey="n" href="release-3-6-2.html">Next</a></td></tr></table><hr /></div><div class="sect1" id="release-3-6-1"><div class="titlepage"><div><div><h2 class="title" style="clear: both">A.2. Release 3.6.1</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Release Date</h3><p>2016-12-26</p></div><div class="sect2" id="idm45737772340720"><div class="titlepage"><div><div><h3 class="title">A.2.1. Bug fixes</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>      Tightening up the watchdog security. (Muhammad Usama)
    </p><p>      Now wd_authkey uses the HMAC SHA-256 hashing.
	</p></li><li class="listitem"><p>	  Add pgpool_adm extension in <span class="productname">Pgpool-II</span> RPM. (Bo Peng)
	</p></li><li class="listitem"><p>	  Fix occasional segfault when query cache is enabled. (bug 263) (Tatsuo Ishii)
	</p></li><li class="listitem"><p>	  Fix packet kind does not match error in extended protocol. (bug 231) (Tatsuo Ishii)
	</p><p>	  According to the bug231, the bug seem to bite you if all of
	  following conditions are met:
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>	      Streaming replication mode
	    </p></li><li class="listitem"><p>	      Load balance node is not node 0
	    </p></li><li class="listitem"><p>	      Extended protocol is used
	      </p></li><li class="listitem"><p>	      SELECT is executed, the statement is closed, then a
	      transaction command is executed
	    </p></li></ul></div><p>	The sequence of how the problem bites is:
	</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>	      SELECT executes on statement S1 on the load balance node 1
	    </p></li><li class="listitem"><p>	      Frontend send Close statement
	    </p></li><li class="listitem"><p>	      Pgool-II forward it to backend 1
	    </p></li><li class="listitem"><p>	      Frontend sends Parse, Bind, Execute of COMMIT
	    </p></li><li class="listitem"><p>	      Pgool-II forward it to backend 0 &amp; 1
	    </p></li><li class="listitem"><p>	      Frontend sends sync message
	    </p></li><li class="listitem"><p>	      Pgool-II forward it to backend 0 &amp; 1
	    </p></li><li class="listitem"><p>	      Backend 0 replies back Parse complete ("1"), while
	      backend 1 replies back close complete ("3") because of
	      #3.
	    </p></li><li class="listitem"><p>	      Kind mismatch occurs
	    </p></li></ol></div><p>

	</p><p>	  The solution is, in #3, let Pgpool-II wait for response from backend
	  1, but do not read the response message. Later on Pgpool-II's state
	  machine will read the response from it before the sync message is sent
	  in #6. With this, backend 1 will reply back "1" in #8, and the kind
	  mismatch error does not occur.
	</p><p>	  Also, fix not calling pool_set_doing_extended_query_message() when
	  receives Close message.  (I don't know why it was missed).
	</p><p>	  New regression test "067.bug231" was added.
	</p></li><li class="listitem"><p>	  Fix a race condition in a signal handler. (bug 265) (Tatsuo Ishii)
	</p><p>	  In child.c there's signal handler which calls elog. Since the signal
	  handler is not blocked against other signals while processing, deadlock
	  could occur in the system calls in the pgpool shutdown sequence. To
	  fix the problem, now the signal handler is blocked by using
	  POOL_SETMASK.
	</p><p>	  Ideally we should avoid calling elog in signal handlers though.
	</p></li><li class="listitem"><p>	  Fix wrong minimum configuration value for client_idle_limit_in_recovery. (bug 264) (Tatsuo Ishii)
	</p></li><li class="listitem"><p>	  Allow to execute "make xslthtml" under doc.ja. (Tatsuo Ishii)
	</p><p>
	</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-3-6.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-3-6-2.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">A.1. Release 3.6 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> A.3. Release 3.6.2</td></tr></table></div></body></html>