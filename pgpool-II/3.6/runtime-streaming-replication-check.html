<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.11. Streaming Replication Check</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="pgpool-II 3.6beta2 Documentation" /><link rel="up" href="runtime-config.html" title="Chapter 5. Server Configuration" /><link rel="prev" href="runtime-online-recovery.html" title="5.10. Online Recovery" /><link rel="next" href="runtime-in-memory-query-cache.html" title="5.12. In Memory Query Cache" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.11. Streaming Replication Check</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="runtime-online-recovery.html">Prev</a> </td><th width="60%" align="center">Chapter 5. Server Configuration</th><td width="20%" align="right"> <a accesskey="n" href="runtime-in-memory-query-cache.html">Next</a></td></tr></table><hr /></div><div class="sect1" id="runtime-streaming-replication-check"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.11. Streaming Replication Check</h2></div></div></div><p>    <span class="productname">Pgpool-II</span> can work with <span class="productname">PostgreSQL</span> native
    Streaming Replication, that is available since <span class="productname">PostgreSQL</span> 9.0.
    To configure <span class="productname">Pgpool-II</span> with streaming
    replication, enable <a class="xref" href="runtime-config-runnung-mode.html#guc-master-slave-mode">master_slave_mode</a> and set
    <a class="xref" href="runtime-config-runnung-mode.html#guc-master-slave-sub-mode">master_slave_sub_mode</a> to <code class="literal">'stream'</code>.
  </p><p>    <span class="productname">Pgpool-II</span> assumes that Streaming Replication
    is configured with Hot Standby on PostgreSQL, which means that the
    standby database can handle read-only queries.
  </p><div class="variablelist"><dl class="variablelist"><dt id="guc-sr-check-period"><span class="term"><code class="varname">sr_check_period</code> (<code class="type">integer</code>)
        <a id="idp57396816" class="indexterm"></a>
      </span></dt><dd><p>          Specifies the time interval in seconds to check the streaming
          replication delay.
          Default is 0, which means the check is disabled.
        </p><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II</span> configurations.
        </p></dd><dt id="guc-sr-check-user"><span class="term"><code class="varname">sr_check_user</code> (<code class="type">string</code>)
        <a id="idp57401392" class="indexterm"></a>
      </span></dt><dd><p>          Specifies the <span class="productname">PostgreSQL</span> user name to perform streaming replication check.
          The user must exist on all the <span class="productname">PostgreSQL</span> backends.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>            <code class="varname">sr_check_user</code>&gt; and <a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-password">sr_check_password</a>
            are used even when <a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-period">sr_check_period</a> is set to 0 (disabled)
            for the identification of the primary server.
          </p></div><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II</span> configurations.
        </p></dd><dt id="guc-sr-check-password"><span class="term"><code class="varname">sr_check_password</code> (<code class="type">string</code>)
        <a id="idp57409744" class="indexterm"></a>
      </span></dt><dd><p>          Specifies the password of the <a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-user">sr_check_user</a> <span class="productname">PostgreSQL</span> user
          to perform the streaming replication checks.
          Use <code class="literal">''</code> (empty string) if the user does not requires a password.
        </p><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II</span> configurations.
        </p></dd><dt id="guc-sr-check-database"><span class="term"><code class="varname">sr_check_database</code> (<code class="type">string</code>)
        <a id="idp57416480" class="indexterm"></a>
      </span></dt><dd><p>          Specifies the database to perform streaming replication delay checks.
          The default is <code class="literal">"postgres"</code>.
        </p><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II</span> configurations.
        </p></dd><dt id="guc-delay-threshold"><span class="term"><code class="varname">delay_threshold</code> (<code class="type">integer</code>)
        <a id="idp57421776" class="indexterm"></a>
      </span></dt><dd><p>          Specifies the maximum tolerance level of replication delay in
          <acronym class="acronym">WAL</acronym> bytes on the standby server against the
          primary server. If the delay exceeds this configured level,
          <span class="productname">Pgpool-II</span> stops sending the <acronym class="acronym">          SELECT</acronym> queries to the standby server and starts routing
          everything to the primary server even if <a class="xref" href="runtime-config-load-balancing.html#guc-load-balance-mode">load_balance_mode</a>
          is enabled, until the standby catches-up with the primary.
          Setting this parameter to 0 disables the delay checking.
          This delay threshold check is performed every <a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-period">sr_check_period</a>.
          Default is 0.
        </p><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II conf</span>igurations.
        </p></dd><dt id="guc-log-standby-delay"><span class="term"><code class="varname">log_standby_delay</code> (<code class="type">string</code>)
        <a id="idp57429664" class="indexterm"></a>
      </span></dt><dd><p>          Specifies when to log the replication delay. Below table contains the list
          of all valid values for the parameter.
        </p><div class="table" id="log-standby-delay-table"><p class="title"><strong>Table 5.9. Log standby delay options</strong></p><div class="table-contents"><table summary="Log standby delay options" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">'none'</code></td><td>Never log the standby delay</td></tr><tr><td><code class="literal">'always'</code></td><td>Log the standby delay, every time the replication delay is checked</td></tr><tr><td><code class="literal">'if_over_threshold'</code></td><td>Only log the standby delay, when it exceeds <a class="xref" href="runtime-streaming-replication-check.html#guc-delay-threshold">delay_threshold</a> value</td></tr></tbody></table></div></div><br class="table-break" /><p>          This parameter can be changed by reloading the <span class="productname">Pgpool-II</span> configurations.
        </p></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-online-recovery.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-in-memory-query-cache.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5.10. Online Recovery </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5.12. In Memory Query Cache</td></tr></table></div></body></html>