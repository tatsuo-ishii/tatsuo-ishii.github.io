<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.1. The pool_hba.conf File</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="pgpool-II 3.6.0 Documentation" /><link rel="up" href="client-authentication.html" title="Chapter 6. Client Authentication" /><link rel="prev" href="client-authentication.html" title="Chapter 6. Client Authentication" /><link rel="next" href="auth-methods.html" title="6.2. Authentication Methods" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.1. The <code class="filename">pool_hba.conf</code> File</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="client-authentication.html">Prev</a> </td><th width="60%" align="center">Chapter 6. Client Authentication</th><td width="20%" align="right"> <a accesskey="n" href="auth-methods.html">Next</a></td></tr></table><hr /></div><div class="sect1" id="auth-pool-hba-conf"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.1. The <code class="filename">pool_hba.conf</code> File</h2></div></div></div><a id="idp58002512" class="indexterm"></a><p>  Just like the <code class="filename">pg_hba.conf</code> file for <span class="productname">PostgreSQL</span>,
  <span class="productname">Pgpool-II</span> supports a similar client authentication
  function using a configuration file called <code class="filename">pool_hba.conf</code>.
  <span class="productname">Pgpool-II</span> installation also includes the sample
  <code class="filename">pool_hba.conf.sample</code> file in the default configuration directory
  (<code class="literal">"/usr/local/etc"</code>).
  By default, pool_hba authentication is disabled, and setting <code class="varname">enable_pool_hba</code>
  to <code class="literal">on</code> enables it. see the <a class="xref" href="runtime-config-connection.html#guc-enable-pool-hba">enable_pool_hba</a> configuration parameter.
  </p><p>   The format of the <code class="filename">pool_hba.conf</code> file follows very closely <span class="productname">PostgreSQL</span>'s <code class="filename">pg_hba.conf</code> format.

   The general format of the <code class="filename">pool_hba.conf</code> file is
   a set of records, one per line. Blank lines are ignored, as is any
   text after the <code class="literal">#</code> comment character.
   Records cannot be continued across lines.
   A record is made
   up of a number of fields which are separated by spaces and/or tabs.
   Fields can contain white space if the field value is double-quoted.
   Quoting one of the keywords in a database, user, or address field (e.g.,
   <code class="literal">all</code> or <code class="literal">replication</code>) makes the word lose its special
   meaning, and just match a database, user, or host with that name.
  </p><p>   Each record specifies a connection type, a client IP address range
   (if relevant for the connection type), a database name, a user name,
   and the authentication method to be used for connections matching
   these parameters. The first record with a matching connection type,
   client address, requested database, and user name is used to perform
   authentication. There is no <span class="quote">“<span class="quote">fall-through</span>”</span> or
   <span class="quote">“<span class="quote">backup</span>”</span>: if one record is chosen and the authentication
   fails, subsequent records are not considered. If no record matches,
   access is denied.
  </p><p>   A record can have one of the following formats
</p><pre class="synopsis">local      <em class="replaceable"><code>database</code></em>  <em class="replaceable"><code>user</code></em>  <em class="replaceable"><code>auth-method</code></em>  [<span class="optional"><em class="replaceable"><code>auth-options</code></em></span>]
host       <em class="replaceable"><code>database</code></em>  <em class="replaceable"><code>user</code></em>  <em class="replaceable"><code>CIDR-address</code></em>  <em class="replaceable"><code>auth-method</code></em>  [<span class="optional"><em class="replaceable"><code>auth-options</code></em></span>]</pre><p>
   The meaning of the fields is as follows:

   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">local</code></span></dt><dd><p>       This record matches connection attempts using Unix-domain
       sockets.  Without a record of this type, Unix-domain socket
       connections are disallowed.
      </p></dd><dt><span class="term"><code class="literal">host</code></span></dt><dd><p>       This record matches connection attempts made using TCP/IP.
       <code class="literal">host</code> records match either
       <acronym class="acronym">SSL</acronym> or non-<acronym class="acronym">SSL</acronym> connection
       attempts.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>       Remote TCP/IP connections will not be possible unless
       the server is started with an appropriate value for the
       <a class="xref" href="runtime-config-connection.html#guc-listen-addresses">listen_addresses</a> configuration parameter,
       since the default behavior is to listen for TCP/IP connections
       only on the local loopback address <code class="literal">localhost</code>.
      </p></div></dd><dt><span class="term"><em class="replaceable"><code>database</code></em></span></dt><dd><p>       Specifies which database name(s) this record matches.  The value
       <code class="literal">all</code> specifies that it matches all databases.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>       <code class="literal">"samegroup"</code> for database field is not supported:
       </p><p>        Since <span class="productname">Pgpool-II</span> does not know anything about
        users in the <span class="productname">PostgreSQL</span> backend server, the database name is simply
        compared against the entries in the databaseE field of <code class="filename">pool_hba.conf</code>.
       </p></div><p>
      </p></dd><dt><span class="term"><em class="replaceable"><code>user</code></em></span></dt><dd><p>       Specifies which database user name(s) this record
       matches. The value <code class="literal">all</code> specifies that it
       matches all users.  Otherwise, this is the name of a specific
       database user
       </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>       group names following <code class="literal">"+"</code> for user field is not supported:
       </p><p>       This is for the same reason as for the <code class="literal">"samegroup"</code> of database field.
       A user name is simply checked against the entries in the user field of
       <code class="filename">pool_hba.conf</code>.
       </p></div><p>
      </p></dd><dt><span class="term"><em class="replaceable"><code>address</code></em></span></dt><dd><p>       Specifies the client machine address(es) that this record matches.
       An IP address range is specified using standard numeric notation
       for the range's starting address, then a slash (<code class="literal">/</code>)
       and a <acronym class="acronym">CIDR</acronym> mask length.  The mask
       length indicates the number of high-order bits of the client
       IP address that must match.  Bits to the right of this should
       be zero in the given IP address.
       There must not be any white space between the IP address, the
       <code class="literal">/</code>, and the CIDR mask length.

       </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>       Pv6 IP address/mask is currently not supported
       </p></div><p>
      </p><p>       This field only applies to <code class="literal">host</code> records.
      </p></dd><dt><span class="term"><em class="replaceable"><code>auth-method</code></em></span></dt><dd><p>       Specifies the authentication method to use when a connection matches
       this record. The possible choices are summarized here; details
       are in <a class="xref" href="auth-methods.html" title="6.2. Authentication Methods">Section 6.2, “Authentication Methods”</a>.

       </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">trust</code></span></dt><dd><p>          Allow the connection unconditionally. This method
          allows anyone that can connect to the
          <span class="productname">Pgpool-II</span>.
         </p></dd><dt><span class="term"><code class="literal">reject</code></span></dt><dd><p>          Reject the connection unconditionally. This is useful for
          <span class="quote">“<span class="quote">filtering out</span>”</span> certain hosts, for example a
          <code class="literal">reject</code> line could block a specific host from connecting.
         </p></dd><dt><span class="term"><code class="literal">md5</code></span></dt><dd><p>          Require the client to supply a double-MD5-hashed password for
          authentication.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>         To use <code class="literal">md5</code> authentication, you need to register
         the user name and password in <code class="filename">"pool_passwd"</code>.
         See <a class="xref" href="auth-methods.html#auth-md5" title="6.2.2. MD5 Password Authentication">Section 6.2.2, “MD5 Password Authentication”</a> for more details.
         </p></div><p>
         </p></dd><dt><span class="term"><code class="literal">pam</code></span></dt><dd><p>          Authenticate using the Pluggable Authentication Modules
          (PAM) service provided by the operating system.
          See <a class="xref" href="auth-methods.html#auth-pam" title="6.2.3. PAM Authentication">Section 6.2.3, “PAM Authentication”</a> for details.
         </p><p>         PAM authentication is supported using user information on the host
         where <span class="productname">Pgpool-II</span> is running.
         To enable PAM support the <span class="productname">Pgpool-II</span>
         must be configured with <code class="command">"--with-pam"</code>
         </p><p>         To enable PAM authentication, you must create a service-configuration file
         for <span class="productname">Pgpool-II</span> in the system's PAM configuration
         directory (that is usually located at <code class="literal">"/etc/pam.d"</code>).
         A sample service-configuration file is also installed as <code class="literal">"share/pgpool.pam"</code>
         under the install directory.
         </p></dd></dl></div><p>

      </p></dd><dt><span class="term"><em class="replaceable"><code>auth-options</code></em></span></dt><dd><p>       After the <em class="replaceable"><code>auth-method</code></em> field, there can be field(s) of
       the form <em class="replaceable"><code>name</code></em><code class="literal">=</code><em class="replaceable"><code>value</code></em> that
       specify options for the authentication method.
      </p></dd></dl></div><p>
  </p><p>   Since the <code class="filename">pool_hba.conf</code> records are examined
   sequentially for each connection attempt, the order of the records is
   significant. Typically, earlier records will have tight connection
   match parameters and weaker authentication methods, while later
   records will have looser match parameters and stronger authentication
   methods. For example, one might wish to use <code class="literal">trust</code>
   authentication for local TCP/IP connections but require a password for
   remote TCP/IP connections. In this case a record specifying
   <code class="literal">trust</code> authentication for connections from 127.0.0.1 would
   appear before a record specifying password authentication for a wider
   range of allowed client IP addresses.
  </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>        All pool_hba authentication options described in this section are
        about the authentication taking place between a client and the
        <span class="productname">Pgpool-II</span>.
        A client still has to go through the <span class="productname">PostgreSQL</span>'s authentication
        process and must have the <code class="literal">CONNECT</code> privilege for the
        database on the backend <span class="productname">PostgreSQL</span> server.
    </p><p>        As far as pool_hba is concerned, it does not matter if a user name
        and/or database name given by a client
        (i.e. <code class="command">psql -U testuser testdb</code>)
        really exists in the backend. pool_hba only cares if a match in the
        <code class="filename">pool_hba.conf</code> can be found or not.
    </p></div><p>   Some examples of <code class="filename">pool_hba.conf</code> entries.
   See the next section for details on the different authentication methods.
  </p><div class="example" id="example-pg-hba.conf"><p class="title"><strong>Example 6.1. Example <code class="filename">pool_hba.conf</code> Entries</strong></p><div class="example-contents"><pre class="programlisting"># Allow any user on the local system to connect to any database with
# any database user name using Unix-domain sockets (the default for local
# connections).
#
# TYPE  DATABASE        USER            ADDRESS                 METHOD
local   all             all                                     trust

# The same using local loopback TCP/IP connections.
#
# TYPE  DATABASE        USER            ADDRESS                 METHOD
host    all             all             127.0.0.1/32            trust

# Allow any user from host 192.168.12.10 to connect to database
# "postgres" if the user's password is correctly supplied.
#
# TYPE  DATABASE        USER            ADDRESS                 METHOD
host    postgres        all             192.168.12.10/32        md5</pre></div></div><br class="example-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="client-authentication.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="client-authentication.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="auth-methods.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. Client Authentication </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6.2. Authentication Methods</td></tr></table></div></body></html>