<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>A.9. Release 3.5.7</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="pgpool-II 3.7devel Documentation" /><link rel="up" href="release.html" title="Appendix A. Release Notes" /><link rel="prev" href="release-3-5-8.html" title="A.8. Release 3.5.8" /><link rel="next" href="release-3-5-6.html" title="A.10. Release 3.5.6" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.9. Release 3.5.7</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="release-3-5-8.html">Prev</a> </td><th width="60%" align="center">Appendix A. Release Notes</th><td width="20%" align="right"> <a accesskey="n" href="release-3-5-6.html">Next</a></td></tr></table><hr /></div><div class="sect1" id="release-3-5-7"><div class="titlepage"><div><div><h2 class="title" style="clear: both">A.9. Release 3.5.7</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Release Date</h3><p>2017-04-28</p></div><div class="sect2" id="idp46593922161056"><div class="titlepage"><div><div><h3 class="title">A.9.1. Bug fixes</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>    Fixing a mistake in the watchdog code. (Muhammad Usama)
    </p><p>    commit also adds some debug messages in the watchdog code.
    </p></li><li class="listitem"><p>     Fix for 0000299: Errors on the reloading of configuration.
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=299" target="_top">(Bug 299)</a> (Muhammad Usama)
    </p></li><li class="listitem"><p>    Fix for 0000289: Inconsistent backend state.
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=289" target="_top">(Bug 289)</a> (Muhammad Usama)
    </p></li><li class="listitem"><p>    Enhancing the handling of split-brain scenario by the watchdog. (Muhammad Usama)
    </p><p>    Previously, the watchdog cluster was used to call for re-election of the
    master/coordinator node whenever the split-brain situation was detected. And
    consequently every node was required to rejoin the watchdog network, Which was
    essentially similar to the re-booting of the whole watchdog cluster.
    </p><p>    The candidate for the master/coordinator node is selected on the following criteria.

    </p><p>    1-- When two watchdog nodes are claiming to be the cluster master, the master
    node that has performed the escalation keeps the master status and the other
    node is asked to step down.
    </p><p>
    2-- If the conflict could not be resolved by the escalation status of the nodes,
    The node which holds the quorum remains the master/coordinator.
    </p><p>
    3-- If the quorum status of both contenders is also same. The node with higher
    number of connected alive nodes get the preference.
    </p><p>
    4-- Finally, if all above three yields no winner, the older master (The node
    that has the coordinator status for longer duration) remains the master.
    </p></li><li class="listitem"><p>    Enhancing the watchdog internal command mechanism to handle multiple concurrent commands. (Muhammad Usama)
    </p></li><li class="listitem"><p>    Add bool encode and decode functions to JSON framework for code compatibility.(Muhammad Usama)
    </p></li><li class="listitem"><p>    Comment out unsupported Java method in new JDBC drivers to prevent regression failure. (Tatsuo Ishii)
    </p></li><li class="listitem"><p>    Downgrade parse before bind log message to debug1. (Tatsuo Ishii)
    </p></li><li class="listitem"><p>     Fix coverity warnings. (Tatsuo Ishii, Muhammad Usama)
    </p></li><li class="listitem"><p>    Fix for <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-general/2017-March/005454.html" target="_top">[pgpool-general: 5396]</a> pam ldap failure. (Muhammad Usama)
    </p></li><li class="listitem"><p>    Consider SHOW command as kind of a read query. (Tatsuo Ishii)
    </p><p>    In streaming replication mode, if SHOW is issued then subsequent
    SELECTs are sent to the primary node in an explicit transaction. This
    is not a reasonable and unnecessary limitation.

    Also fix hang when parse command returns error.
    </p></li><li class="listitem"><p>    Fix memory leak problem caused by commit adcb636. (Tatsuo Ishii)
    </p><p>    Commit adcb636 introduces "pending message queue". When a message
    arrives, the info is added to the queue and a copy of object is
    created at the same time, but forgot to free the object. Fix is,
    creating a new function pool_pending_message_free_pending_message()
    and call it after pool_pending_message_add(),
    pool_pending_message_get() and pool_pending_message_pull_out().

    Problem reported by Sergey Kim.
    </p></li><li class="listitem"><p>    Mega patch to fix "kind mismatch" (or derived) errors in streaming replication mode.
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=271" target="_top">(Bug 271)</a> (Tatsuo Ishii)
    </p><p>    The errors are caused by wrong prediction in which (or both) database
    node will send response to Pgpool-II. Previous implementation using
    "sync map" are weak and sometimes fail in the prediction.

    </p><p>    This patch introduces new implementation using "pending message
    queue", which records all sent message to backends. The element of the
    queue stores info regarding messages types
    (parse/bind/execute/describe/close/sync), to which database node the
    message was sent and so on. It's a simple FIFO queue. When a message
    arrives from backend, by looking at the head of the "pending message
    queue", it is possible to reliably predict what kind of message and
    from which database node it will arrive. After receiving the message,
    the element is removed from the queue.
    </p><p>
    I would like to thank to Sergey Kim, who has been helping me in
    testing series of patches.

    </p><p>    See <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=271" target="_top">Bug 271</a>
    and discussion in pgpool-hackers mailing list
    <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-hackers/2017-February/002043.html" target="_top">[pgpool-hackers: 2043]</a> and
    <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-hackers/2017-March/002140.html" target="_top">[pgpool-hackers: 2140]</a>
     for more details.

    </p></li><li class="listitem"><p>    Fix for 0000296: PGPool v3.6.2 terminated by systemd because the service Type has been set to 'forking'.
    <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=296" target="_top">(Bug 296)</a> (Muhammad Usama)
    </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-3-5-8.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-3-5-6.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">A.8. Release 3.5.8 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> A.10. Release 3.5.6</td></tr></table></div></body></html>