<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>A.3. リリース 3.6.3</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Pgpool-II 3.7devel 文書" /><link rel="up" href="release.html" title="付録A リリースノート" /><link rel="prev" href="release-3-6-4.html" title="A.2. リリース 3.6.4" /><link rel="next" href="release-3-6-2.html" title="A.4. リリース 3.6.2" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.7devel 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="release-3-6-4.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="release.html">上へ</a></td><td width="60%" align="center">A.3. リリース 3.6.3</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="release-3-6-2.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="release-3-6-3"><div class="titlepage"><div><div><h2 class="title" style="clear: both">A.3. リリース 3.6.3</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">リリース日</h3><p>2017-04-28</p></div><div class="sect2" id="idm45863244599872"><div class="titlepage"><div><div><h3 class="title">A.3.1. 不具合修正</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>     memcachedが使用されているときに発生する"show pool_cache"のセグメンテーション違反を修正しました。
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=301" target="_top">(Bug 301)</a> (Tatsuo Ishii)
    </p></li><li class="listitem"><p>     いくつかのソースコードの警告を修正しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>        いくつかのコンパイラの警告を修正しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     pool_config_vatiable.cから「定義されたが未使用の関数」という警告を削除しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     古いdebug_level設定パラメーターの参照を削除しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     Watchdogのソースコードのミスを修正し、いくつかのdebugメッセージを追加しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     pool_hba.confファイルをリロード時に発生するエラーを修正しました。<a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=299" target="_top">(Bug 299)</a> (Muhammad Usama)
    </p></li><li class="listitem"><p>     英語/日本語のドキュメントにpgpool_adm extensionに関する情報を追加しました。(Tatsuo Ishii)
    </p></li><li class="listitem"><p>     ドキュメントを改善しました。(Tatsuo Ishii)
    </p></li><li class="listitem"><p>     watchdog 使用時に Pgpool-II 間でバックエンドの状態が一致しない不具合を修正しました。
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=289" target="_top">(Bug 289)</a> (Muhammad Usama)
    </p></li><li class="listitem"><p>     Watchdogによるスプリットブレインシナリオの処理を強化しました。(Muhammad Usama)
    </p><p>
     watchdogクラスタを使用しmaster/coordinatorノードの再選出が呼び出されていました。その結果、すべてのノードがウォッチドッグネットワークに再結合する必要がありました。これはwatchdogクラスタ全体の再起動と本質的に同じでした。
    </p><p>     今回の修正では、master/coordinatorノードの候補は、次の基準で選択されるようになりました。
    </p><p>    (1) 2つのウォッチドッグノードがクラスタマスターであると主張している場合、エスカレーションを実行したマスターノードはマスター状態を保持し、他のノードはステップダウンするように要求されます。
    </p><p>    (2) 競合がノードのエスカレーション状況によって解決できない場合、クォーラムを保持するノードはマスター/コーディネータのままです。
    </p><p>    (3) 両方の候補のクォーラムステータスが同じ場合、接続されたアライブノードの数が多いノードが優先されます。
    </p><p>    (4) 最後に、上記3つでマスターノードを選出できなかった場合、古いマスター(長期間コーディネーターステータスを持つノード) はマスターのままです。
    </p></li><li class="listitem"><p>     複数の並行コマンドを処理するためにwatchdog内部コマンドのメカニズムを強化しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     コンパイラ時の警告を修正しました。(Tatsuo Ishii)
    </p></li><li class="listitem"><p>     リグレッションの失敗を防ぐために、サポートされていないJavaメソッドを新しいJDBCドライバでコメントアウトしました。(Tatsu Ishii)
    </p></li><li class="listitem"><p>     <code class="function">parse_before_bind() </code> のログメッセージを debug1 にダウングレードしました。(Tatsuo Ishii)
    </p></li><li class="listitem"><p>     coverity警告を修正しました。(Muhammad Usama, Tatsuo Ishii)
    </p></li><li class="listitem"><p>     <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-general/2017-March/005454.html" target="_top">[pgpool-general: 5396]</a>
        pam ldapが失敗する不具合を修正しました。(Muhammad Usama)
    </p></li><li class="listitem"><p>     拡張クエリモードでSQL型コマンドが使用できないことをドキュメントに追加しました。(Tatsuo Ishii)
    </p></li><li class="listitem"><p>     <code class="command">SHOW</code>コマンドを読み込みクエリの一つとして認識するようにしました。(Tatsuo Ishii)
    </p><p>     ストリーミングレプリケーションモードでは、<code class="command">SHOW</code>が発行されるとその後のSELECTは明示的なトランザクションでプライマリノードに送信されていました。この制限は不適切でした。また、parseコマンドがエラーを返すときに発生するハングアップを修正しました。
    </p></li><li class="listitem"><p>     コミットadcb636によって引き起こされたメモリリークの問題を修正しました。(Tatsuo Ishii)
    </p><p>     Commit adcb636では"pending message queue"を導入しました。メッセージを受信すると、情報がキューに追加され、オブジェクトのコピーが同時に作成されますが、オブジェクトを解放するのを忘れてしまいました。
     </p><p>     今回の修正では、新しい関数<code class="function">pool_pending_message_free_pending_message()</code>を作成し、<code class="function">pool_pending_message_add()</code>、<code class="function">pool_pending_message_get()</code>および<code class="function">pool_pending_message_pull_out()</code>の後に呼び出すように修正しました。
    </p></li><li class="listitem"><p>     ストリーミングレプリケーションモードで「kind mismatch」(またはそれに関連する)エラーが修正されました。
     <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=271" target="_top">(Bug 271)</a> (Tatsuo Ishii)
    </p><p>     このエラー原因はデータベースノードがPgpool-IIに送る応答の予測が誤っていたことです。以前使用した「sync map」の実装は弱く、予測に失敗することがありました。今回の修正では、送信されたすべてのメッセージをバックエンドに記録する"pending message queue"を導入しました。このキューの要素には、メッセージのタイプ(parse/bind/execute/describe/close/sync)、メッセージが送信されたデータベースノードの情報などが格納されます。これは単純なFIFOキューです。バックエンドからメッセージが到着すると、"pending message queue"の先頭を見れば、受信したメッセージの種類やデータベースノードを確実に予測できます。 メッセージを受信した後、この要素はキューから削除されます。
    </p><p>    一連のパッチをテストしてくれたSergey Kimさんに感謝します。
    </p><p>    詳細は <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=271" target="_top">Bug 271</a>、
    <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-hackers/2017-February/002043.html" target="_top">[pgpool-hackers: 2043]</a> と
    <a class="ulink" href="http://www.sraoss.jp/pipermail/pgpool-hackers/2017-March/002140.html" target="_top">[pgpool-hackers: 2140]</a> をご参照下さい。
    </p></li><li class="listitem"><p>    [Service] が Type=forking に設定されている場合、Pgpool-II 3.6.2 が systemd によって強制終了されていた不具合を修正しました。
    <a class="ulink" href="http://www.pgpool.net/mantisbt/view.php?id=296" target="_top">(Bug 296)</a> (Muhammad Usama)
    </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-3-6-4.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="release-3-6-2.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">A.2. リリース 3.6.4 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> A.4. リリース 3.6.2</td></tr></table></div></body></html>