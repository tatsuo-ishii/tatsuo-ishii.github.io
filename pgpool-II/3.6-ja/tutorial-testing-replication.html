<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>1.4. レプリケーションを試してみる</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Pgpool-II 3.6.0 文書" /><link rel="up" href="tutorial-start.html" title="第1章 さあ始めましょう" /><link rel="prev" href="tutorial-testing-load-balance.html" title="1.3. 負荷分散を試してみる" /><link rel="next" href="tutorial-testing-failover.html" title="1.5. フェイルオーバを試してみる" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.6.0 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="tutorial-testing-load-balance.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="tutorial-start.html">上へ</a></td><td width="60%" align="center">1.4. レプリケーションを試してみる</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="tutorial-testing-failover.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="tutorial-testing-replication"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.4. レプリケーションを試してみる</h2></div></div></div><p><span class="productname">PostgreSQL</span>に同梱されているベンチマークツールの<code class="command">pgbench</code>を使って、レプリケーション機能を試してみましょう。
      </p><pre class="programlisting">$ pgbench -i -p 11000 test
      </pre><p>
レプリケーションが正しく動いているかどうか確かめるために、直接プライマリとスタンバイサーバに接続して、両方が同じ結果を返すかどうか見てみます。
      </p><pre class="programlisting">$ psql -p 11002 test
\dt
              List of relations
 Schema |       Name       | Type  |  Owner  
--------+------------------+-------+---------
 public | pgbench_accounts | table | t-ishii
 public | pgbench_branches | table | t-ishii
 public | pgbench_history  | table | t-ishii
 public | pgbench_tellers  | table | t-ishii
(4 rows)
\q
$ psql -p 11003 test
\dt
              List of relations
 Schema |       Name       | Type  |  Owner  
--------+------------------+-------+---------
 public | pgbench_accounts | table | t-ishii
 public | pgbench_branches | table | t-ishii
 public | pgbench_history  | table | t-ishii
 public | pgbench_tellers  | table | t-ishii
(4 rows)
      </pre><p>
プライマリサーバ（ポート11002）とスタンバイサーバ（ポート11003）は、同一の結果を返しています。
次に、pgbenchをしばらく走らせて、結果を見てみます。
      </p><pre class="programlisting">$ pgbench -p 11000 -T 10 test
starting vacuum...end.
transaction type: &lt;builtin: TPC-B (sort of)&gt;
scaling factor: 1
query mode: simple
number of clients: 1
number of threads: 1
duration: 10 s
number of transactions actually processed: 2171
latency average = 4.692 ms
tps = 213.147520 (including connections establishing)
tps = 213.258008 (excluding connections establishing)

$ psql -p 11002 -c "SELECT sum(abalance) FROM pgbench_accounts" test
  sum   
--------
 192112
(1 row)

$ psql -p 11003 -c "SELECT sum(abalance) FROM pgbench_accounts" test
  sum   
--------
 192112
(1 row)
      </pre><p>
ここでも結果は同じでした。
    </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tutorial-testing-load-balance.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="tutorial-start.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="tutorial-testing-failover.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">1.3. 負荷分散を試してみる </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 1.5. フェイルオーバを試してみる</td></tr></table></div></body></html>