<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.4. バックエンドの設定</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Pgpool-II 3.7devel 文書" /><link rel="up" href="runtime-config.html" title="第5章 サーバの設定" /><link rel="prev" href="runtime-config-runnung-mode.html" title="5.3. 動作モード" /><link rel="next" href="runtime-config-connection-pooling.html" title="5.5. コネクションプーリング" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.7devel 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="runtime-config-runnung-mode.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="60%" align="center">5.4. バックエンドの設定</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="runtime-config-connection-pooling.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="runtime-config-backend-settings"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.4. バックエンドの設定</h2></div></div></div><div class="sect2" id="runtime-config-backend-connection-settings"><div class="titlepage"><div><div><h3 class="title">5.4.1. バックエンド接続の設定</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-backend-hostname"><span class="term"><code class="varname">backend_hostname</code> (<code class="type">string</code>)
		<a id="idm45863246966128" class="indexterm"></a>
	</span></dt><dd><p><code class="varname">backend_hostname</code>には接続先の<span class="productname">PostgreSQL</span>バックエンドを指定します。
<span class="productname">Pgpool-II</span>がサーバと通信するのに使われます。
		</p><p>TCP/IP通信では、このパラメータはホスト名またはIPアドレスをとることができます。
スラッシュ（<code class="literal">/</code>）で始まる場合、TCP/IPではなくUNIXドメインでの通信が使用され、値はソケットファイルが作成されるディレクトリ名となります。
となしてそこにソケットファイルが作成されることになります。
<code class="varname">backend_hostname</code>に空文字(<code class="literal">''</code>)が指定された場合のデフォルトの動作は、<code class="filename">/tmp</code>に作成したUNIXドメインソケットで接続します。
		</p><p>パラメータ名の末尾に数字を付加することで複数のバックエンドを指定することができます(たとえばbackend_hostname0)。
この数字のことを「DBノードID」と呼び、0から開始します。
DBノードIDが0のバックエンドは「マスターノード」と呼ばれます。
複数のDBノードを定義している場合、条件によってはマスターノードがダウンしても運用を続けることができます（いくつかのモードを除きます）。
この場合は、稼働中かつDBノードIDがもっとも若いものが新しいマスターノードになります。
		</p><p>ストリーミングレプリケーションモードで運用している場合は、DBノードIDが0のノードには特別な意味はないことに注意して下さい。
むしろ、そのDBノードが「プライマリノード」かどうかを気にするべきです。
詳細は<a class="xref" href="runtime-config-load-balancing.html" title="5.7. 負荷分散">5.7. 負荷分散</a>、 <a class="xref" href="runtime-config-failover.html" title="5.9. フェイルオーバとフェイルバック">5.9. フェイルオーバとフェイルバック</a>、<a class="xref" href="runtime-streaming-replication-check.html" title="5.11. ストリーミングレプリケーションのチェック">5.11. ストリーミングレプリケーションのチェック</a>をご覧ください。
		</p><p>1台しか<span class="productname">PostgreSQL</span>を使用しない場合は、backend_hostname0で指定してください。
		</p><p>新しいノードはパラメータ行を追加して、設定ファイル再読み込みすることで追加できます。
ただし、既存の値を変更することはできないので、その場合には<span class="productname">Pgpool-II</span>を再起動してください。
		</p></dd><dt id="guc-backend-port"><span class="term"><code class="varname">backend_port</code> (<code class="type">integer</code>)
		<a id="idm45863246952832" class="indexterm"></a>
	</span></dt><dd><p><code class="varname">backend_port</code>にはバックエンドのポート番号を指定します。
パラメータ名の末尾に数字を付加することで複数のバックエンドを指定することができます(たとえばbackend_port0)。
1台しか<span class="productname">PostgreSQL</span>を使用しない場合は、backend_port0で指定してください。
		</p><p>新しいノードはパラメータ行を追加して、設定ファイル再読み込みすることで追加できます。
ただし、既存の値を変更することはできないので、その場合には<span class="productname">Pgpool-II</span>を再起動してください。
		</p></dd><dt id="guc-backend-weight"><span class="term"><code class="varname">backend_weight</code> (<code class="type">floating point</code>)
		<a id="idm45863246947616" class="indexterm"></a>
	</span></dt><dd><p><code class="varname">backend_weight</code>にはバックエンドの負荷分散の比率を指定します。
0以上の整数または浮動小数点を指定できます。
パラメータ名の末尾に数字を付加することで複数のバックエンドを指定することができます(たとえばbackend_weight0)。
1台しか<span class="productname">PostgreSQL</span>を使用しない場合は、backend_weight0で指定してください。
		</p><p>新しい<code class="varname">backend_weight</code>はパラメータ行を追加して、設定ファイル再読み込みすることで追加できます。
backend_weight は新しく追加した行を設定ファイル再読み込みで追加することができます。
<span class="productname">Pgpool-II</span> <span class="emphasis"><em>V2.2.6</em></span>、<span class="emphasis"><em>V2.3</em></span>以降では、設定ファイルの再読込みで値を変更できます。
ただし、この効果が反映されるのは新しく確立されたクライアントセッションからです。
マスタースレーブモードにおいて、スレーブに対して管理業務を実施する都合上、問い合わせがそのスレーブに送られるのを防ぎたい場合に有用です。
		</p></dd></dl></div></div><div class="sect2" id="runtime-config-backend-data"><div class="titlepage"><div><div><h3 class="title">5.4.2. バックエンドデータの設定</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-backend-data-directory"><span class="term"><code class="varname">backend_data_directory</code> (<code class="type">string</code>)
		<a id="idm45863246939568" class="indexterm"></a>
	</span></dt><dd><p><code class="varname">backend_data_directory</code>にはバックエンドのデータベースクラスタのディレクトリを指定します。
パラメータ名の末尾に数字を付加することで複数のバックエンドを指定することができます(たとえばbackend_data_directory0)。
1台しか<span class="productname">PostgreSQL</span>を使用しない場合は、backend_data_diarectory0で指定してください。
    使用する PostgreSQL サーバのデータベースクラスタのパスを指定します。 実際には、"backend_data_directory"の後にDBノードIDを付加して使用する複数のPostgreSQLを区別します。 このパラメータはオンラインリカバリの際に使用します。 オンラインリカバリを使用しない場合には設定する必要はありません。
		</p><p>新しい<code class="varname">backend_data_directory</code>はパラメータ行を追加して、設定ファイル再読み込みすることで追加できます。
ただし、既存の値を変更することはできないので、その場合には<span class="productname">Pgpool-II</span>を再起動してください。
		</p></dd><dt id="guc-backend-flag"><span class="term"><code class="varname">backend_flag</code> (<code class="type">string</code>)
		<a id="idm45863246933024" class="indexterm"></a>
	</span></dt><dd><p><code class="varname">backend_flag</code>はバックエンド単位での様々な挙動を制御するフラグです。
パラメータ名の末尾に数字を付加することで複数のバックエンドを指定することができます(たとえばbackend_flag0)。
1台しか<span class="productname">PostgreSQL</span>を使用しない場合は、backend_flag0で指定してください。
		</p><p>新しいバックエンドフラグはパラメータ行を追加して、設定ファイル再読み込みすることで追加できます。
現在以下のものがあります。
複数のフラグを"|"で連結して指定することができます。
		</p><div class="table" id="backend-flag-table"><p class="title"><strong>表5.3 バックエンドフラグ</strong></p><div class="table-contents"><table class="table" summary="バックエンドフラグ" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>フラグ</th><th>説明</th></tr></thead><tbody><tr><td><code class="literal">ALLOW_TO_FAILOVER</code></td><td>フェイルオーバやデタッチが可能になります。
			これがデフォルトの動作です。
			DISALLOW_TO_FAILOVERと同時には指定できません。
			</td></tr><tr><td><code class="literal">DISALLOW_TO_FAILOVER</code></td><td>フェイルオーバやデタッチを禁止します。
			<span class="productname">Heartbeat</span>や<span class="productname">Pacemaker</span>などのHA(High Availability)ソフトでバックエンドを保護しているなどの場合に有用です。
			ALLOW_TO_FAILOVERと同時には指定できません。
			</td></tr></tbody></table></div></div><br class="table-break" /><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
		</p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-runnung-mode.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-connection-pooling.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">5.3. 動作モード </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 5.5. コネクションプーリング</td></tr></table></div></body></html>