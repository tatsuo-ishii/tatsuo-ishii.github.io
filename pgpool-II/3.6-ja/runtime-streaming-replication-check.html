<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.11. ストリーミングレプリケーションのチェック</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Pgpool-II 3.7devel 文書" /><link rel="up" href="runtime-config.html" title="第5章 サーバの設定" /><link rel="prev" href="runtime-online-recovery.html" title="5.10. オンラインリカバリ" /><link rel="next" href="runtime-in-memory-query-cache.html" title="5.12. インメモリキャッシュ" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.7devel 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="runtime-online-recovery.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="60%" align="center">5.11. ストリーミングレプリケーションのチェック</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="runtime-in-memory-query-cache.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="runtime-streaming-replication-check"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.11. ストリーミングレプリケーションのチェック</h2></div></div></div><p><span class="productname">Pgpool-II</span>は<span class="productname">PostgreSQL</span> 9.0から利用可能になった<span class="productname">PostgreSQL</span>組み込みのストリーミングレプリケーション機能と一緒に動作することができます。
ストリーミングレプリケーション向けに<span class="productname">Pgpool-II</span>を設定するには、<a class="xref" href="runtime-config-runnung-mode.html#guc-master-slave-mode">master_slave_mode</a>を有効にして<a class="xref" href="runtime-config-runnung-mode.html#guc-master-slave-sub-mode">master_slave_sub_mode</a>を<code class="literal">'stream'</code>に設定します。
  </p><p><span class="productname">Pgpool-II</span>ではストリーミングレプリケーションととHot Standbyを併用することを前提にしています。
すなわちスタンバイデータベースでは参照クエリのみを扱うことができます。
  </p><div class="variablelist"><dl class="variablelist"><dt id="guc-sr-check-period"><span class="term"><code class="varname">sr_check_period</code> (<code class="type">integer</code>)
        <a id="idm45863246334288" class="indexterm"></a>
      </span></dt><dd><p>ストリーミングレプリケーションの遅延チェックの間隔を秒単位で指定します。
デフォルト値は0で、これはチェックを行わないことを意味します
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-sr-check-user"><span class="term"><code class="varname">sr_check_user</code> (<code class="type">string</code>)
        <a id="idm45863246329632" class="indexterm"></a>
      </span></dt><dd><p>ストリーミングレプリケーションのチェックを行う<span class="productname">PostgreSQL</span>ユーザ名を指定します。
このユーザは、すべてのバックエンドに存在しなければなりません。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><code class="varname">sr_check_user</code>と<a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-password">sr_check_password</a>は、<a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-period">sr_check_period</a>が0（無効）であっても、プライマリサーバの特定に使用されます。
          </p></div><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-sr-check-password"><span class="term"><code class="varname">sr_check_password</code> (<code class="type">string</code>)
        <a id="idm45863246321952" class="indexterm"></a>
      </span></dt><dd><p>ストリーミングレプリケーションのチェックを行う<a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-user">sr_check_user</a> <span class="productname">PostgreSQL</span>ユーザのパスワードをを指定します。
ユーザがパスワードが必要としなければ空文字('')を使用します。
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-sr-check-database"><span class="term"><code class="varname">sr_check_database</code> (<code class="type">string</code>)
        <a id="idm45863246315840" class="indexterm"></a>
      </span></dt><dd><p>ストリーミングレプリケーションの遅延チェックを行うデータベース名を指定します。
デフォルトは「<code class="literal">postgres</code>」です。
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-delay-threshold"><span class="term"><code class="varname">delay_threshold</code> (<code class="type">integer</code>)
        <a id="idm45863246310528" class="indexterm"></a>
      </span></dt><dd><p>プラマリサーバに対するスタンバイサーバのレプリケーション遅延の許容度を<acronym class="acronym">WAL</acronym>バイト単位で指定します。
<span class="productname">Pgpool-II</span>は、スタンバイサーバの遅延がこの設定レベルを超えた場合には、 <a class="xref" href="runtime-config-load-balancing.html#guc-load-balance-mode">load_balance_mode</a>が有効であっても、プライマリに追いつくまでそのスタンバイノードには<acronym class="acronym">SELECT</acronym>クエリを送信せず、全てプライマリサーバに送るようにします。
このパラメータが0の場合は、遅延のチェックを行ないません。
この遅延閾値のチェックは<a class="xref" href="runtime-streaming-replication-check.html#guc-sr-check-period">sr_check_period</a>毎に行われます。
デフォルト値は0です。
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-log-standby-delay"><span class="term"><code class="varname">log_standby_delay</code> (<code class="type">string</code>)
        <a id="idm45863246302576" class="indexterm"></a>
      </span></dt><dd><p>レプリケーションの遅延状況をログ出力する条件を指定します。
以下の表にこのパラメータでとることができる値のリストを示します。
'none'を指定すると、ログを出力しません。 'always'ならレプリケーションの遅延チェックを実行するたびに必ず出力します。 'if_over_threshold'を指定すると、delay_thresholdを超えたときだけ ログが出力されます。 デフォルト値は'none'です。
        </p><div class="table" id="log-standby-delay-table"><p class="title"><strong>表5.9 スタンバイ遅延のログ出力オプション</strong></p><div class="table-contents"><table class="table" summary="スタンバイ遅延のログ出力オプション" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>値</th><th>説明</th></tr></thead><tbody><tr><td><code class="literal">'none'</code></td><td>スタンバイの遅延はログ出力されない</td></tr><tr><td><code class="literal">'always'</code></td><td>レプリケーション遅延がチェックされる度に、スタンバイの遅延がログ出力される</td></tr><tr><td><a class="xref" href="runtime-streaming-replication-check.html#guc-delay-threshold">delay_threshold</a>の値を超えた時だけ、スタンバイの遅延がログ出力される</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break" /><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-online-recovery.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-in-memory-query-cache.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">5.10. オンラインリカバリ </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 5.12. インメモリキャッシュ</td></tr></table></div></body></html>