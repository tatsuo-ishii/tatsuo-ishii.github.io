<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.7. 負荷分散</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Pgpool-II 3.7devel 文書" /><link rel="up" href="runtime-config.html" title="第5章 サーバの設定" /><link rel="prev" href="runtime-config-logging.html" title="5.6. エラー報告とログ取得" /><link rel="next" href="runtime-config-health-check.html" title="5.8. ヘルスチェック" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.7devel 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="runtime-config-logging.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="60%" align="center">5.7. 負荷分散</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="runtime-config-health-check.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="runtime-config-load-balancing"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.7. 負荷分散</h2></div></div></div><p><span class="productname">Pgpool-II</span>のSELECTクエリの負荷分散はマスタースレーブモード（<a class="xref" href="runtime-config-runnung-mode.html#runtime-config-master-slave-mode" title="5.3.1. マスタースレーブモード">5.3.1. マスタースレーブモード</a>）とレプリケーションモード（<a class="xref" href="runtime-config-runnung-mode.html#runtime-config-replication-mode" title="5.3.2. レプリケーションモード">5.3.2. レプリケーションモード</a>）で動作します。
有効時、<span class="productname">Pgpool-II</span>は更新を伴うクエリを、マスタースレーブモードでは<acronym class="acronym">プライマリノード</acronym>に、レプリケーションモードでは全てのバックエンドノードに対し送信します。
そして、その他のクエリは全てのバックエンドの間で負荷分散されます。
負荷分散メカニズムが参照クエリをどのノードに送信するかはセッション開始時に決められ、セッションの終了まで変更されません。
唯一の例外は特別なSQLコマンドが発行されたときです。
詳細については以下をご覧ください。
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>負荷分散ができないためにプリマリノードまたは全バックエンドノードに送られクエリもまた、負荷分散アルゴリズムで判断されます。
    </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>もし負荷分散対象のクエリを<span class="productname">Pgpool-II</span>に負荷分散してほしくない場合には、<acronym class="acronym">SELECT</acronym>文の前の<span class="emphasis"><em>/*NO LOAD BALANCE*/</em></span>コメントを付与することができます。
これにより、そのクエリの負荷分散は無効となり、<span class="productname">Pgpool-II</span>はこれをマスターノード（マスタースレーブモードではプライマリノード）に送信します。
    </p></div><div class="sect2" id="runtime-config-load-balancing-condition"><div class="titlepage"><div><div><h3 class="title">5.7.1. 負荷分散の条件について</h3></div></div></div><p>クエリが負荷分散されるためには、以下の全ての条件を満たす必要があります：
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="productname">PostgreSQL</span>のバージョンが7.4以降である
      </p></li><li class="listitem"><p>レプリケーションモードまたはマスタースレーブモードである
      </p></li><li class="listitem"><p>問い合わせが明示的なトランクザションブロックの内側にない(つまり、BEGINを発行していない)
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>ただし、以下の条件が満たされればトランザクションブロックの内側であっても負荷分散の対象となります。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>トランザクション分離レベルがSERIALIZABLEでない
              </p></li><li class="listitem"><p>トランザクション内で更新を伴うクエリが実行されていない
(更新を伴うクエリが実行されるまでは負荷分散されます。
ここで「更新を伴うクエリ」とは、SELECT以外のDDLやDMLを指します。
black/white function listで指定される更新関数を含むSELECTは更新を伴うクエリとは見なされません。
この仕様は将来変更される可能性があります)
              </p></li><li class="listitem"><p>もしblack/white function listが空の場合は、関数を持つSELECTは、更新を伴うクエリとは見なされません。
              </p></li></ul></div><p>
          </p></li></ul></div></li><li class="listitem"><p>SELECT INTO 文ではない
      </p></li><li class="listitem"><p>SELECT FOR UPDATE/SELECT FOR SHARE文ではない
      </p></li><li class="listitem"><p>SELECT または COPY TO STDOUT, EXPLAIN, EXPLAIN ANALYZE SELECT... から始まる。
(<a class="xref" href="runtime-config-load-balancing.html#guc-black-function-list">black_function_list</a>または<a class="xref" href="runtime-config-load-balancing.html#guc-white-function-list">white_function_list</a>で指定された書き込み関数を含むSELECTを除く)
<a class="xref" href="runtime-config-load-balancing.html#guc-ignore-leading-white-space">ignore_leading_white_space</a> = <code class="literal">true</code>の場合は最初の空白文字は無視されます。
     </p></li><li class="listitem"><p>マスタースレーブモードの場合、更に以下の条件が満たされなければなりません。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>一時テーブルを使っていない
            </p></li><li class="listitem"><p>unloggedテーブルを使っていない
            </p></li><li class="listitem"><p>システムカタログを使っていない
            </p></li></ul></div></li></ul></div><p>
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>SELECTクエリの前に任意のコメントを挿入することにより負荷分散を抑制することができます。
    </p><pre class="programlisting">/*REPLICATION*/ SELECT ...
    </pre><p>SQLコメントの記述が負荷分散に影響を与えないようにするには、<a class="xref" href="runtime-config-load-balancing.html#guc-allow-sql-comments">allow_sql_comments</a>をonにします。
<a class="xref" href="runtime-config-runnung-mode.html#guc-replicate-select">replicate_select</a>も参照してください。
    </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>JDBC ドライバにはautocommitオプションがあります。
autocommit を無効にすると、ドライバが内部でBEGINおよびCOMMITコマンドを実行し、明示的なトランザクションが開始されます。
この場合、トランザクション内における上記の負荷分散の制限事項が適用されます。
    </p></div></div><div class="sect2" id="runtime-config-load-balancing-in-streaming-raplication"><div class="titlepage"><div><div><h3 class="title">5.7.2. ストリーミングレプリケーションにおける負荷分散</h3></div></div></div><p>ストリーミングレプリケーションとHot Standbyを利用している環境では、プライマリノードに送ってよい問い合わせ、スタンバイに送ってもよい問い合わせ、両方に送らなければならない問い合わせを厳密に管理する必要があります。
<span class="productname">Pgpool-II</span>のストリーミングレプリケーションモードは、こうした振り分けを自動的に行ないます。
   </p><p> クエリそのものから、どのクエリがどのノードに送られるべきかを区別します。
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>プライマリノードにしか送られない問い合わせ
         </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>             INSERT, UPDATE, DELETE, COPY FROM, TRUNCATE, CREATE, DROP, ALTER, COMMENT
             </p></li><li class="listitem"><p>             SELECT ... FOR SHARE | UPDATE
             </p></li><li class="listitem"><p>トランザクションの分離レベルがシリアライザブルの場合のSELECT
             </p></li><li class="listitem"><p>OW EXCLUSIVE MODEよりも強いLOCK
             </p></li><li class="listitem"><p>                DECLARE, FETCH, CLOSE
             </p></li><li class="listitem"><p>             SHOW
             </p></li><li class="listitem"><p>トランザクションコマンドの一部
             </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>                 BEGIN READ WRITE, START TRANSACTION READ WRITE
                 </p></li><li class="listitem"><p>                 SET TRANSACTION READ WRITE, SET SESSION CHARACTERISTICS AS TRANSACTION READ WRITE
                 </p></li><li class="listitem"><p>                 SET transaction_read_only = off
                 </p></li></ul></div><p>
             </p></li><li class="listitem"><p>二相コミット関連のコマンド。PREPARE TRANSACTION, COMMIT PREPARED, ROLLBACK PREPARED
             </p></li><li class="listitem"><p>             LISTEN, UNLISTEN, NOTIFY
             </p></li><li class="listitem"><p>             VACUUM
             </p></li><li class="listitem"><p>シーケンス関連の関数(nextvalやsetvalなど)の呼び出し。
             </p></li><li class="listitem"><p>ラージオブジェクトの生成
             </p></li></ul></div><p>
       </p></li><li class="listitem"><p>プライマリノードとスタンバイノードのどちらにも送ることのできる問い合わせ。
負荷分散設定が有効ならば、スタンバイノードにも送信されます。
レプリケーションの遅延が<a class="xref" href="runtime-streaming-replication-check.html#guc-delay-threshold">delay_threshold</a>を上回っている場合は問い合わせはプライマリノードに送られます。

         </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>             SELECT not listed above
             </p></li><li class="listitem"><p>             COPY TO
             </p></li></ul></div><p>
        </p></li><li class="listitem"><p>プライマリノードとスタンバイノードのどちらにも送られる問い合わせ
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>             SET
             </p></li><li class="listitem"><p>             DISCARD
             </p></li><li class="listitem"><p>             DEALLOCATE ALL
             </p></li></ul></div><p>
        </p></li></ul></div><p>
   </p><p>明示的なトランザクションでは、以下のようになります。
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>BEGINなどのトランザクション開始コマンドは、プライマリノードに送られます。
         </p></li><li class="listitem"><p>続くSELECTなど、プライマリ/スタンバイのどちらにも送ることのできる問い合わせは、プライマリのトランザクション内でそのまま実行されるか、スタンバイノードで実行されます。
         </p></li><li class="listitem"><p>INSERTなど、スタンバイに送ることのできない問い合わせが現われた場合はプライマリに送られます。
そういったコマンドの後は、SELECTであってもプライマリノードに送られます。
これは、INSERTなどの問い合わせの結果を SELECTが直ちに参照できるようにするためです。
この状態は、トランザクションが閉じるか、アボートするまで続きます。
         </p></li></ul></div><p>
   </p><p>問い合わせが、拡張問い合わせモードで実行される場合は、問い合わせのparse段階で、問い合わせがスタンバイに送信可能かが決まります。
その際の判断ルールは通常のSQLと同じです。
たとえば問い合わせがINSERTならば、プライマリノードに送られます。
それに後に続くbind, describe, executeも同じくプライマリに送られます。
   </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>負荷分散によりSELECT文のparseがスタンバイノードに送信され、その後INSERTなどのDML文が<span class="productname">Pgpool-II</span>に送られた場合、parse済のSELECTはプライマリノードで実行されなければなりません。
そのため、同じSELECTがプライマリノードで再度パースされることになります。
     </p></div><p>最後に、pgpool-IIのパーサが構文エラーと判断した問い合わせはプライマリノードだけに送られます。
   </p></div><div class="sect2" id="runtime-config-load-balancing-settings"><div class="titlepage"><div><div><h3 class="title">5.7.3. 負荷分散の設定</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-load-balance-mode"><span class="term"><code class="varname">load_balance_mode</code> (<code class="type">boolean</code>)
        <a id="idm45645430525856" class="indexterm"></a>
      </span></dt><dd><p>onの設定すると、<span class="productname">Pgpool-II</span>は入ってきた<acronym class="acronym">SELECT</acronym>クエリに対する負荷分散を有効にします。
すなわち、クライアントからの<acronym class="acronym">SELECT</acronym>クエリは設定された<span class="productname">PostgreSQL</span>バックエンドに振り分けます。
デフォルトはoffです。
        </p><p>このパラメータはサーバ起動時にのみ設定可能です。
        </p></dd><dt id="guc-ignore-leading-white-space"><span class="term"><code class="varname">ignore_leading_white_space</code> (<code class="type">boolean</code>)
        <a id="idm45645430519584" class="indexterm"></a>
      </span></dt><dd><p>onに設定すると、負荷分散の際にSQL文行頭の空白を無視します(全角スペースは無視されません)。
これは、DBI/DBD:Pgのように、ユーザの意図に反してに空白を追加するようなAPIを使っているときに有用です。
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-white-function-list"><span class="term"><code class="varname">white_function_list</code> (<code class="type">string</code>)
        <a id="idm45645430514608" class="indexterm"></a>
      </span></dt><dd><p>データベースに対して更新を<span class="emphasis"><em>行なわない</em></span>関数名をコンマ区切りで指定します。
このリストに<span class="emphasis"><em>指定されていない</em></span>関数呼び出しを含むSELECTは負荷分散されません。
これらのクエリはレプリケーションモードにおいてはすべてのDBノードで複製され、マスタースレーブモードにおいてはプライマリノードにのみ送信されます。
        </p><p>関数名のマッチングに正規表現を使うことができます。
正規表現には自動的に<code class="literal">^</code>と<code class="literal">$</code>が付与されます。
        </p><div class="example" id="example-white-function-list-1"><p class="title"><strong>例5.2 正規表現の使用</strong></p><div class="example-contents"><p>もし読み出しのみを行う関数が"get_"あるいは"select_"で始まるようにしてあるのであれば、<a class="xref" href="runtime-config-load-balancing.html#guc-white-function-list">white_function_list</a>を以下のように設定可能です。
          </p><pre class="programlisting">white_function_list = 'get_.*,select_.*'
          </pre><p>
          </p></div></div><br class="example-break" /><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-black-function-list"><span class="term"><code class="varname">black_function_list</code> (<code class="type">string</code>)
        <a id="idm45645430504496" class="indexterm"></a>
      </span></dt><dd><p>データベースに対して更新を<span class="emphasis"><em>行う</em></span>関数名をコンマ区切りで指定します。
このリストに<span class="emphasis"><em>指定された</em></span>関数呼び出しを含むSELECTは負荷分散されません。
これらのクエリはレプリケーションモードにおいてはすべてのDBノードで複製され、マスタースレーブモードにおいてはプライマリノードにのみ送信されます。
        </p><p>関数名のマッチングに正規表現を使うことができます。
正規表現には自動的に<code class="literal">^</code>と<code class="literal">$</code>が付与されます。
        </p><div class="example" id="example-black-function-list-1"><p class="title"><strong>例5.3 正規表現の使用</strong></p><div class="example-contents"><p>もし更新を行う関数が"set_"、"update_"、"delete_"、あるいは"insert_"で始まるようにしてあるのであれば、<a class="xref" href="runtime-config-load-balancing.html#guc-black-function-list">black_function_list</a>を以下のように設定可能です。
          </p><pre class="programlisting">black_function_list = 'nextval,setval,set_.*,update_.*,delete_.*,insert_.*'
          </pre><p>
          </p></div></div><br class="example-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><a class="xref" href="runtime-config-load-balancing.html#guc-black-function-list">black_function_list</a>と<a class="xref" href="runtime-config-load-balancing.html#guc-white-function-list">white_function_list</a>は互いに排他的で、２つのリストの内、どちらか一方のみ設定することができます。
          </p></div><div class="example" id="example-black-function-list-2"><p class="title"><strong>例5.4 <code class="literal">nextval()</code>と<code class="literal">setval()</code>を適切なバックエンドに送る設定</strong></p><div class="example-contents"><p><span class="productname">Pgpool-II</span> <span class="emphasis"><em>V3.0</em></span>より前のバージョンでは、固定で<code class="literal">nextval()</code>と<code class="literal">setval()</code>がデータベースに書き込みを行なう関数であると認識されていました。
以下のように<a class="xref" href="runtime-config-load-balancing.html#guc-black-function-list">black_function_list</a>と<a class="xref" href="runtime-config-load-balancing.html#guc-black-function-list">black_function_list</a>を設定することで、それと同じように動作させることができます。
              </p><pre class="programlisting">white_function_list = ''
black_function_list = 'nextval,setval,lastval,currval'
              </pre><p>
          </p></div></div><br class="example-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><span class="productname">PostgreSQL</span>には<code class="literal">nextval()</code>と<code class="literal">setval()</code>に加え、<code class="literal">lastval()</code>と<code class="literal">currval</code>があります。
<code class="literal">lastval()</code>と<code class="literal">currval()</code>は書き込みを行う関数ではありませんが、これらの関数が負荷分散されることで発生するエラーを防ぐため、<code class="literal">lastval()</code>と<code class="literal">curval()</code>を書き込みを行う関数として扱うのが望ましいです。
          </p></div><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-database-redirect-preference-list"><span class="term"><code class="varname">database_redirect_preference_list</code> (<code class="type">string</code>)
        <a id="idm45645430478208" class="indexterm"></a>
      </span></dt><dd><p>特定のデータベース接続では<acronym class="acronym">SELECT</acronym>クエリが特定のバックエンドノードに送信されるように、"<em class="replaceable"><code>データベース名:ノードID</code></em>"ペアのリストを指定します。
たとえば"test:1"とした場合、"test"データベースへの接続においては、<span class="productname">Pgpool-II</span>は全ての<acronym class="acronym">SELECT</acronym>クエリをIDが1のバックエンドノードに送信します。
複数の"<em class="replaceable"><code>データベース名:ノードID</code></em>"のペアを カンマ(,)で区切って指定することができます。
        </p><p>データベース名には正規表現を指定することできます。
<em class="replaceable"><code>ノードID</code></em>には特別なキーワードを使うことができます。
"<span class="emphasis"><em>primary</em></span>"が指定された場合にはクエリはプライマリノードに送られます。
また、"<span class="emphasis"><em>standby</em></span>"が指定された場合はスタンバイノードのうちどれかをウェイトに応じてランダムに選択します。
        </p><div class="example" id="example-database-redirect-list"><p class="title"><strong>例5.5 database_redirect_preference_listの利用</strong></p><div class="example-contents"><p><acronym class="acronym">SELECT</acronym>クエリのルーティングルールを以下のように設定したい場合：
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>全ての<code class="literal">postgres</code>データベースにおける<acronym class="acronym">SELECT</acronym>クエリはプライマリバックエンドノードに送る。
              </p></li><li class="listitem"><p>全ての<code class="literal">mydb0</code>または<code class="literal">mydb1</code>データベースにおける<acronym class="acronym">SELECT</acronym>クエリはIDが1のバックエンドノードに送る。
              </p></li><li class="listitem"><p>全ての<code class="literal">mydb2</code>データベースにおける<acronym class="acronym">SELECT</acronym>クエリはスタンバイバックエンドノードに送る。
              </p></li></ul></div><p><a class="xref" href="runtime-config-load-balancing.html#guc-database-redirect-preference-list">database_redirect_preference_list</a>は以下のように設定します。
              </p><pre class="programlisting">database_redirect_preference_list = 'postgres:primary,mydb[01]:1,mydb2:standby'
              </pre><p>
          </p></div></div><br class="example-break" /><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-app-name-redirect-preference-list"><span class="term"><code class="varname">app_name_redirect_preference_list</code> (<code class="type">string</code>)
        <a id="idm45645430459200" class="indexterm"></a>
      </span></dt><dd><p>特定のクライアントアプリケーションの接続では<acronym class="acronym">SELECT</acronym>クエリが特定のバックエンドノードに送信されるように、"<em class="replaceable"><code>アプリケーション名:ノードID</code></em>"ペアのリストを指定します。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>「アプリケーション名」とはクライアントがデータベースに接続する時に指定する名称で、<span class="productname">PostgreSQL</span> <span class="emphasis"><em>V9.0</em></span>以降で利用可能です。
          </p></div><p>たとえば、<code class="command">psql</code>コマンドのアプリケーション名は"<code class="literal">psql</code>"です。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><span class="productname">Pgpool-II</span>は、クライアントから送信されたスタートアップパケットに含まれるアプリケーション名だけを認識します。
クライアントは事後にセッションの中でアプリケーション名を指定できますが、それは<span class="productname">Pgpool-II</span>のクエリルーティングでは考慮されません。
          </p></div><p><a class="xref" href="runtime-config-load-balancing.html#guc-app-name-redirect-preference-list">app_name_redirect_preference_list</a>の記法は<a class="xref" href="runtime-config-load-balancing.html#guc-database-redirect-preference-list">database_redirect_preference_list</a>と同じですので、アプリケーション名には正規表現も使用できます。
同様に特別なキーワード"<span class="emphasis"><em>primary</em></span>"はプライマリノードを、"<span class="emphasis"><em>standby</em></span>"はスタンバイサーバのいずれかを意味します。
        </p><div class="example" id="example-app-name-redirect-list"><p class="title"><strong>例5.6 app_name_redirect_preference_listの利用</strong></p><div class="example-contents"><p><acronym class="acronym">SELECT</acronym>クエリのルーティングルールを以下のように設定したい場合：
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>全ての<code class="literal">psql</code>クライアントからの<acronym class="acronym">SELECT</acronym>クエリはプライマリバックエンドノードに送る。
              </p></li><li class="listitem"><p>全ての<code class="literal">myapp1</code>クライアントからの<acronym class="acronym">SELECT</acronym>クエリはIDが1のバックエンドノードに送る。
              </p></li><li class="listitem"><p>全ての<code class="literal">myapp2</code>クライアントからの<acronym class="acronym">SELECT</acronym>クエリはスタンバイバックエンドノードに送る。
              </p></li></ul></div><p><a class="xref" href="runtime-config-load-balancing.html#guc-app-name-redirect-preference-list">app_name_redirect_preference_list</a>は以下のように設定します。
              </p><pre class="programlisting">app_name_redirect_preference_list = 'psql:primary,myapp1:1,myapp2:standby'
              </pre><p>
          </p></div></div><br class="example-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><a class="xref" href="runtime-config-load-balancing.html#guc-app-name-redirect-preference-list">app_name_redirect_preference_list</a>は、<a class="xref" href="runtime-config-load-balancing.html#guc-database-redirect-preference-list">database_redirect_preference_list</a>よりも優先されます。
          </p></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注意</h3><p><acronym class="acronym">JDBC</acronym>ドライバのpostgresql-9.3以前のバージョンでは、<acronym class="acronym">JDBC</acronym>ドライバの"<code class="literal">ApplicationName</code>" と "<code class="literal">assumeMinServerVersion=9.0</code>"オプションを指定してもスタートアップパケットの中にアプリケーション名を含ません。
<acronym class="acronym">JDBC</acronym>から<a class="xref" href="runtime-config-load-balancing.html#guc-app-name-redirect-preference-list">app_name_redirect_preference_list</a>機能を使用したければ、postgresql-9.4 以降のドライバをお使いください
          </p></div><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-allow-sql-comments"><span class="term"><code class="varname">allow_sql_comments</code> (<code class="type">boolean</code>)
        <a id="idm45645430431248" class="indexterm"></a>
      </span></dt><dd><p>onに設定すると、<span class="productname">Pgpool-II</span>は負荷分散やクエリキャッシュができるかどうかの判定の際に<acronym class="acronym">SQL</acronym>コメントを無視します。
このパラメータがoffに設定されている場合、クエリの<acronym class="acronym">SQL</acronym>コメントにより、クエリの負荷分散やキャッシュを防止することができます。
（<span class="productname">Pgpool-II</span> <span class="emphasis"><em>V3.4</em></span>より前のバージョンの動作です）。
        </p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-logging.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-health-check.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">5.6. エラー報告とログ取得 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 5.8. ヘルスチェック</td></tr></table></div></body></html>