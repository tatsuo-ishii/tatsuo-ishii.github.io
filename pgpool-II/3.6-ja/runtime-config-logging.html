<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.6. エラー報告とログ取得</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Pgpool-II 3.6.0 文書" /><link rel="up" href="runtime-config.html" title="第5章 サーバの設定" /><link rel="prev" href="runtime-config-connection-pooling.html" title="5.5. コネクションプーリング" /><link rel="next" href="runtime-config-load-balancing.html" title="5.7. 負荷分散" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left" colspan="2"></td><th width="60%" align="center"><a accesskey="h" href="index.html">Pgpool-II 3.6.0 文書</a></th><td width="20%" align="right"></td></tr><tr><td width="10%" align="left" valign="top"><a accesskey="p" href="runtime-config-connection-pooling.html">前へ</a> </td><td width="10%" align="left" valign="top"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="60%" align="center">5.6. エラー報告とログ取得</td><td width="20%" align="right" valign="top"> <a accesskey="n" href="runtime-config-load-balancing.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="runtime-config-logging"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.6. エラー報告とログ取得</h2></div></div></div><div class="sect2" id="runtime-config-logging-where-to-log"><div class="titlepage"><div><div><h3 class="title">5.6.1. ログの出力先</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-log-destination"><span class="term"><code class="varname">log_destination</code> (<code class="type">string</code>)
        <a id="idp57520960" class="indexterm"></a>
      </span></dt><dd><p><span class="productname">Pgpool-II</span>は、<span class="productname">Pgpool-II</span>のメッセージのログ出力先を2種類サポートします。
複数のログ出力先を使用したい場合は、希望するログ出力先をカンマで区切ったリストをパラメータに設定することができます。
						</p><pre class="programlisting">#for example to log on both syslog and stderr
log_destination = 'syslog,stderr'
            </pre><p>
デフォルトでは<code class="literal">stderr</code>のみにログ出力します。
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><code class="varname">log_destination</code>でsyslogオプションを使用できるようにするために、いくつかのシステムではシステムの<span class="application">syslog</span>デーモンの設定を変更しなければならないでしょう。
<span class="productname">Pgpool-II</span>ではログを<code class="literal">LOCAL0</code>から<code class="literal">LOCAL7</code>までの<span class="application">syslog</span>ファシリティで記録することができます（<a class="xref" href="runtime-config-logging.html#guc-syslog-facility">syslog_facility</a>を参照してください）。
しかし、ほとんどのプラットフォームのデフォルトの<span class="application">syslog</span>設定ではこれらのメッセージはすべて破棄されます。
うまく動作させるために<span class="application">syslog</span>デーモンの設定に以下のようなものを追加しなければならないでしょう。
						</p><pre class="programlisting">local0.*    /var/log/pgpool.log
						</pre><p>
					</p></div><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-syslog-facility"><span class="term"><code class="varname">syslog_facility</code> (<code class="type">enum</code>)
        <a id="idp57534400" class="indexterm"></a>
      </span></dt><dd><p><span class="application">syslog</span>へのログ取得が有効な場合、このパラメータは<span class="application">syslog</span>の「<code class="literal">facility</code>」が使われるように確定します。
<code class="literal">LOCAL0</code>、<code class="literal">LOCAL1</code>、<code class="literal">LOCAL2</code>、<code class="literal">LOCAL3</code>、<code class="literal">LOCAL4</code>、<code class="literal">LOCAL5</code>、<code class="literal">LOCAL6</code>、<code class="literal">LOCAL7</code>の中から選んでください。
デフォルトは<code class="literal">LOCAL0</code>です。
使用しているシステムの<span class="application">syslog</span>デーモンの文書を同時に参照してください。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-syslog-ident"><span class="term"><code class="varname">syslog_ident</code> (<code class="type">string</code>)
        <a id="idp57546416" class="indexterm"></a>
      </span></dt><dd><p><span class="application">syslog</span>にログ取得が有効な場合、このパラメータは<span class="application">syslog</span>ログ内の<span class="productname">Pgpool-II</span>メッセージを特定するのに使用するプログラム名を確定します。
デフォルトは<code class="literal">pgpool</code>です。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd></dl></div></div><div class="sect2" id="runtime-config-logging-when-to-log"><div class="titlepage"><div><div><h3 class="title">5.6.2. いつログを取得するか</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-client-min-messages"><span class="term"><code class="varname">client_min_messages</code> (<code class="type">enum</code>)
        <a id="idp57553616" class="indexterm"></a>
      </span></dt><dd><p>どのメッセージ階層をクライアントに送るかを管理します。
有効な値は、<code class="literal">DEBUG5</code>、<code class="literal">DEBUG4</code>、<code class="literal">DEBUG3</code>、<code class="literal">DEBUG2</code>、<code class="literal">DEBUG1</code>、<code class="literal">LOG</code>、<code class="literal">NOTICE</code>、<code class="literal">WARNING</code>、および<code class="literal">ERROR</code>です。
それぞれの階層はそれに続く全ての階層を包含します。
デフォルトは<code class="literal">NOTICE</code>です。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd><dt id="guc-log-min-messages"><span class="term"><code class="varname">log_min_messages</code> (<code class="type">enum</code>)
        <a id="idp57564576" class="indexterm"></a>
      </span></dt><dd><p>どのメッセージ階層をサーバログに書き込むかを管理します。有効な値は<code class="literal">DEBUG5</code>、<code class="literal">DEBUG4</code>、<code class="literal">DEBUG3</code>、<code class="literal">DEBUG2</code>、<code class="literal">DEBUG1</code>、<code class="literal">INFO</code>、<code class="literal">NOTICE</code>、<code class="literal">WARNING</code>、<code class="literal">ERROR</code>、<code class="literal">LOG</code>、<code class="literal">FATAL</code>、および<code class="literal">PANIC</code>です。
それぞれの階層はその下の全ての階層を含みます。
デフォルトは<code class="literal">WARNING</code>です。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd></dl></div></div><div class="sect2" id="runtime-config-logging-what-to-log"><div class="titlepage"><div><div><h3 class="title">5.6.3. 何をログに</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="guc-log-statement"><span class="term"><code class="varname">log_statement</code> (<code class="type">boolean</code>)
        <a id="idp57578144" class="indexterm"></a>
      </span></dt><dd><p>onに設定されている場合、全てのSQL文をログ出力します。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd><dt id="guc-log-per-node-statement"><span class="term"><code class="varname">log_per_node_statement</code> (<code class="type">boolean</code>)
        <a id="idp57582800" class="indexterm"></a>
      </span></dt><dd><p><a class="xref" href="runtime-config-logging.html#guc-log-statement">log_statement</a>と似ていますが、DBノード単位でログが出力されます。
レプリケーションや負荷分散が動いていることを確認するのに便利です。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd><dt id="guc-log-hostname"><span class="term"><code class="varname">log_hostname</code> (<code class="type">boolean</code>)
        <a id="idp57587840" class="indexterm"></a>
      </span></dt><dd><p>onに設定されている場合、<code class="command">ps</code>コマンドの結果、および（<a class="xref" href="runtime-config-logging.html#guc-log-connections">log_connections</a>がonの場合には）接続時のログに、IPアドレスではなくホスト名を表示します。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-log-connections"><span class="term"><code class="varname">log_connections</code> (<code class="type">boolean</code>)
        <a id="idp57593040" class="indexterm"></a>
      </span></dt><dd><p>onに設定されている場合、全てのクライアント接続をログへ出力します。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd><dt id="guc-log-error-verbosity"><span class="term"><code class="varname">log_error_verbosity</code> (<code class="type">enum</code>)
        <a id="idp57597136" class="indexterm"></a>
      </span></dt><dd><p>ログ取得されるそれぞれのメッセージに対し、サーバログに書き込まれる詳細の量を制御します。
有効な値は、<code class="literal">TERSE</code>、<code class="literal">DEFAULT</code>、および<code class="literal">VERBOSE</code>で、それぞれは表示されるメッセージにより多くのフィールドを追加します。
<code class="literal">TERSE</code>は<code class="literal">DETAIL</code>、<code class="literal">HINT</code>、<code class="literal">QUERY</code>、および<code class="literal">CONTEXT</code>エラー情報を除外します。
				</p><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<a class="xref" href="sql-pgpool-set.html" title="PGPOOL SET"><span class="refentrytitle">PGPOOL SET</span></a>コマンドで変更することもできます。
        </p></dd><dt id="guc-log-line-prefix"><span class="term"><code class="varname">log_line_prefix</code> (<code class="type">string</code>)
        <a id="idp57606896" class="indexterm"></a>
      </span></dt><dd><p>これは、各ログ行の先頭に出力する<code class="function">printf</code>の書式文字列です。
<code class="literal">%</code>から始まる<span class="quote">「<span class="quote">エスケープシーケンス</span>」</span>は、後述の通りのステータス情報で置き換えられます。
認識できないエスケープは無視されます。
他の文字はそのままログ行に出力されます。
デフォルトは '%t: pid %p: 'で、タイムスタンプとプロセスIDを印字します。
これは、<span class="productname">Pgpool-II</span> <span class="emphasis"><em>V3.4</em></span>より前のバージョンとの互換性を保つためです。
				</p><div class="table" id="log-line-prefix-table"><p class="title"><strong>表5.5 log_line_prefix escape options</strong></p><div class="table-contents"><table summary="log_line_prefix escape options" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>エスケープ</th><th>効果</th></tr></thead><tbody><tr><td>%a</td><td>クライアントのアプリケーション名</td></tr><tr><td>%p</td><td>プロセスID (PID)</td></tr><tr><td>%P</td><td>プロセス名</td></tr><tr><td>%t</td><td>タイムスタンプ</td></tr><tr><td>%d</td><td>データベース名</td></tr><tr><td>%u</td><td>ユーザ名</td></tr><tr><td>%l</td><td>プロセスごとのログ行番号</td></tr><tr><td>%%</td><td>'%' 文字自身</td></tr></tbody></table></div></div><br class="table-break" /><p>このパラメータは<span class="productname">Pgpool-II</span>の設定を再読み込みすることで変更可能です。
        </p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-connection-pooling.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-load-balancing.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">5.5. コネクションプーリング </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 5.7. 負荷分散</td></tr></table></div></body></html>