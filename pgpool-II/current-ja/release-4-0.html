<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>リリース 4.0</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Pgpool-II 4.1devel 文書"
HREF="index.html"><LINK
REL="UP"
TITLE="リリースノート"
HREF="release.html"><LINK
REL="PREVIOUS"
TITLE="リリース 4.0.1"
HREF="release-4-0-1.html"><LINK
REL="NEXT"
TITLE="リリース 3.7.7"
HREF="release-3-7-7.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2018-12-27T07:20:33"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Pgpool-II 4.1devel 文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="リリース 4.0.1"
HREF="release-4-0-1.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="release.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>付録 A. リリースノート</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="リリース 3.7.7"
HREF="release-3-7-7.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RELEASE-4-0"
>A.3. リリース 4.0</A
></H1
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>リリース日: </B
>2018-10-19</P
></BLOCKQUOTE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8176"
>A.3.1. 概要</A
></H2
><P
>このバージョンでは、<ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証および証明書認証に対応し、ロードバランスの制御が向上しており、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>11の新しい<TT
CLASS="LITERAL"
>SQL</TT
>パーサを取り込んでいます。
    </P
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>4.0の主な改善点は以下のとおりです。
    </P
><P
></P
><UL
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証および証明書認証の対応
        </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の偽のプライマリサーバ検出
        </P
></LI
><LI
><P
>ロードバランスの改善:
          <P
></P
></P><UL
><LI
><P
>更新を伴うクエリ実行後の更に細かい負荷分散の制御
              </P
></LI
><LI
><P
>特定クエリに対する負荷分散の制御
              </P
></LI
><LI
><P
>パラメータによる負荷分散の重み指定

              </P
></LI
></UL
><P>
        </P
></LI
><LI
><P
><A
HREF="sql-show-pool-nodes.html"
>SHOW POOL_NODES</A
> に最終更新時刻のタイムスタンプ追加
        </P
></LI
><LI
><P
>PostgreSQL11のSQLパーサの取込
        </P
></LI
><LI
><P
>クライアントメッセージのログ出力の追加
        </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8207"
>A.3.2. バージョン4.0への移行</A
></H2
><P
>バージョン4.0には、以前のバージョンとの互換性に影響する多数の変更点が含まれています。
以下の非互換性に注意してください。
   </P
><P
></P
><UL
><LI
><P
>1st/2nd ステージのオンラインリカバリコマンドにリカバリされるノードの番号を取得するためのパラメータを追加しました。(Tatsuo Ishii)
     </P
><P
>オンラインリカバリスクリプトは4つではなく5つのパラメータを受け取るようになりました（5番目のパラメータはリカバリされるノードの番号です）。
<TT
CLASS="LITERAL"
>pgpool_recovery</TT
>をバージョンアップするためには、<TT
CLASS="COMMAND"
>ALTER EXTENSION pgpool_recovery UPDATE TO '1.2'</TT
>を実行してください。
5番目のパラメータの情報を必要としない場合、既存の4つのパラメータの形式でリカバリスクリプト使用することが出来ます。
     </P
><P
>詳細は、<A
HREF="runtime-online-recovery.html#GUC-RECOVERY-1ST-STAGE-COMMAND"
>recovery_1st_stage_command</A
>と<A
HREF="runtime-online-recovery.html#GUC-RECOVERY-2ND-STAGE-COMMAND"
>recovery_2nd_stage_command</A
>を参照してください。
     </P
></LI
><LI
><P
>パラメータ<TT
CLASS="VARNAME"
>fail_over_on_backend_error</TT
>は、<A
HREF="runtime-config-failover.html#GUC-FAILOVER-ON-BACKEND-ERROR"
>failover_on_backend_error</A
>に変更されました。(Muhammad Usama)
     </P
><P
><A
HREF="runtime-config-failover.html#GUC-FAILOVER-ON-BACKEND-ERROR"
>failover_on_backend_error</A
>の代わりに古いパラメータ名<TT
CLASS="VARNAME"
>fail_over_on_backend_error</TT
>が使われた場合、警告メッセージを出力します。
     </P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>pgpool.conf</TT
>内でAESで暗号化されたパスワードを指定できます。(Muhammad Usama)
        </P
><P
>4.0以降では、<TT
CLASS="FILENAME"
>pgpool.conf</TT
>ファイル内の<A
HREF="runtime-config-health-check.html#GUC-HEALTH-CHECK-PASSWORD"
>health_check_password</A
>および<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-PASSWORD"
>sr_check_password</A
>、<A
HREF="runtime-watchdog-config.html#GUC-WD-LIFECHECK-PASSWORD"
>wd_lifecheck_password</A
>、<A
HREF="runtime-online-recovery.html#GUC-RECOVERY-PASSWORD"
>recovery_password</A
>でAESで暗号化されたパスワードを指定することができます。
        </P
><P
>パスワード文字列の先頭に<TT
CLASS="LITERAL"
>TEXT</TT
>を付与した暗号化されていないクリアテキストパスワードを指定します。
有効な接頭辞が無い場合、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は文字列を平文のパスワードと見なします。
        </P
><P
><TT
CLASS="FILENAME"
>pgpool.conf</TT
>ファイル内の<A
HREF="runtime-config-health-check.html#GUC-HEALTH-CHECK-PASSWORD"
>health_check_password</A
>および<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-PASSWORD"
>sr_check_password</A
>、<A
HREF="runtime-watchdog-config.html#GUC-WD-LIFECHECK-PASSWORD"
>wd_lifecheck_password</A
>、<A
HREF="runtime-online-recovery.html#GUC-RECOVERY-PASSWORD"
>recovery_password</A
>で指定された空のパスワード文字列は、<A
HREF="runtime-config-connection.html#GUC-POOL-PASSWD"
>pool_passwd</A
>が特定のパスワードを含まない場合だけ使われます。
もし、これらのパラメータが空白だった場合、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は空のパスワードを使用する前に最初に<A
HREF="runtime-config-connection.html#GUC-POOL-PASSWD"
>pool_passwd</A
>ファイルから特定のユーザのパスワードの取得を試みます。
        </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8247"
>A.3.3. 主要な改善点</A
></H2
><P
></P
><UL
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証および証明書認証に対応しました。(Muhammad Usama)
          <P
></P
></P><UL
><LI
><P
><ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証方式に対応しました。
              </P
><P
>pool_passwd認証ファイルを使用したSCRAM認証に対応しました。
              </P
><P
>詳細は<A
HREF="auth-methods.html#AUTH-SCRAM"
>項6.2.3</A
>を参照してください。
              </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>とフロントエンドの間で<ACRONYM
CLASS="ACRONYM"
>CERT</ACRONYM
>認証を使用できます。
              </P
><P
>この認証方法を使用する場合、Pgpool-IIはクライアントが有効な証明書を提供することを必要とします。
              </P
><P
>詳細は<A
HREF="auth-methods.html#AUTH-CERT"
>項6.2.4</A
>を参照してください。
              </P
></LI
><LI
><P
>フロントエンド/バックエンドで異なる認証方式を利用できます。
              </P
><P
>これはクライアントと<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>、および<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>とバックエンド間で異なる認証方式を利用できます。
              </P
></LI
></UL
><P>
          <P
></P
></P><UL
><LI
><P
><A
HREF="runtime-config-connection.html#GUC-POOL-PASSWD"
>pool_passwd</A
>は、3つの形式でパスワードを保存できるようになりました。
AES256暗号化形式、平文形式、md5形式です。
               </P
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は接頭辞によってパスワードの形式を確認するため、pool_passwd内の各パスワードのエントリはパスワードの形式を接頭語として付ける必要があります。
               </P
><P
>md5ハッシュパスワードは<TT
CLASS="LITERAL"
>md5</TT
>接頭辞、AES256暗号化パスワード形式は<TT
CLASS="LITERAL"
>AES</TT
>接頭辞を使って保存することができます。
平文形式のパスワードの保存のためには、<TT
CLASS="LITERAL"
>TEXT</TT
>接頭辞を使用できます。
               </P
><P
>有効な接頭辞がない場合、Pgpool-IIは文字列を平文のパスワードとして見なします。
               </P
><P
>例:
</P><PRE
CLASS="PROGRAMLISTING"
>username1:AESIFwI86k+ZbVdf6C+t3qpGA==
username2:md59c6583185ba6a85bdcd1f129ec8cabb4
username3:TEXTmypassword</PRE
><P>
               </P
></LI
></UL
><P>
          <P
></P
></P><UL
><LI
><P
><A
HREF="runtime-config-connection.html#GUC-POOL-PASSWD"
>pool_passwd</A
>を用いずにデータベースへの接続に<ACRONYM
CLASS="ACRONYM"
>MD5</ACRONYM
>認証および<ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証方式を使えます。
              </P
><P
>新しい設定パラメータ<A
HREF="runtime-config-connection.html#GUC-ALLOW-CLEAR-TEXT-FRONTEND-AUTH"
>allow_clear_text_frontend_auth</A
>を追加しました。
このパラメータは接続するユーザのパスワードが<A
HREF="runtime-config-connection.html#GUC-POOL-PASSWD"
>pool_passwd</A
>ファイルに含まれていない、かつ（クライアントから提供された）パスワードがバックエンドの<ACRONYM
CLASS="ACRONYM"
>MD5</ACRONYM
>もしくは<ACRONYM
CLASS="ACRONYM"
>SCRAM</ACRONYM
>認証で使われる場合、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>がクライアントとのクリアテキストのパスワード認証を行うことを許可します。
              </P
></LI
></UL
><P>
          <P
></P
></P><UL
><LI
><P
>新しい<A
HREF="pg-enc.html"
>pg_enc</A
>コマンドは、暗号化されたパスワードを生成します。
              </P
><P
>AESで暗号化されたパスワードを作成できる<A
HREF="pg-enc.html"
>pg_enc</A
>コマンドを追加しました。

              </P
></LI
></UL
><P>
        </P
><P
>詳細は、<A
HREF="client-authentication.html"
>第6章</A
>を参照してください。
        </P
></LI
><LI
><P
>新しいパラメータ<A
HREF="runtime-config-failover.html#GUC-DETACH-FALSE-PRIMARY"
>detach_false_primary</A
>を追加しました。 (Tatsuo Ishii)
        </P
><P
><TT
CLASS="LITERAL"
>detach_false_primary = on</TT
>の場合、偽のプライマリノードを切り離します。
デフォルトはoffです。<TT
CLASS="STRUCTNAME"
>pg_stat_wal_receiver</TT
>を使用しているため、このパラメータはストリーミングレプリケーションモードかつ<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>9.6以降でのみ有効です。
<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>9.5以前のバージョンの場合、エラーは発生せずこの機能は無視されます。
        </P
></LI
><LI
><P
>更新を含むクエリ実行後の負荷分散の振る舞いを指定する<A
HREF="runtime-config-load-balancing.html#GUC-DISABLE-LOAD-BALANCE-ON-WRITE"
>disable_load_balance_on_write</A
>を追加しました。(Tatsuo Ishii)
        </P
><P
>このパラメータは、更新クエリ実行後の振る舞いを指定できます。
        </P
></LI
><LI
><P
>パラメータとして負荷分散の重みの割合を指定できるようになりました。(Bo Peng)
        </P
><P
>新しい機能として<A
HREF="runtime-config-load-balancing.html#GUC-DATABASE-REDIRECT-PREFERENCE-LIST"
>database_redirect_preference_list</A
>および<A
HREF="runtime-config-load-balancing.html#GUC-APP-NAME-REDIRECT-PREFERENCE-LIST"
>app_name_redirect_preference_list</A
>に対して負荷分散の重みを指定できます。

        </P
><P
>特定のデータベース接続およびバックエンドノードに対して、指定した負荷分散の比でSELECTクエリを送るためのリスト"database-name:node id(ratio)"を指定できます。
        </P
><P
>特定のアプリケーション接続およびバックエンドノードに対して、指定した負荷分散の比でSELECTクエリを送るためのリスト"application-name:node id(ratio)"を指定できます。
        </P
><P
>この負荷分散の比は 0から1の間の値を指定できます。
デフォルトは1.0です。
        </P
></LI
><LI
><P
>負荷分散すべきではないSQLパターンのリストを指定できる<A
HREF="runtime-config-load-balancing.html#GUC-BLACK-QUERY-PATTERN-LIST"
>black_query_pattern_list</A
> を追加しました。(Bo Peng)
        </P
><P
>プライマリノードだけに送るSQLのパターンをセミコロンで区切られたリストで指定できます。
SQLのパターンには正規表現を使用することができます。
この機能はマスタースレーブモードのみサポートします。
        </P
></LI
><LI
><P
>クライアントのメッセージに関するログ出力を許可する<A
HREF="runtime-config-logging.html#GUC-LOG-CLIENT-MESSAGES"
>log_client_messages</A
>を追加しました。(Takuma Hoshiai, Tatsuo Ishii)
        </P
><P
><TT
CLASS="VARNAME"
>log_client_messages = on</TT
>を設定すると, デバックメッセージなしでクライアントのメッセージをログ出力できます。
        </P
></LI
><LI
><P
>          <A
HREF="sql-show-pool-nodes.html"
>SHOW POOL_NODES</A
>コマンドに<TT
CLASS="LITERAL"
>last_status_change</TT
>列を追加しました。
        </P
><P
>新しい列は<TT
CLASS="LITERAL"
>status</TT
>もしくは<TT
CLASS="LITERAL"
>role</TT
>が変更された時刻を示します。
        </P
><P
>列を追加した理由に関しては<A
HREF="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-June/002822.html"
TARGET="_top"
>[pgpool-hackers: 2822]</A
>を参照してください。
        </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>11のSQLパーサを取り込みました。(Bo Peng)
        </P
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>11で新しく追加されたSQLの構文を完全に理解できます。
たとえば、<TT
CLASS="LITERAL"
>CREATE/ALTER/DROP PROCEDURE</TT
>や<TT
CLASS="LITERAL"
>{ RANGE | ROWS | GROUPS } frame_start [ frame_exclusion ]</TT
>などです。
        </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8351"
>A.3.4. 他の改善点</A
></H2
><P
></P
><UL
><LI
><P
><TT
CLASS="COMMAND"
>pgpool_setup</TT
>コマンドに<SPAN
CLASS="APPLICATION"
>pg_rewind</SPAN
>を使用するための"-r"オプションを追加しました。(Tatsuo Ishii)
        </P
><P
><TT
CLASS="COMMAND"
>pgpool_setup</TT
>のオンラインリカバリスクリプト<TT
CLASS="FILENAME"
>basebackup.sh</TT
>では、最初に<SPAN
CLASS="APPLICATION"
>pg_rewind</SPAN
>を試します。
<SPAN
CLASS="APPLICATION"
>pg_rewind</SPAN
>が失敗した場合、rsyncを使用します。
        </P
><P
>また、<SPAN
CLASS="APPLICATION"
>pgpool_setup</SPAN
>に新しい環境変数"USE_PG_REWIND"を追加しました。
これは"-r"オプションと同様の効果があります。
        </P
></LI
><LI
><P
><SPAN
CLASS="APPLICATION"
>pgpool_setup</SPAN
>コマンドにレプリケーションスロットを使用するための"-s"オプションを追加しました。(Tatsuo Ishii)
        </P
><P
>これはスタンバイを昇格する際の問題を解消します。
スタンバイが昇格するときPITRアーカイブ中にタイムラインが変更されるため、他のスタンバイとアーカイブディレクトリを共有している場合他のスタンバイが停止していました。
        </P
><P
>また、<SPAN
CLASS="APPLICATION"
>pgpool_setup</SPAN
>に新しい環境変数"USE_REPLICATION_SLOT"を追加しました。
これは"-s"オプションと同様の効果があります。
        </P
><P
>"USE_REPLICATION_SLOT=true"の場合、ストリーミングレプリケーションでアーカイブの代わりにレプリケーションスロットを使用できます。
        </P
><P
>USE_REPLICATION_SLOT 環境変数を設定することにより、現在全てのテスト内の<SPAN
CLASS="APPLICATION"
>pgpool_setup</SPAN
>でレプリケーションスロットが使われています。
これは<TT
CLASS="FILENAME"
>src/test/regression</TT
>配下のディスクスペースを6.3GBから5.1GB減らします（1.2GBの節約）。
        </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>に<A
HREF="pgproto.html"
>pgproto</A
>を導入しました。(Takuma Hoshiai)
        </P
><P
>新しく追加した<A
HREF="pgproto.html"
>pgproto</A
>コマンドは、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>もしくはフロントエンド/バックエンドプロトコルを理解するその他のサーバをテストします。
        </P
></LI
><LI
><P
><A
HREF="pcp-proc-info.html"
>pcp_proc_info</A
>内で<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の子プロセスIDと<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>のバックエンドIDを表示できます。(Tatsuo Ishii)
        </P
><P
>全ての子プロセスと利用可能な接続スロットが表示される--all オプション追加しました。
        </P
></LI
><LI
><P
><A
HREF="pcp-node-info.html"
>pcp_node_info</A
>に<TT
CLASS="LITERAL"
>replication_delay</TT
>と<TT
CLASS="LITERAL"
>last_status_change</TT
>を追加しました。(Tatsuo Ishii)
        </P
></LI
><LI
><P
>pgpool_admの<A
HREF="pgpool-adm-pcp-node-info.html"
>pgpool_adm_pcp_node_info</A
>に<TT
CLASS="LITERAL"
>role</TT
>、<TT
CLASS="LITERAL"
>replication_delay</TT
>、<TT
CLASS="LITERAL"
>last_status_change</TT
>列を追加しました。(Tatsuo Ishii)
        </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8399"
>A.3.5. 変更点</A
></H2
><P
></P
><UL
><LI
><P
>大半のDBUG1のメッセージをDEBUG5に変更しました。(Tatsuo Ishii)
      </P
><P
>Pgpool-IIを"-d"オプションで起動した場合のpgpoolログのサイズを大きく減らします。
（これは<A
HREF="runtime-config-logging.html#GUC-CLIENT-MIN-MESSAGES"
>client_min_messages</A
> = debug1と同等です）。
      </P
><P
><A
HREF="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-May/002794.html"
TARGET="_top"
>[pgpool-hackers: 2794]</A
>の議論の結果です。

      </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN8408"
>A.3.6. 不具合修正</A
></H2
><P
></P
><UL
><LI
><P
>ネイティブレプリケーションモードで、<TT
CLASS="LITERAL"
>SQL</TT
> に <CODE
CLASS="FUNCTION"
>now()</CODE
> などの時刻関数を利用した場合、<TT
CLASS="LITERAL"
>WHERE</TT
> 句に<TT
CLASS="LITERAL"
>IN (SELECT ...)</TT
>を含むと構文エラーになる不具合を修正しました。
(<A
HREF="http://www.pgpool.net/mantisbt/view.php?id=433"
TARGET="_top"
>bug 433</A
>) (Bo Peng)
        </P
></LI
><LI
><P
>HAVE_ASPRINTFが定義されていない場合のコンパイラのエラーを修正しました。(Tatsuo Ishii)
        </P
></LI
><LI
><P
>生成される<TT
CLASS="FILENAME"
>src/sql/pgpool_adm/Makefile.in</TT
>を削除するため<TT
CLASS="FILENAME"
>configure.ac</TT
>を修正しました。(Tatsuo Ishii)
      </P
></LI
><LI
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 9.5を使っている場合、Pgpoolのメインプロセスがセグフォルトするのを修正しました。(Tatsuo Ishii)
        </P
><P
>pgpool_setup -n 3（またはそれ以上）の場合にバグが発生します。
ノード2のリカバリをしている間、バックエンド#2が稼働していない場合であってもバージョン情報を取得しようとしていました。
これは接続がまだ確立されてないためセグフォルトを引き起こします。
<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL 9.6</SPAN
>以降で発生しない理由は、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>のバージョンが9.5以降の場合すぐにループが終了していたためです。
これを修正するため、VALID_BACKENDマクロを呼ぶ処理を追加しました。
        </P
></LI
><LI
><P
>pgpool_setupに<A
HREF="runtime-config-health-check.html#GUC-HEALTH-CHECK-TIMEOUT"
>health_check_timeout</A
>を追加しました。(Tatsuo Ishii)
        </P
><P
>ノード毎のhealth_check_timeoutが抜けていました。
これはノード毎のヘルスチェックのパラメータをサポートした際に追加したはずでした。
        </P
></LI
><LI
><P
>Test: リグレッションテスト 006.memcacheが失敗する可能性を減らしました。(Tatsuo Ishii)
      </P
><P
>不定期にテストが失敗するのはレプリケーションラグが原因だと思われます。
スクリプトはスタンバイからテーブルの読み込みを試しますが、まだテーブルが存在しないためエラーが返ってきます。
そのため、テーブルの作成後pg_sleep()を挿入します。
      </P
></LI
><LI
><P
>Test: リグレッションテスト 055.backend_all_downのエラーを修正しました。(Bo Peng)
        </P
></LI
><LI
><P
>Doc: オンラインリカバリのドキュメントを改善しました。(Tatsuo Ishii)
        </P
><P
>2nd stage コマンドはネイティブレプリケーションモードのみで必要であることを明確にしました。
        </P
></LI
><LI
><P
>Test: ノード0がプライマリではない場合を想定した新しいリグレッションテスト <TT
CLASS="FILENAME"
>017.node_0_is_down</TT
>を追加しました。(Tatsuo Ishii)
        </P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="release-4-0-1.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="release-3-7-7.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>リリース 4.0.1</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="release.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>リリース 3.7.7</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>