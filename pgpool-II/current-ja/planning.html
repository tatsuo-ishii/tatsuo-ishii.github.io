<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>プランニング</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Pgpool-II 4.3devel 文書"
HREF="index.html"><LINK
REL="UP"
TITLE="Pgpool-IIのインストール"
HREF="installation.html"><LINK
REL="PREVIOUS"
TITLE="Pgpool-IIのインストール"
HREF="installation.html"><LINK
REL="NEXT"
TITLE="Pgpool-IIのインストール"
HREF="install-source.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2021-02-06T11:39:59"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Pgpool-II 4.3devel 文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Pgpool-IIのインストール"
HREF="installation.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="installation.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 2章<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>のインストール</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="Pgpool-IIのインストール"
HREF="install-source.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="PLANNING"
>2.1. プランニング</A
></H1
><P
>   <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を管理するツールなので、まずは<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の利用形態を決めなければなりません。
   加えて、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>ではそれ自体の可用性を高めるために、複数の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を導入することができます。
   何本の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を導入するのが適切なのかを事前に計画しなければなりません。
   この節では最初に<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の動作モードを議論し、次に<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の導入形態を議論します。
  </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="PLANNING-POSTGRESQL"
>2.1.1. PostgreSQLのクラスタリングモード</A
></H2
><P
>    <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の導入台数は1以上が可能ですが、1台ではその<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>がダウンした時にデータベースシステム全体が使えなくなるため、通常2台以上の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を導入します。
    2台以上の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を用いる場合、何らかの方法でそれらのデータベース内容を同じになるようにしなければなりません。
    データベースの同期方法の違いをここでは「クラスタリングモード」と呼びます。
    もっとも広く使われているクラスタリングモードは、「ストリーミングレプリケーションモード」です。
    特に何か特別な考慮が必要でなければ、ストリーミングレプリケーションモードを選択することをお勧めします。
    動作モードの詳細については<A
HREF="configuring-pgpool.html#RUNNING-MODE"
>項3.3.2</A
>をご覧ください。
   </P
><P
>    次に考えなければならないのは、何台の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を使うかです。
    2台あれば最低限片方の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>がダウンしてもデータベースの運用は継続できますが、検索処理を複数のサーバで分担させる検索負荷分散処理を行うのであれば、3台以上の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を使うことも珍しくありません。
    <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は豊富な負荷分散の調整パラメータを用意しています。
    詳細は<A
HREF="runtime-config-load-balancing.html"
>項5.7</A
>をご覧ください。
   </P
><P
>    <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>では柔軟に<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>サーバを後から追加できるので、とりあえず<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を使ってみたい、という方は2台の<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>から始めるのが良いでしょう。
   </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="PLANNING-PGPOOL"
>2.1.2. Pgpool-IIの導入形態</A
></H2
><P
>    <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は1台でも利用が可能ですが、その<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>が停止するとデータベース全体が利用できなくなるので、複数の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を導入することをお勧めします。
    複数の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>はwatchdogと言う仕組みで連携を取りつつお互いを監視し、その中の1台が「リーダー」と呼ばれて仮想IPを持つので、クライアントはその仮想IPにアクセスすればばよく、複数の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>が導入されていることを意識する必要はありません。
    (watchdogについては<A
HREF="tutorial-watchdog-intro.html"
>項4.1</A
>をご覧ください。)
    もしある<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>がダウンすると、別の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>が取って代わってリーダーになります。
   </P
><P
>    リーダーは複数存在してはいけないので、新しいリーダーを決める際にはwatchdogは投票を行ないます。
    この時<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>が偶数台だと多数決でリーダーを決めることができなくなってしまいます。
    ですから<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は3台以上の奇数台で構成することをお勧めします。
   </P
><P
>    なお、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>と<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>は同じサーバに同居していても構いません。
    たとえば、リソースを節約するために3台のサーバのみを用意し、それぞれに<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>と<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>を動かすこともできます。
   </P
><P
>    <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>3台、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>2台をストリーミングレプリケーションモードで動作させる本格的な例が
    <A
HREF="example-cluster.html"
>項8.2</A
>で詳しく紹介されているので、すぐにプロダクションレベルで<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を動かしたい方はそれを参考にすると良いでしょう。
   </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="installation.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="install-source.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>のインストール</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="installation.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Pgpool-IIのインストール</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>