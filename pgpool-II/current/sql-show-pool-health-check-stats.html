<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>SHOW POOL_HEALTH_CHECK_STATS</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="pgpool-II 4.2devel Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="SQL type commands"
HREF="sql-commands.html"><LINK
REL="PREVIOUS"
TITLE="SHOW POOL_CACHE"
HREF="sql-show-pool-cache.html"><LINK
REL="NEXT"
TITLE="SHOW POOL_BACKEND_STATS"
HREF="sql-show-pool-backend-stats.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-1"><META
NAME="creation"
CONTENT="2020-08-28T08:06:46"></HEAD
><BODY
CLASS="REFENTRY"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>pgpool-II 4.2devel Documentation</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="SHOW POOL_CACHE"
HREF="sql-show-pool-cache.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-commands.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="SHOW POOL_BACKEND_STATS"
HREF="sql-show-pool-backend-stats.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="SQL-SHOW-POOL-HEALTH-CHECK-STATS"
></A
>SHOW POOL_HEALTH_CHECK_STATS</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN9197"
></A
><H2
>Name</H2
>SHOW POOL_HEALTH_CHECK_STATS&nbsp;--&nbsp;   show health check statistics data
  </DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN9200"
></A
><H2
>Synopsis</H2
><PRE
CLASS="SYNOPSIS"
>   SHOW POOL_HEALTH_CHECK_STATS
  </PRE
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN9202"
></A
><H2
>Description</H2
><P
>   <TT
CLASS="COMMAND"
>SHOW POOL_HEALTH_CHECK_STATS</TT
> displays health
   check (see <A
HREF="runtime-config-health-check.html"
>Section 5.8</A
>) statistic
   data mostly collected by health check process. This command helps
   <SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
> admin to study events related
   to health check. For example, admin can easily locate the failover
   event in the log file by looking at "last_failed_health_check"
   column. Another example is finding unstable connection to backend
   by evaluating "average_retry_count" column. If particular node
   shows higher retry count than other node, there may be problem to
   the connection to the backend.
  </P
><P
>   <A
HREF="sql-show-pool-health-check-stats.html#HEALTH-CHECK-STATS-DATA-TABLE"
>Table 1</A
> shows each column name and its description.
  </P
><DIV
CLASS="TABLE"
><A
NAME="HEALTH-CHECK-STATS-DATA-TABLE"
></A
><P
><B
>Table 1. Statistics data shown by pool_health_check_stats command</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
>Column Name</TH
><TH
>Description</TH
></TR
></THEAD
><TBODY
><TR
><TD
>node_id</TD
><TD
>       Backend node id.
      </TD
></TR
><TR
><TD
>hostname</TD
><TD
>       Backend hostname or UNIX domain socket path.
      </TD
></TR
><TR
><TD
>port</TD
><TD
>       Backend port number.
      </TD
></TR
><TR
><TD
>status</TD
><TD
>       Backend status. One of up, down, waiting, unused or quarantine.
      </TD
></TR
><TR
><TD
>role</TD
><TD
>       Role of the node. Either primary or standby in streaming
       replication mode. Either master or slave in other mode.
      </TD
></TR
><TR
><TD
>last_status_change</TD
><TD
>       Timestamp of last backend status changed.
      </TD
></TR
><TR
><TD
>total_count</TD
><TD
>       Number of health check count in total.
      </TD
></TR
><TR
><TD
>success_count</TD
><TD
>       Number of successful health check count in total.
      </TD
></TR
><TR
><TD
>fail_count</TD
><TD
>       Number of failed health check count in total.
      </TD
></TR
><TR
><TD
>skip_count</TD
><TD
>       Number of skipped health check count in total. If the node is
       already down, health check skips the node.
      </TD
></TR
><TR
><TD
>retry_count</TD
><TD
>       Number of retried health check count in total.
      </TD
></TR
><TR
><TD
>average_retry_count</TD
><TD
>       Number of average retried health check count in a health check
       session.
      </TD
></TR
><TR
><TD
>max_retry_count</TD
><TD
>       Number of maximum retried health check count in a health check
       session.
      </TD
></TR
><TR
><TD
>max_duration</TD
><TD
>       Maximum health check duration in Millie seconds. If a health
       check session retries, the health check duration is sum of each
       retried health check.
      </TD
></TR
><TR
><TD
>min_duration</TD
><TD
>       Minimum health check duration in Millie seconds. If a health
       check session retries, the health check duration is sum of each
       retried health check.
      </TD
></TR
><TR
><TD
>average_duration</TD
><TD
>       Average health check duration in Millie seconds. If a health
       check session retries, the health check duration is sum of each
       retried health check.
      </TD
></TR
><TR
><TD
>last_health_check</TD
><TD
>       Timestamp of last health check.  If heath check does not
       performed yet, empty string.
      </TD
></TR
><TR
><TD
>last_successful_health_check</TD
><TD
>       Timestamp of last successful health check. If heath check does
       not succeeds yet, empty string.
      </TD
></TR
><TR
><TD
>last_skip_health_check</TD
><TD
>       Timestamp of last skipped health check. If heath check is not
       skipped yet, empty string. Note that it is possible that this
       field is an empty string even if the status is down. In this
       case failover was triggered by other than health check process.
      </TD
></TR
><TR
><TD
>last_falied_health_check</TD
><TD
>       Timestamp of last failed health check. If heath check does not
       fail yet, empty string. Note that it is possible that this
       field is an empty string even if the status is down. In this
       case failover was triggered by other than health check process.
      </TD
></TR
></TBODY
></TABLE
></DIV
><P
>   Here is an example session:
   </P><PRE
CLASS="PROGRAMLISTING"
>test=# show pool_health_check_stats;
-[ RECORD 1 ]----------------+--------------------
node_id                      | 0
hostname                     | /tmp
port                         | 11002
status                       | up
role                         | primary
last_status_change           | 2020-01-26 19:08:45
total_count                  | 27
success_count                | 27
fail_count                   | 0
skip_count                   | 0
retry_count                  | 0
average_retry_count          | 0.000000
max_retry_count              | 0
max_duration                 | 9
min_duration                 | 2
average_duration             | 6.296296
last_health_check            | 2020-01-26 19:12:45
last_successful_health_check | 2020-01-26 19:12:45
last_skip_health_check       | 
last_failed_health_check     | 
-[ RECORD 2 ]----------------+--------------------
node_id                      | 1
hostname                     | /tmp
port                         | 11003
status                       | down
role                         | standby
last_status_change           | 2020-01-26 19:11:48
total_count                  | 19
success_count                | 12
fail_count                   | 1
skip_count                   | 6
retry_count                  | 3
average_retry_count          | 0.230769
max_retry_count              | 3
max_duration                 | 83003
min_duration                 | 0
average_duration             | 6390.307692
last_health_check            | 2020-01-26 19:12:48
last_successful_health_check | 2020-01-26 19:10:15
last_skip_health_check       | 2020-01-26 19:12:48
last_failed_health_check     | 2020-01-26 19:11:48
   </PRE
><P>
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-show-pool-cache.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="sql-show-pool-backend-stats.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>SHOW POOL_CACHE</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="sql-commands.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>SHOW POOL_BACKEND_STATS</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>