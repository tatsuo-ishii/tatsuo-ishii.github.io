<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ -->
<!--X-From: "Yoshio Tokuda"<actords@zaqcad091da.zaq.ne.jp> -->
<!--X-Date: Tue, 22 Aug 2000 16:44:14 +0900 (JST) -->
<!--X-Message-Id: 20000822164413.19622861@zaqcad091da.zaq.ne.jp -->
<!--X-ContentType: text/plain -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Æ </TITLE>
<LINK REV="made" HREF="mailto:actords@zaqcad091da.zaq.ne.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00447.html">Date Prev</A>][<A HREF="msg00449.html">Date Next</A>][<A HREF="msg00533.html">Thread Prev</A>][<A HREF="msg00449.html">Thread Next</A>][<A HREF="index.html#00448">Date Index</A>][<A HREF="threads.html#00448">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: "Yoshio Tokuda"&lt;<A HREF="mailto:actords@zaqcad091da.zaq.ne.jp">actords@zaqcad091da.zaq.ne.jp</A>&gt;</LI>
<LI><em>Date</em>: Tue, 22 Aug 2000 16:44:14 +0900 (JST)</LI>
<LI><em>CC</em>: "PHP ML Server"&lt;<A HREF="mailto:PHP-jp@sidecar.ics.es.osaka-u.ac.jp">PHP-jp@sidecar.ics.es.osaka-u.ac.jp</A>&gt;</LI>
<LI><em>Organization</em>: Merry Machanization Japan Corp.</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
ÆÁÅÄ¤È¸À¤¤¤Þ¤¹

¡Ú¸½¾Ý¡Û
INSERT Ä¾¸å¤Ë pg_getlastoid() ¤ò¼Â¹Ô¤¹¤ë¤È¡¢ËÜÍè¼«Æ°À¸À®¤·¤¿
OIDÈÖ¹æ¤È°Û¤Ê¤ë¿ôÃÍ¤òÊÖ¿ô¤¹¤ë¸½¾Ý¤Ç¤¹¡£¿®¤¸¤Æ¤¤¤¿¤À¤±¤Ê¤¤¤È
Â¸¤¸¤Þ¤¹¡£ÌÜ²¼¡¢PostgreSQL7.0.2¤ÏÉé(¥Þ¥¤¥Ê¥¹)¤ÎOID¤ò¼«Æ°
À¸À®¤·¤Æ¤¤¤Þ¤¹¡£Îã¤¨¤Ð¡¡-2147479072¡¡¤È¤«¤Ç¤¹¡£
²¾¤Ëº£¡¢INSERT¤ò¼Â¹Ô¤·¼«Æ°Åª¤ËÀ¸À®¤µ¤ì¤¿OID¤¬ -2147479072
¤À¤È¤·¤Þ¤·¤ç¤¦¡£¤½¤·¤Æ¡¢¤³¤ÎINSERT¤òPHP¤Çpg_exec¤·¤¿Ä¾¸å¤Ë
pg_getlastoid()¤ò¼Â¹Ô¤¹¤ë¤È¡¢²¿¤ÈÌá¤êÃÍ¤¬Àµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¤¤Þ¤¹¡£
¤Ä¤Þ¤ê¡¢pg_getlastoid() ¤ÎÌá¤êÃÍ¤Ï ¡Ü2147479072 ¤È¤Ê¤ê¤Þ¤¹¡£
¤ß¤Ê¤µ¤ó¤Î¤È¤³¤í¤Ç¤Ï¡¢°Û¾ï¤Ï¤Ê¤¤¤Ç¤¹¤«¡©
¤­¤Ã¤È¤ß¤Ê¤µ¤ó¤Î¤È¤³¤í¤Ç¤Ï¡ÖOID¤ÏÀµ¿ô¤À¤è¡ª¡×¤Ã¤Æ¸À¤ï¤ì¤ë¤Î¤Ç
¤·¤ç¤¦¤Í¡£

PHP¤Ï³Î¤«¤ËPostgres7.0.2¤ò¥¤¥ó¥¹¥È¡¼¥ë¤·¤¿Ä¾¸å¤Ë¡¢PHP¤ò
ºÆÅÙ¥³¥ó¥Ñ¥¤¥ë¤·¡¢Apache¤Î¥â¥¸¥å¡¼¥ë¤ËÃÖ´¹¤µ¤»¤Þ¤·¤¿¤¬
PHP¤Î¥½¡¼¥¹¤ÏÊÑ¤ï¤Ã¤Æ¤ª¤ê¤Þ¤»¤ó¡£

¸½ºß¤Î´Ä¶­
PostgreSQL 7.0.2 (gcc 2.7.2.3)
(postgresql-7.0.2-patched-20000820.tar.gz)
php-3.0.15-i18n-ja
apache_1.3.12+openssl-0.9.5a+ssl_1.40
¤ÇPostgreSQL¤òÍøÍÑÃæ¤Ç¤¹¡£
Linux 2.0.36

¿·µ¬ÍøÍÑ¤Ç¤Ï¤Ê¤¯¡¢°ÊÁ°¤Î¥Ð¡¼¥¸¥ç¥ó¤ÎPostgreSQL6.5.3¤Ç
ÍøÍÑÃæ¤Î´ÉÍý¥ß¥¹¤Ç°Û¾ï¤Ê¾õ¶·¤È¤Ê¤Ã¤¿¤¿¤á¤Ë
PostgreSQL¤Î¤ß¤òºÇ¿·ÈÇ¤Ë¥¢¥Ã¥×¥°¥ì¡¼¥É¤·¡¢
¥Ç¡¼¥¿¡¼¥Ù¡¼¥¹¾ðÊó¤Ïpg_dump¤Ç¤Ï¤Ê¤¯
psql ¤Î copy ¤Î WITH OIDS ¥ª¥×¥·¥ç¥óÉÕ¤­¤Ç¥À¥ó¥×¤·¡¢
7.0.2¤Ë¤·¤Æ¤«¤é¡¢OID ¹þ¤ß¤ÇÉü¸µ¤·¤Þ¤·¤¿¡£
(pg_dump -o ¤ÇOIDÉÕ¤­¤Ç½ÐÎÏ¤·¡¢psql -f ¤Ç
ÆÉ¤ß¹þ¤ó¤Ç¤â OID ¤òÉü¸µ¤·¤Ê¤«¤Ã¤¿ÍýÍ³¤â¤¢¤ê¤Þ¤¹¡¦¡¦¡¦¡Ë
¡Ö¤Ê¤¼ OID ¤òÉü¸µ¤¹¤ë¤Î¤«¡©¡ª¡×¤Èµ¿Ìä¤Î¥á¡¼¥ë¤¬
Íè¤½¤¦¤Ç¤¹¤¬¡¢ÆÈ¼«¤ÎÈ½ÃÇ¤ÇOID¤òÄ¾ÀÜ»²¾È¤¹¤ë¥·¥¹¥Æ¥à¤È¤·¤Æ
PHP¤Ç³«È¯¤ò¿Ê¤á¤Æ¤ª¤ê¤Þ¤¹¡£ËÜÀ¤Âå¤Î¥·¥¹¥Æ¥à¤òOracle¤Ê¤É
Â¾¤ÎSQL¤Ë°Ü¿¢Í½Äê¤¬¤Ê¤¤¤¿¤á¤È¡¢ÃÏÍý¥Ç¡¼¥¿¡¼¤Î°·¤¤¤Î
ÍøÍÑ¤Ë¤è¤ê¤Þ¤¹¡£

³Î¤«¤Ë¡ÖOID¤ÎÉü¸µ¤Ç¡¢OID¼«Æ°È¯À¸¥ë¡¼¥Á¥ó¤È¶¥¹ç¤·¤Ê¤¤
¤Î¤«¤Ê¡Á¡×¤Ê¤É¤È¹Í¤¨¤Ê¤¬¤éºî¶È¤ò¡ÖOID¤¬´°àú¤ËÉü¸µ¤Ç¤­¤¿¤«¡×
¤ò¥Á¥§¥Ã¥¯¤·¤Ê¤¬¤é°Ü¿¢ºî¶È¤ò¹Ô¤¤¤Þ¤·¤¿¡£

¤½¤·¤Æ¡¢PostgreSQL 6.5.3 ¤Ç´°àú¤ËÆ°ºî¤·¤Æ¤¤¤¿PHP¥¹¥¯¥ê¥×¥È¤¬
¤³¤È¤´¤È¤¯¥¨¥é¡¼¤òÅÇ¤­½Ð¤·¤Þ¤·¤¿¡£¡Ö¤¨¡Á¡ª¡¡¤¦¤½¤À¤í¡×¾õÂÖ¤Ç¤¹¡£

¤½¤³¤ÇÈ¯¸«¤Ç¤­¤¿¤Î¤¬¡¢¿·µ¬OID¤¬¤ä¤¿¤éÂç¤­¤ÊÉé¤Î¿ô»ú¤È¤Ê¤Ã¤Æ¤¤¤ë
ÅÀ¤Ç¤·¤¿¡£°ÊÁ°¤Î¥Ð¡¼¥¸¥ç¥ó¤Ç¤¢¤ë 6.5.3 »þÂå¤Ç¤ÏOID¤¬Á´¤Æ
Àµ¿ô¤Ç¤·¤¿¤Î¤Ç¡¢SELECT¹½Ê¸¤Ê¤É¤Î WHERE ¤Ç OID ¤òÆÃÄê¤¹¤ë¾ì¹ç¡¢
¥·¥ó¥°¥ë¥¯¥ª¡¼¥Æ¡¼¥·¥ç¥ó¤Ïºß¤Ã¤Æ¤âÌµ¤¯¤Æ¤â¥¨¥é¡¼¤Ë¤Ï¤Ê¤ê¤Þ¤»¤ó
¤Ç¤·¤¿¡£Îã¤¨¤Ð

$OID_ = 12345678;
$query = "select * from junk where oid = $OID_";

¤Ç¤â°Û¾ï¤Ç¤Ï¤Ê¤«¤Ã¤¿¤Î¤Ç¤¹¤¬¡¦¡¦¡¦Éé¤Î¿ô»ú¤È¤Ê¤Ã¤¿º£¤Ç¤Ï
É¬¤º¡Ö¡Ç¡×¥·¥ó¥°¥ë¥¯¥ª¡¼¥Æ¥¤¥·¥ç¥ó¤Ç°Ï¤Þ¤Ê¤¤¤È¥¨¥é¡¼¤Ë¤Ê¤é¤Ê¤¤¤Ç
»²¾ÈÉÔÇ½¤È¤Ê¤ê¤Þ¤¹¡£¤½¤³¤ÇÁ´¤Æ¤ÎPHP¥½¡¼¥¹¤òÊÔ½¸¤·¤Þ¤·¤¿¡£

¤Þ¤À¥¨¥é¡¼¤¬¤¢¤ê¤Þ¤·¤¿¡¢SELECT ¤Î DISTINCT ON ¤ËÂ³¤¯
¥Õ¥£¡¼¥ë¥É»ØÄê¤Ë¾®³ç¸Ì¤¬É¬¿Ü¤È¤Ê¤Ã¤¿¤³¤È¤Ç¤¹¡£6.5.3¤Ç¤Ï
¾¯³ç¸Ì¤¬Ìµ¤¯¤Æ¤â¥¨¥é¡¼¤Ç¤Ï¤¢¤ê¤Þ¤»¤ó¤Ç¤·¤¿¡£

¾¯¡¹Ã¦Àþ¤·¤Þ¤·¤¿¤¬¡¢ÌÜ²¼¡¢pg_getlastoid()¤Î¿¶¤ëÉñ¤¤¤ò
PHP¤Ê¤É¤Î¥½¥Õ¥È¤Ç¤´¤Þ¤«¤¹¥ë¡¼¥Á¥ó¤ò»×¤¤¤Ä¤«¤Ê¤¤¤Î¤Ç
ML¤Ë¥¢¥Ã¥×Ã×¤·¤Þ¤·¤¿¡£¤ß¤Ê¤µ¤ó¤Î¤ªÃÎ·Ã¤òÇÒ¼Ú¤·¤¿¤¤¤È
Â¸¤¸¤Þ¤¹¡£

¢¨ PostgreSQL 6.5.3 ¤«¤é postgreSQL 7.0.2 ¤Ø¤Î°Ü¿¢ºî¶È¤Ë
¡¡·¹Ãí¤·¤Æ¤ª¤ê¤Þ¤·¤¿¤Î¤Ç¡¢ML¤Î¥Á¥§¥Ã¥¯¤¬¤Ç¤­¤Æ¤ª¤ê¤Þ¤»¤ó¡£
¡¡²áµî¤Î¾®À¸¤ÎMLÈ¯¸À¤Ø¤ÎResponse¤Ø¤ÎÊÖÅú¤¬ÂÚ¤Ã¤Æ¤¤¤ë¾ì¹ç¤Ï
¡¡¶ÛµÞºî¶È¤À¤Ã¤¿¤¿¤á¤ÈÌÈ¤¸¤Æ¤¯¤À¤µ¤¤¤Þ¤»¡£

_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
     Yoshio Tokuda
_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00481" HREF="msg00481.html">[pgsql-jp 16867] Re: [pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</A></STRONG>
<UL><LI><EM>From:</EM> "Yoshio Tokuda"&lt;actords@zaqcad091da.zaq.ne.jp&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00453" HREF="msg00453.html">[pgsql-jp 16839] RE: 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</A></STRONG>
<UL><LI><EM>From:</EM> "Eiji Tokuya" &lt;tokuya@Mail.Sankyo-Unyu.co.jp&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00449" HREF="msg00449.html">[pgsql-jp 16835] Re: [pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</A></STRONG>
<UL><LI><EM>From:</EM> "Nobuyuki Harikawa" &lt;hari@hari.to&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00447.html">[pgsql-jp 16833] Re: ¥é¡¼¥¸¥ª¥Ö¥¸¥§¥¯¥È¤ò»È¤¤¤¿¤¤</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00449.html">[pgsql-jp 16835] Re: [pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00533.html">[pgsql-jp 16920] Re: PL/pgSQL¤Ë¤Ä¤¤¤Æ</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00449.html">[pgsql-jp 16835] Re: [pgsql-jp 16834] 7.0.2¤ÎinsertÄ¾¸å¤Îpg_getlastoid()¤ÇÀµ¿ô¤Ë¤Ê¤Ã¤Æ¤·¤Þ¤¦Ææ</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00448"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00448"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
