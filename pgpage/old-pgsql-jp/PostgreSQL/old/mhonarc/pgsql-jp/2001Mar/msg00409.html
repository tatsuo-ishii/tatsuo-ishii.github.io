<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 20544] Re: select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò1¹Ô¤ËÉ½¼¨¤·¤¿¤¤ -->
<!--X-From: "Kawai,Takanori" <GCD00051@nifty.ne.jp> -->
<!--X-Date: Thu, 29 Mar 2001 12:07:46 +0900 -->
<!--X-Message-Id: 001a01c0b7fd$71bd3c90$0a00a8c0@nifty.ne.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 20010328213826.E1930551.toshi@ottot.to -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 20544] Re: select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò1¹Ô¤ËÉ½¼¨¤·¤¿¤¤ </TITLE>
<LINK REV="made" HREF="mailto:GCD00051@nifty.ne.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00408.html">Date Prev</A>][<A HREF="msg00410.html">Date Next</A>][<A HREF="msg00404.html">Thread Prev</A>][<A HREF="msg00403.html">Thread Next</A>][<A HREF="index.html#00409">Date Index</A>][<A HREF="threads.html#00409">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 20544] Re: select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò1¹Ô¤ËÉ½¼¨¤·¤¿¤¤</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: "Kawai,Takanori" &lt;<A HREF="mailto:GCD00051@nifty.ne.jp">GCD00051@nifty.ne.jp</A>&gt;</LI>
<LI><em>Date</em>: Thu, 29 Mar 2001 12:07:46 +0900</LI>
<LI><em>References</em>: &lt;<A HREF="msg00404.html">20010328213826.E1930551.toshi@ottot.to</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Àî¹ç¹§Åµ¤Ç¤¹¡£
¥¹¥¯¥ê¥×¥ÈÎã¤¬¤¢¤ëÊ¬¡¢Ä¹Ê¸¤Ë¤Ê¤Ã¤Æ¤¤¤Þ¤¹¡£
PostgreSQL¤È¤¤¤¦¤è¤ê¤ÏÃ±¤Ê¤ë¥×¥í¥°¥é¥ß¥ó¥°¤ÎÏÃ¤À¤È»×¤¤¤Þ¤¹¤¬¡£

----- Original Message -----
From: "Toshiaki Okuda" &lt;toshi@ottot.to&gt;
To: &lt;pgsql-jp@sra.co.jp&gt;
Sent: Wednesday, March 28, 2001 9:38 PM
Subject: [pgsql-jp 20539] select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò 1¹Ô¤ËÉ½¼¨¤·¤¿¤¤


&gt; ¤³¤ó¤Ë¤Á¤Ï¡¢¤ª¤¯¤À¤È¤â¤¦¤·¤Þ¤¹¡£
¡ÊÃæÎ¬¡Ë
&gt; ¤³¤Î¥Ç¡¼¥¿¤«¤é¡¢
&gt; uid, flag1, flag2, flag3, ... ¤È¤¤¤¦·Á¤Ç½ÐÎÏ¤ò¤·¤¿¤¤¤È
&gt; ¹Í¤¨¤Æ¤¤¤Þ¤¹¡£
&gt; flag1, flag2, flag3, ...¤Ï¡¢m_dlv¤Îflag¤Ç¡¢Æ±°ì¤Îuid¤Îflag¤ò
&gt; 1¹Ô¤Ë¤Ê¤é¤Ù¤ÆÉ½¼¨¤·¤¿¤¤¤Î¤Ç¤¹¡£
¡Ê°Ê²¼Î¬¡Ë
¸µ¤Î¤Ë¼ê¤ò½Ð¤½¤¦¤È¤·¤Þ¤·¤¿¤¬¡¢ÆÉ¤à¤Î¤¬ÌÌÅÝ¤Ê¤Î¤Ç
¡ôuse strict¤Ç°ú¤Ã¤«¤«¤ë¤è¤¦¤Ê¥½¡¼¥¹¤ÏÆÉ¤ß¤Ë¤¯¤¯¤Ã¤Æ

¤È¤ê¤¢¤¨¤ºDBI+DBD::Pg¤ÈPg¤Ë¤è¤ëÎã¤Ç¤¹¡£¤É¤Á¤é¤âÆ±¤¸·ë²Ì¤¬¤Ç¤Þ¤¹¡£
°ã¤¤¤ÏDBI¤Î¤Û¤¦¤¬¥¨¥é¡¼½èÍý¤ò¤«¤Ã¤Á¤ê¤·¤Æ¤ë¤È¤¤¤¦¤¯¤é¤¤¤«¤Ê¡£
¡ôbind_columns¤¬¤·¤¿¤«¤Ã¤¿¤À¤±¤È¤¤¤¦ÏÃ¤â¤¢¤ê

¤Þ¤¿mid¤Ç¤­¤Á¤ó¤ÈÊ¬¤±¤¿¤¤¾ì¹ç¤Ë¤Ï¡¢push¤ÎÂå¤ï¤ê¤ËÂÐ±þ¤¹¤ë¾ì½ê¤Ë
Æþ¤ì¤Æ¤¢¤²¤ëÉ¬Í×¤¬¤¢¤ë¤Ç¤·¤ç¤¦¡£

[´Ä¶­]
-TurboLinux 6.0Workstation
-PostgresSQL 7.02
-Perl 5.00503 + DBI 1.04 + DBD::Pg 0.95 + Pg 1.90

[DBI¤Ë¤è¤ëÎã]
use strict;
use DBI;
my $hDb;
my $hSt;
eval {
        $hDb = DBI-&gt;connect('dbi:Pg:dbname=gotdate', 'scott', 'tiger',
              {AutoCommit=&gt;0, RaiseError=&gt;1});
        $hSt = $hDb-&gt;prepare(
        q{
                select m_user.uid, m_dlv.mid, m_dlv.flag
                from m_user, m_dlv
                where m_user.uid = m_dlv.uid
                order by m_user.uid, m_dlv.mid;
        }
        );
        $hSt-&gt;execute();
        my($iUid, $iMid, $bFlg);
        $hSt-&gt;bind_columns(\$iUid, \$iMid, \$bFlg);
        my $iCurID;
        my @aCurInfo;
        while(my $raRow = $hSt-&gt;fetchrow_arrayref()){
                if((!defined($iCurID)) || ($iCurID != $iUid)) {
                        print "$iCurID,", join(',', @aCurInfo), "\n"
                                if(defined($iCurID));
                        @aCurInfo = ();
                        $iCurID = $iUid;
                }
                push(@aCurInfo, (($bFlg)? 't': 'f'));
        }
        print "$iCurID,", join(',', @aCurInfo), "\n"
                                if(defined($iCurID));
        $hSt-&gt;finish;
        $hDb-&gt;disconnect;
};
if($@) {
    print STDERR "Error Occurs: $@\n";
        $hSt-&gt;finish if($hSt);
        $hDb-&gt;disconnect if($hDb);
}

[Pg¤Ë¤è¤ë¥¹¥¯¥ê¥×¥ÈÎã]
use strict;
use Pg;
#ÀÜÂ³
my $oConn = Pg::connectdb("dbname=gotdate user=scott password=tiger");
        die $oConn-&gt;errorMessage if($oConn-&gt;errorMessage);
my $oResult = $oConn-&gt;exec(
        q{
                select m_user.uid, m_dlv.mid, m_dlv.flag
                from m_user, m_dlv
                where m_user.uid = m_dlv.uid
                order by m_user.uid, m_dlv.mid;
        });
my $iCurID;
my @aCurInfo;
while(my @aRes = $oResult-&gt;fetchrow) {
        if(!defined($iCurID) ||($iCurID != $aRes[0])) {
                print "$iCurID,", join(',', @aCurInfo), "\n"
                        if(defined($iCurID));
                @aCurInfo = ();
                $iCurID = $aRes[0];
        }
        push @aCurInfo, $aRes[2];
}
print "$iCurID,", join(',', @aCurInfo), "\n"
                                if(defined($iCurID));

[¥Æ¥¹¥È¥Ç¡¼¥¿]
gotdate=&gt; select m_user.uid, m_dlv.mid, m_dlv.flag
gotdate-&gt;                 from m_user, m_dlv
gotdate-&gt;                 where m_user.uid = m_dlv.uid
gotdate-&gt;                 order by m_user.uid, m_dlv.mid;
 uid | mid | flag
-----+-----+------
   2 |   2 | t
   2 |   3 | f
   2 |   4 | t
   2 |   5 | t
   3 |   1 | f
   3 |   2 | f
   3 |   4 | f
   3 |   5 | t
   3 |   6 | f
   4 |   1 | f
   4 |   4 | f
   4 |   5 | f
   4 |   6 | f

[¼Â¹Ô·ë²Ì]
[kawait@lins test]$ perl -w tpg4.pl
2,t,f,t,t
3,f,f,f,t,f
4,f,f,f,f

==============================================
Àî¹ç ¹§Åµ (Hippo2000)
   kwitknr@cpan.org GCD00051@nifty.ne.jp
   <A HREF="http://member.nifty.ne.jp/hippo2000">http://member.nifty.ne.jp/hippo2000</A>
    DBIÆüËÜ¸ì¥á¡¼¥ê¥ó¥°¥ê¥¹¥È´ÉÍý¿Í¡¢ Kansai.pm½êÂ°
==============================================
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00404" HREF="msg00404.html">[pgsql-jp 20539] select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò1¹Ô¤ËÉ½¼¨¤·¤¿¤¤</A></STRONG>
<UL><LI><EM>From:</EM> Toshiaki Okuda &lt;toshi@ottot.to&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00408.html">[pgsql-jp 20543] Re: Ver 6.5.3 ÆüËÜ¸ì¤Î¸¡º÷¤¬Àµ¤·¤¯¤Ç¤­¤Þ¤»¤ó</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00410.html">[pgsql-jp 20545] Need tiny postgreSQL</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00404.html">[pgsql-jp 20539] select ¤ÇÊ£¿ô¤Î¥ì¥³¡¼¥É¤Î¥«¥é¥à¤ò1¹Ô¤ËÉ½¼¨¤·¤¿¤¤</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00403.html">[pgsql-jp 20538] Re: pg_dump ¤È datetime·¿¤ÎÀºÅÙ	(J</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00409"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00409"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
