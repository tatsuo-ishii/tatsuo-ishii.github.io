<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 13344] ODBCでunionコマンドを実行すると？ -->
<!--X-From: "Kazuya Yamauchi" <cqn05507@nifty.ne.jp> -->
<!--X-Date: Fri, 3 Mar 2000 13:50:20 +0900 -->
<!--X-Message-Id: 002f01bf84cb$fbd60d00$1e00a8c0@kdc3595ws -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 00bc01bf84bd$4f00c880$ee5017ac@is.osk.enicom.co.jp -->
<!--X-Reference-Id: 200003030414.AA00166@lachesis.jtp.co.jp -->
<!--X-Reference-Id: 013f01bf84ca$9491b320$ee5017ac@is.osk.enicom.co.jp -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 13344] ODBCでunionコマンドを実行すると？ </TITLE>
<LINK REV="made" HREF="mailto:cqn05507@nifty.ne.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00054.html">Date Prev</A>][<A HREF="msg00056.html">Date Next</A>][<A HREF="msg00054.html">Thread Prev</A>][<A HREF="msg00057.html">Thread Next</A>][<A HREF="index.html#00055">Date Index</A>][<A HREF="threads.html#00055">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 13344] ODBCでunionコマンドを実行すると？</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: "Kazuya Yamauchi" &lt;<A HREF="mailto:cqn05507@nifty.ne.jp">cqn05507@nifty.ne.jp</A>&gt;</LI>
<LI><em>Date</em>: Fri, 3 Mar 2000 13:50:20 +0900</LI>
<LI><em>References</em>: &lt;<A HREF="msg00051.html">00bc01bf84bd$4f00c880$ee5017ac@is.osk.enicom.co.jp</A>&gt; &lt;<A HREF="msg00052.html">200003030414.AA00166@lachesis.jtp.co.jp</A>&gt; &lt;<A HREF="msg00054.html">013f01bf84ca$9491b320$ee5017ac@is.osk.enicom.co.jp</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
こんにちは！　山内 一也です(^o^)/

以下のコマンドをpsqlで実行した場合と
ODBC(VB+ADO)で実行した場合と結果が違います。

PSQLでは、値の内容がすべて表示されるのに対して、
ODBCでは、selectで最初に宣言した型(ここでは"f1"）
のサイズが適用され、t2のg1,g2の値が切れてしまいます。
これは仕様なのでしょうか？
f1::text as f1と明示宣言しても同じでした。(^^;

    ＶＢで、
    stSql = "select f1,f2 from t1 union select g1,g2 from t2"
    Rs.Open stSql, c_ADOConect, adOpenForwardOnly, adLockReadOnly
    Do Until Rs.EOF
        Debug.Print Rs.Fields(0),Rs.Fields(0)
        Rs.MoveNext
    Loop
    とすると、値の内容が切れています。


■対象テーブル
create table t1 (
     f1    varchar(2)
    ,f2    varchar(4)
    );

create table t2 (
     g1    varchar(3)
    ,g2    varchar(6)
    );

insert into t1 values ('10','AAAA');
insert into t1 values ('20','BBBB');

insert into t2 values ('100','CCCCCC');
insert into t2 values ('200','DDDDDD');

■コマンド
select f1,f2 from t1 union select g1,g2 from t2;


どなたかアドバイス頂けると助かります。

 _/_/_/            03-March-2000(Fri) PM01:49 _/_/_/
_/_/_/ CQN05507@nifty.ne.jp    山内  一也       _/_/_/
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00051" HREF="msg00051.html">[pgsql-jp 13340] Re: [pgsql-jp 13339] ApacheとPostgreSQLを別サーバで</A></STRONG>
<UL><LI><EM>From:</EM> 小西賢一&lt;zkoni@is.osk.enicom.co.jp&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00052" HREF="msg00052.html">[pgsql-jp 13341] Re: ApacheとPostgreSQLを別サーバで</A></STRONG>
<UL><LI><EM>From:</EM> go@jtp.co.jp</LI></UL></LI>
<LI><STRONG><A NAME="00054" HREF="msg00054.html">[pgsql-jp 13343] Re: [pgsql-jp 13341] Re: ApacheとPostgreSQLを別サーバで</A></STRONG>
<UL><LI><EM>From:</EM> 小西賢一&lt;zkoni@is.osk.enicom.co.jp&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00054.html">[pgsql-jp 13343] Re: [pgsql-jp 13341] Re: ApacheとPostgreSQLを別サーバで</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00056.html">[pgsql-jp 13345] Re: "Backend sent D message withcout priorT"はなぜ</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00054.html">[pgsql-jp 13343] Re: [pgsql-jp 13341] Re: ApacheとPostgreSQLを別サーバで</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00057.html">[pgsql-jp 13346] Re: ApacheとPostgreSQLを別サーバで</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00055"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00055"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
