<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 3366] Re:input a lot of data -->
<!--X-From: Toru Aiba <taiba@ca2.so&#45;net.or.jp> -->
<!--X-Date: Tue, 17 Feb 1998 09:10:04 &#45;0600 -->
<!--X-Message-Id: 34E9A84C.311702E3@ca2.so&#45;net.or.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 19980217153721Q.uesaka@mk.ecei.tohoku.ac.jp -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 3366] Re:input a lot of data </TITLE>
<LINK REV="made" HREF="mailto:taiba@ca2.so-net.or.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00056.html">Date Prev</A>][<A HREF="msg00058.html">Date Next</A>][<A HREF="msg00050.html">Thread Prev</A>][<A HREF="msg00060.html">Thread Next</A>][<A HREF="index.html#00057">Date Index</A>][<A HREF="threads.html#00057">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 3366] Re:input a lot of data</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: Toru Aiba &lt;<A HREF="mailto:taiba@ca2.so-net.or.jp">taiba@ca2.so-net.or.jp</A>&gt;</LI>
<LI><em>Date</em>: Tue, 17 Feb 1998 09:10:04 -0600</LI>
<LI><em>Organization</em>: TCK</LI>
<LI><em>References</em>: &lt;<A HREF="msg00050.html">19980217153721Q.uesaka@mk.ecei.tohoku.ac.jp</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
相場＠ＴＣＫです。

出張中なもので今手元に触れる機械が無く、記憶を頼りに書いていますが...。
ソースを調べたわけではありませんが感覚的には明示的にトランザクションの開
始とコミットを宣言してあげないかぎり、各タプルごとに write() しているみ
たいですね。（識者の方間違っていたらご指摘ください）トランザクションの中
で INSERT をまわすことでかなりパフォーマンスを改善できた経験があります。
ただコミットをかけるまでに何回の INSERT ができるかはタプルのサイズ等によ
りますので、try &amp; error で探してみてください。


Kazuyoshi UESAKA wrote:
&gt; 
&gt; 上坂＠東北大です.
&gt; みなさんはたくさんのデータの入力はどのように行っているのでしょ
&gt; うか.
&gt; 
&gt; 今, 私が入力しようとしているデータは, 一度 Perl で処理を処理
&gt; をする必要があります. せっかく Perl を使っているのだからと思
&gt; い, Pg パッケージをインストールして, 1つのデータごとに
&gt; insert 命令を作成して $conn-&gt;exec($query); で入力を試みまし
&gt; た. ここで,  $conn = Pg::connectdb("dbname = mydb"); であり,
&gt; $query は insert 命令です.
&gt; 
&gt; Sun SPARCStation IPX でこのスクリvトを動かしたところ, 1日たっ
&gt; ても入力は終わりませんでした. (丸1日HDDを動かしたのでいい耐
&gt; 久テストとなりました(^^;)) データ数は約60万個です.
&gt; 
&gt; 60万回の open と close を繰り返しているわけなので, 終わらな
&gt; いのは当然です. そこで, 他の方法はないかと考えています.
&gt; 
&gt; そこで, 一旦 tmp file を作って, copy コマンドを使うのが現実
&gt; 的かなと思っているのですが, tmp fileが巨大になってしまいます.
&gt; データをある程度の量でブロック化して, 1万個ごとに copy を使
&gt; う方法でもいいのではとも考えています.
&gt; 
&gt; 他に何かいい方法はないでしょうか.
&gt; 
&gt; &gt; (Kazuyoshi UESAKA)

-- 
Toru Aiba   taiba@ca2.so-net.or.jp
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00050" HREF="msg00050.html">[pgsql-jp 3359] input a lot of data</A></STRONG>
<UL><LI><EM>From:</EM> Kazuyoshi UESAKA &lt;uesaka@mk.ecei.tohoku.ac.jp&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00056.html">[pgsql-jp 3365] Re: [QUESTIONS] Important Announcement</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00058.html">[pgsql-jp 3367] Re: input a lot of data(&amp;self-introduction)</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00050.html">[pgsql-jp 3359] input a lot of data</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00060.html">[pgsql-jp 3369] Re: input a lot of data</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00057"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00057"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
