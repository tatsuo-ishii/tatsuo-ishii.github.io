<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 22475] Re: エクセルデータをきれいにpostgres のテーブルに変換するには？ -->
<!--X-From: uran <uran@he.mirai.ne.jp> -->
<!--X-Date: Thu, 19 Jul 2001 16:28:14 +0900 -->
<!--X-Message-Id: 20010719161110.5723.URAN@he.mirai.ne.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 20010719134224.983D.YOKOI@cti.co.jp -->
<!--X-Reference-Id: OJEEKIJNKMMGJJOEDNICIEBJCHAA.tanaka&#45;tec@masecon.co.jp -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 22475] Re: エクセルデータをきれいにpostgres のテーブルに変換す </TITLE>
<LINK REV="made" HREF="mailto:uran@he.mirai.ne.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00339.html">Date Prev</A>][<A HREF="msg00341.html">Date Next</A>][<A HREF="msg00336.html">Thread Prev</A>][<A HREF="msg00343.html">Thread Next</A>][<A HREF="index.html#00340">Date Index</A>][<A HREF="threads.html#00340">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 22475] Re: エクセルデータをきれいにpostgres のテーブルに変換するには？</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: uran &lt;<A HREF="mailto:uran@he.mirai.ne.jp">uran@he.mirai.ne.jp</A>&gt;</LI>
<LI><em>Date</em>: Thu, 19 Jul 2001 16:28:14 +0900</LI>
<LI><em>References</em>: &lt;<A HREF="msg00328.html">20010719134224.983D.YOKOI@cti.co.jp</A>&gt; &lt;<A HREF="msg00336.html">OJEEKIJNKMMGJJOEDNICIEBJCHAA.tanaka-tec@masecon.co.jp</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
On Thu, 19 Jul 2001 15:49:38 +0900
"Kiyohito Tanaka" &lt;tanaka-tec@masecon.co.jp&gt; wrote:

&gt; 田中@MCです。

 uranといいます。

&gt; 要望としては、
&gt; エクセルのセル内での改行はpostgresへ持ってきても、表現のテク
&gt; としてそのまま改行させたいですし、かといって、完全にそれらの
&gt; コードが変換できなければ文字化けとなってしまう。文字化けは
&gt; 絶対に許されない・・・。
&gt; というような話です。

&gt; すみませんが、ポイントありますでしょうか？

　ポイントは次のようです。

　次のようなルールでPerlかCなどでフィルタのプログラムを作れば
解決できます。postgresが書ければ、朝飯前でしょう(笑)

(1)"は削除するが、"を監視する。(注)
(2)コード'OA'が来た時は、直前に'0D'があれば、UNIX改行コード'0A'を
　出力する。単独の'0A'が来た時は、それはセル内改行なので、適切な
　文字（￥など）に変換して、出力する。

(注)"が連続して来た時は、"文字自身なので、"を出力する。という
　　　処理を入れなければなりません。

＃昔、エクセルのCSVデータを取り込むという処理が必要だった時
＃同様に悩みましたが、結局Cで作りました、大体、上のような
＃仕様で変換しました。それにしても、セル内改行（Alt+Enter）
＃には泣かされました。実際、知らんかった(笑)

　　　　　　　　　　　　　　　　　　　　　　プログラマ　uran

＃時間があれば、作れるけど、明日、納期(笑)の仕事があるので、
＃今はダメです。
------------------------------------------------------------
|__| |~~~ /::| |~~| <A HREF="mailto:uran@be.to">mailto:uran@be.to</A>
浦野雅弘            <A HREF="mailto:uran@he.mirai.ne.jp">mailto:uran@he.mirai.ne.jp</A>
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00328" HREF="msg00328.html">[pgsql-jp 22463] Re: エクセルデータをきれいにpostgresのテーブルに変換するには？</A></STRONG>
<UL><LI><EM>From:</EM> yokoi &lt;yokoi@cti.co.jp&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00336" HREF="msg00336.html">[pgsql-jp 22471] RE: エクセルデータをきれいにpostgres のテーブルに変換するには？</A></STRONG>
<UL><LI><EM>From:</EM> "Kiyohito Tanaka" &lt;tanaka-tec@masecon.co.jp&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00339.html">[pgsql-jp 22474] Re: posgreSQL with cobalt raq4</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00341.html">[pgsql-jp 22476] Re: text 型に対するoctet_length()について</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00336.html">[pgsql-jp 22471] RE: エクセルデータをきれいにpostgres のテーブルに変換するには？</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00343.html">[pgsql-jp 22478] RE: エクセルデータをきれいにpostgresのテーブルに変換するには？</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00340"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00340"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
