<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 22688] Re: OID ¤¬2^31¤òÄ¶¤¨¤¿¥Æ¡¼¥Ö¥ë¤Ø¤ÎCREATE RULE ¤¬¼ºÇÔ¤¹¤ë -->
<!--X-From: yosimura@pez.semicon.sony.co.jp (YOSHIMURA hideaki) -->
<!--X-Date: Wed, 1 Aug 2001 20:18:30 +0900 -->
<!--X-Message-Id: 200108011118.UAA26726@pezplus.pez.semicon.sony.co.jp -->
<!--X-ContentType: text/plain -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 22688] Re: OID ¤¬2^31¤òÄ¶¤¨¤¿¥Æ¡¼¥Ö¥ë¤Ø¤ÎCREATE RULE ¤¬¼ºÇÔ¤¹¤ </TITLE>
<LINK REV="made" HREF="mailto:yosimura@pez.semicon.sony.co.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00024.html">Date Prev</A>][<A HREF="msg00026.html">Date Next</A>][<A HREF="msg00027.html">Thread Prev</A>][<A HREF="msg00015.html">Thread Next</A>][<A HREF="index.html#00025">Date Index</A>][<A HREF="threads.html#00025">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 22688] Re: OID ¤¬2^31¤òÄ¶¤¨¤¿¥Æ¡¼¥Ö¥ë¤Ø¤ÎCREATE RULE ¤¬¼ºÇÔ¤¹¤ë</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: <A HREF="mailto:yosimura@pez.semicon.sony.co.jp">yosimura@pez.semicon.sony.co.jp</A> (YOSHIMURA hideaki)</LI>
<LI><em>Date</em>: Wed, 1 Aug 2001 20:18:30 +0900</LI>
<LI><em>Cc</em>: <A HREF="mailto:yosimura@pez.semicon.sony.co.jp">yosimura@pez.semicon.sony.co.jp</A> (YOSHIMURA hideaki)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
¤è¤·¤à¤é¡÷¥½¥Ë¡¼¤Ç¤¹¡£

At 13:31 2001/08/01 +0900, Tatsuo Ishii wrote:
&gt;¤È¤ê¤¢¤¨¤º access/transam/xlog.c ¤¢¤¿¤ê¤«¤é¸«¤Æ¤ß¤Æ¤Ï¤É¤¦¤Ç¤·¤ç¤¦¡¥

ÆÉ¤ó¤Ç¤ß¤Þ¤·¤¿¡£StartupXLOG()¤¢¤¿¤ê¤Ç¤¹¤«¡£
¤¿¤·¤«¤Ë¡¢ControlFile¤«¤é¤Ï¥Ý¥¤¥ó¥¿¤À¤±¤ò¼è¤ê½Ð¤·¤Æ¡¢¼ÂºÝ¤Îcheckpoint¤Ï
¥í¥°¤«¤éÆÉ¤ó¤Ç¤Þ¤¹¤Í¡£
¤³¤ÎcheckPointCopy¤ÏËÜÅö¤Ë¤¿¤À¤Î¥³¥Ô¡¼¤Ê¤Î¤Ç¤¹¤Í¡£

¤³¤ÎÊý¸þ¤«¤é¤Î¥¢¥×¥í¡¼¥Á¤Ï¤Á¤ç¤Ã¤ÈÆñ¤·¤½¤¦¤Ê¤Î¤Ç¡¢¹Í¤¨Êý¤òÊÑ¤¨¤Æ¡¢¼¡¤Î
¤è¤¦¤Ë¤·¤Æ¤ß¤Þ¤·¤¿¡£

1. src/backend/access/transam/varsup.c ¤ÎGetNewObjectId()¤Ç¡¢oid¤ÎÁýÊ¬¤ò
¡¡Âç¤­¤¯¤·¤Æmake¤¹¤ë
2. make check ¤ò¹Ô¤Ê¤Ã¤Æ¡¢OID¤¬¿Ê¤ó¤À¾õÂÖ¤ÎDB¥¯¥é¥¹¥¿¤òÆÀ¤ë
3. ¸µ¤ËÌá¤¹
4. regression¥Æ¥¹¥È¤Ë»ÈÍÑ¤·¤¿DB¥¯¥é¥¹¥¿¤ò»ØÄê¤·¤Æpostmaster¤òÎ©¤Á¾å¤²¤ë
5. make runtest µÚ¤Ó pg_dump ¤Ç¥Æ¥¹¥È

¤³¤ÎÊýË¡¤ÇOID¤ò41²¯ÄøÅÙ¤Ë¿Ê¤á¤Æ¥Æ¥¹¥È¤·¤Æ¤ß¤¿¤È¤³¤í¡¢regression¤Ïopr_sanity
(¤Èabstime)¤Ç¥¨¥é¡¼¤Ë¤Ê¤Ã¤¿¤À¤±¤Ç¤·¤¿¡£
opr_sanity¤Ïinitdb»þ¤ËºîÀ®¤µ¤ì¤ë´Ø¿ô¤Îoid¤òÁÛÄê¤·¤Æ¤¤¤ë¤È¤³¤í¤¬¤¢¤ë¤¿¤á¤Ë
»ÅÊý¤Ê¤¤¤è¤¦¤Ç¤¹¡£

pg_dump¤ÎÊý¤Ïoid¤Ø¤Î¥­¥ã¥¹¥ÈËº¤ì(?)¤é¤·¤¤¤È¤³¤í¤¬3²Õ½ê¤¢¤ê¤Þ¤·¤¿¤¬¡¢
½¤Àµ¤·¤ÆOK¤Ç¤·¤¿¡£
¡ô¤³¤¦¤¤¤¦¾ì¹ç¥­¥ã¥¹¥È¤ÏÉ¬Í×¤Ê¤ó¤Ç¤·¤¿¤Ç¤·¤ç¤¦¤«¡©»ÅÍÍ¤Î¾å¤Ç¤Ï¡£

¡ô¤¢¤È¡¢-o¥ª¥×¥·¥ç¥ó¤òÉÕ¤±¤¿¤È¤­¤Ëºî¤é¤ì¤ë°ì»þÉ½pgdump_oid¤Ïint4¤Î¤Þ¤Þ¤Ç
¡ô¤¤¤¤¤Î¤«¤É¤¦¤«...¡©-o¤Ï»È¤¦Í½Äê¤¬¤Ê¤¤¤Î¤Ç¾Ü¤·¤¯¤ÏÄ´¤Ù¤Þ¤»¤ó¤¬¡£

pg_restore¤Ê¤ÉÂ¾¤Î¥Ä¡¼¥ë¤Ï¤Þ¤À¥Æ¥¹¥È¤·¤Æ¤¤¤Þ¤»¤ó¤¬¡¢¤³¤ì¤Ê¤éÂç¾æÉ×¤½¤¦¤Ç¤¹¡£
¤½¤í¤½¤í7.1·Ï¤Ø¤Î°Ü¹Ô¤ò¿¿·õ¤Ë¹Í¤¨¤è¤¦¤È»×¤¤¤Þ¤¹¡£

¤¿¤À¡¢¤ä¤Ï¤ê64bitOID¤ÏÁá¤á¤Ë¼Â¸½¤·¤Æ¤Û¤·¤¤¤È¤³¤í¤Ç¤¹¤¬¡£

*** pg_dump/pg_dump.c   Sun May 13 08:36:44 2001
--- pg_dump.mod/pg_dump.c       Wed Aug  1 19:11:51 2001
***************
*** 2267,2273 ****

                        resetPQExpBuffer(query);
                        appendPQExpBuffer(query,
!                                                         "SELECT Oid FROM pg_index i WHERE i.indisprimary AND i.indrelid = %s ",
                                                          tblinfo[i].oid);
                        res2 = PQexec(g_conn, query-&gt;data);
                        if (!res2 || PQresultStatus(res2) != PGRES_TUPLES_OK)
--- 2267,2273 ----

                        resetPQExpBuffer(query);
                        appendPQExpBuffer(query,
!                                                         "SELECT Oid FROM pg_index i WHERE i.indisprimary AND i.indrelid = %s::oid ",
                                                          tblinfo[i].oid);
                        res2 = PQexec(g_conn, query-&gt;data);
                        if (!res2 || PQresultStatus(res2) != PGRES_TUPLES_OK)
***************
*** 3012,3017 ****
--- 3012,3018 ----
        query = createPQExpBuffer();
        appendPQExpBuffer(query, "SELECT description FROM pg_description WHERE objoid = ");
        appendPQExpBuffer(query, oid);
+       appendPQExpBuffer(query, "::oid");

        /*** Execute query ***/

***************
*** 3351,3357 ****

        /* becomeUser(fout, finfo[i].usename); */

!       sprintf(query, "SELECT lanname FROM pg_language WHERE oid = %u",
                        finfo[i].lang);
        res = PQexec(g_conn, query);
        if (!res ||
--- 3352,3358 ----

        /* becomeUser(fout, finfo[i].usename); */

!       sprintf(query, "SELECT lanname FROM pg_language WHERE oid = %u::oid",
                        finfo[i].lang);
        res = PQexec(g_conn, query);
        if (!res ||

quit
-- 
YOSHIMURA,hideaki
¡Ö¥Ç¥¹¥Æ¥Í¥¤¤À¤è¡¢¤³¤ì¤â·¯¤Î¥Ç¥¹¥Æ¥Í¥¤¤À¡£¡×
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00024.html">[pgsql-jp 22687] RE: serial ÃÍ¤ò´Þ¤ó¤À¥Æ¡¼¥Ö¥ë¤Ë¥Ç¡¼¥¿¤ÎÄÉ²Ã¤¬¹Ô¤¨¤Ê¤¤</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00026.html">[pgsql-jp 22689] Re: Mac 	ÈÇFileMaker Pro 5.5¤ÇODBC ÀÜÂ³¤ò¤·¤¿¤¤¤Î¤Ç¤¹¤¬</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00027.html">[pgsql-jp 22690] Re: configure ¤Î¼Â¹Ô»þ¤Î¥¨¥é¡¼¤Ë´Ø¤·¤Æ</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00015.html">[pgsql-jp 22678] Re: OID ¤¬2^31¤òÄ¶¤¨¤¿¥Æ¡¼¥Ö¥ë¤Ø¤ÎCREATE RULE ¤¬¼ºÇÔ¤¹¤ë</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00025"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00025"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
