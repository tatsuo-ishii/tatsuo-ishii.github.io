<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 5002] Re: PostODBC+VB5+DAO -->
<!--X-From: kuniaki <kuniaki@vc&#45;net.or.jp> -->
<!--X-Date: Fri, 07 Aug 1998 23:30:59 +0900 -->
<!--X-Message-Id: 35CB0FA3.3DF3332A@vc&#45;net.or.jp -->
<!--X-ContentType: text/plain -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 5002] Re: PostODBC+VB5+DAO </TITLE>
<LINK REV="made" HREF="mailto:kuniaki@vc-net.or.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00070.html">Date Prev</A>][<A HREF="msg00072.html">Date Next</A>][<A HREF="msg00074.html">Thread Prev</A>][<A HREF="msg00070.html">Thread Next</A>][<A HREF="index.html#00071">Date Index</A>][<A HREF="threads.html#00071">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 5002] Re: PostODBC+VB5+DAO</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: kuniaki &lt;<A HREF="mailto:kuniaki@vc-net.or.jp">kuniaki@vc-net.or.jp</A>&gt;</LI>
<LI><em>Date</em>: Fri, 07 Aug 1998 23:30:59 +0900</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
三浦＠ＶＣです

Hiroshi Inoue wrote:
&gt; 
&gt; 井上＠セーレンです。
&gt; 
&gt; &gt;
&gt; &gt;
&gt; &gt; 三浦＠ＶＣです
&gt; &gt;
&gt; ［略］
&gt; &gt;
&gt; &gt; 私の所では（ＶＢ５ですが）
&gt; &gt;
&gt; &gt;     Set sqlODBC = CreateWorkspace("", "kuni", "", dbUseODBC)
&gt; &gt;     sqlODBC.DefaultCursorDriver = dbUseODBCCursor
&gt; &gt;     Set conSQL = sqlODBC.OpenConnection("ちょめちょめ", , , _
&gt; &gt;     "ODBC;DATABASE=なんだかんだ;UID=私;PWD=;DSN=postgreSQL")
&gt; &gt;
&gt; &gt;     sqltext = "SELECT あれや, これや FROM てーぶる"
&gt; &gt;     Set rstSQL = conSQL.OpenRecordset(sqltext)
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; てな感じで動かしています。
&gt; &gt;
&gt; 
&gt; この方式は DAOといいながら実はDAOをバイパスしてODBCを直接使用する
&gt; ODBCDirectという方式ですね。

はい、あまり余計なものは使いたくなかったもんで．．．

&gt; この方式で動作すればパフォーマンスがあがるのでよりベターだと思いますが
&gt; 何か問題は発生していないでしょうか？

特に問題はありません、と言ってもテスト段階（しかもほとんどシングル状態）
なのでこれから出るかもしれませんが。

&gt; 実は、当方でも(ODBCDirectではなく） RDOで同じような設定でテストを行い
&gt; なんとか動作するのは確認しましたが、次のような理由で二の足をふんでいます。
&gt; １）VC++のCRecordsetでは forwardOnly以外では動作しない。動作させようと
&gt;     ソースを少し調べてみたが、forwardOnly以外は正式にはサポートしていない
&gt;     ような感じがする。

ＶＢ５では dbOpenDynamic dbOpenDynaset dbOpenSnapshot が使えるようです。
ＶＣは使っていません

&gt; ２）Recordsetのオープン中 共有ロックがかかってしまい(Use declare/fetchオプ
&gt; ション
&gt;     使用時）、他からの更新ができない。

たしかにUse declare/fetchオプションを付けるとロックされますね。

#このメッセージはＰＯＳＴしたつもりなんですがメールが返ってきませんでし
たので
#再ＰＯＳＴします。
#２重ＰＯＳＴになっていましたらご容赦下さい。
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00070.html">[pgsql-jp 5001] Re: table create時のエラー</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00072.html">[pgsql-jp 5003] Re: PostODBC+VB5+DAO</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00074.html">[pgsql-jp 5005] Re: To an error using ORDER BY</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00070.html">[pgsql-jp 5001] Re: table create時のエラー</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00071"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00071"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
