<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 8223] Re: PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3 日本語パッチ -->
<!--X-From: Tatsuo Ishii <t&#45;ishii@sra.co.jp> -->
<!--X-Date: Wed, 28 Apr 1999 13:33:08 +0900 -->
<!--X-Message-Id: 199904280433.NAA11105@srapc451.sra.co.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 19990428115303R.sugiyama@is&#45;com1.tjsys.co.jp -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 8223] Re: PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3 日本語パ </TITLE>
<LINK REV="made" HREF="mailto:t-ishii@sra.co.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00413.html">Date Prev</A>][<A HREF="msg00415.html">Date Next</A>][<A HREF="msg00411.html">Thread Prev</A>][<A HREF="msg00433.html">Thread Next</A>][<A HREF="index.html#00414">Date Index</A>][<A HREF="threads.html#00414">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 8223] Re: PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3 日本語パッチ</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: Tatsuo Ishii &lt;<A HREF="mailto:t-ishii@sra.co.jp">t-ishii@sra.co.jp</A>&gt;</LI>
<LI><em>Date</em>: Wed, 28 Apr 1999 13:33:08 +0900</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
はじめまして。石井です。

&gt;はじめまして、本日よりMLに参加させて頂いた杉山と申します。
&gt;宜しくお願いします。
&gt;
&gt;私は、PostgreSQL 6.3.2よりお世話になっています。
&gt;というより 6.4.2にバージョンアップできずにいます。
&gt;
&gt;そこで早速ですが、質問させて頂きます。
&gt;
&gt;「PostgreSQL mailing list in Japan」にある「PostgreSQL 6.4.2+
&gt;Apache 1.3.4+PHP3.0.6+PHP3 日本語パッチ」
&gt;(URL:<A HREF="http://www.sra.co.jp/people/t-ishii/PostgreSQL/6.4/">http://www.sra.co.jp/people/t-ishii/PostgreSQL/6.4/</A>
&gt;     apache_1.3.4_php_jp.html)を参考にして 6.4.2にしようとして
&gt;いますが、PHP3コンパイルエラーもしくはApacheで実行時エラーに
&gt;なってしまいます。
&gt;
&gt;実行環境
&gt;1.Linux slackware 3.4 + PJE0.1
&gt;2.kernel version 2.0.36
&gt;3.libc 5.4.38
&gt;4.gcc 2.8.1(自宅にあるPC gcc 2.7.2.3でも同じ現象)
&gt;5.PostgreSQL 6.4.2(Btreeパッチ前後とも同じ現象)
&gt;6.PHP 3.0.6(上記ホームページにあるパッチ実施済み)
&gt;7.Apache 1.3.6(1.3.4でも同じ現象)
&gt;
&gt;現象
&gt;1.PHPのインストールの説明にある下記を行うとリンク時に「-lresolv」
&gt;  がない為、エラーになる。
&gt;  Linux の場合:
&gt;  APXS_LDFLAGS =  -L./regex -L/usr/local/pgsql/lib -lpq -lregex -lgdbm -lresolv
&gt;
&gt;2.上記の「-lresolv」を取ってコンパイルすると正常にリンクされるが、
&gt;  Apacheを実行時に「into Server error」でエラーになる。
&gt;
&gt;3.PostgreSQL 6.3.2のままで、上記の「-lresolv」を取ってコンパイルす
&gt;  ると正常にリンクされ、Apacheも正常に稼働する。
&gt;  現在は、PostgreSQL 6.4.2に上げられない為、この状態で稼働中。
&gt;
&gt;多分、res_searchに該当するライブラリ「-lresolv」に該当するライブラリ
&gt;が解れば良いのですが。

全く同じ質問に別MLで答えたので全文引用しておきます。
今日中には -lresolv は LinuxPPC しか必要ないのだよ、という注意書きを付
けます。どうも混乱させてごめんなさい。
# いまだにまともな x86/Linux 環境が手元にないので検証できてません。
---
t-ishii@sra.co.jp	石井達夫

---------------------------------------------------------------
To: PHP-jp@sidecar.ics.es.osaka-u.ac.jp
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
In-reply-to: Your message of Tue, 27 Apr 1999 21:38:57 +0900.
             &lt;199904271244.VAA21054@mail.adonet.co.jp&gt; 
Date: Wed, 28 Apr 1999 00:12:15 +0900
Reply-To: t-ishii@sra.co.jp
X-Distribute: distribute [version 2.1 (Alpha) patchlevel=24]
X-Sequence: PHP-jp 897
Subject: [PHP-jp 897] Re: make のパラメータ
Errors-To: owner-PHP-jp@sidecar.ics.es.osaka-u.ac.jp
Sender: owner-PHP-jp@sidecar.ics.es.osaka-u.ac.jp

石井です。

&gt; 田中＠アドです。

&gt; ＯＳはＬｉｎｕｘです。ディストリビューションは不明です。
&gt; ホスティングサービスのサーバーです。
&gt; 
&gt; php-3.0.7.tar.gz
&gt; php-3.0.7-kanji.pre5.patch.gz
&gt; regex.tar.gz　PHP-3.0.6用
&gt; 
&gt; インストールには、
&gt; 
&gt; <A HREF="http://www.sra.co.jp/people/t-ishii/PostgreSQL/6.4/apache_1.3.4_php_jp.html">http://www.sra.co.jp/people/t-ishii/PostgreSQL/6.4/apache_1.3.4_php_jp.html</A>
&gt; 
&gt; を参考にさせて頂いてます。
&gt; 
&gt; ここで、
&gt; 
&gt; &gt; Makefile の 53行目を以下のように修正します。 
&gt; &gt; 
&gt; &gt; Linux の場合:
&gt; &gt; APXS_LDFLAGS =  -L./regex -L/usr/local/pgsql/lib -lpq -lregex -lgdbm -lresolv
&gt; &gt; 
&gt; &gt; FreeBSD の場合:
&gt; &gt; APXS_LDFLAGS =  -L./regex -lregex -lm
&gt; &gt; 
&gt; &gt; Solaris2.6 の場合:
&gt; &gt; APXS_LDFLAGS = -L./regex -lregex -L/usr/local/lib -lgdbm -lresolv -lm
&gt; 
&gt; と有ったので、指定しました。

済みません。これは LinuxPPC の話で、おそらく x86/Linux では -lresolv 
は要りません。また php-3.0.7 ならこういう修正は必要ありません。

&gt; 実は、ここ数日ＰＨＰのmakeではまってます。
&gt; 以下は、-lresolv無しでmakeしたものです。

&gt; # /usr/local/apache/bin/apachectl configtest
&gt; Syntax error on line 202 of /usr/local/apache/conf/httpd.conf:
&gt; Cannot load /usr/local/apache/libexec/libphp3.so into server: File not found
&gt; 
&gt; と言ってきます。有るんですけどね。
&gt; で、お聞きしたわけです。

うーむ。良く聞かれるんですが、これはエラーメッセージが嘘なんです:-)
straceでシステムコールトレースやってみれば分かりますが、多分 libpq.so 
がロードできないのでしょう。apache を起動する前に、LD_LIBRARY_PATH に 
/usr/local/pgsql/lib をセットしてもう一度やってみて下さい。
それでも駄目なら

strace httpd configtest

の出力を見せて下さい。
---
Tatsuo Ishii

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00433" HREF="msg00433.html">[pgsql-jp 8242] Re: PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3日本語パッチ</A></STRONG>
<UL><LI><EM>From:</EM> Toshiaki Sugiyama &lt;sugiyama@tjsys.co.jp&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00411" HREF="msg00411.html">[pgsql-jp 8220] PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3日本語パッチ</A></STRONG>
<UL><LI><EM>From:</EM> Toshiaki Sugiyama &lt;sugiyama@tjsys.co.jp&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00413.html">[pgsql-jp 8222] Re:  Re: initdbのエラー（postgreSQL6.4.2）</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00415.html">[pgsql-jp 8224] Re: port '5432'?</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00411.html">[pgsql-jp 8220] PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3日本語パッチ</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00433.html">[pgsql-jp 8242] Re: PostgreSQL 6.4.2+Apache 1.3.4+PHP3.0.6+PHP3日本語パッチ</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00414"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00414"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
