<!-- MHonArc v2.1.0 -->
<!--X-Subject: [pgsql&#45;jp 8840] Re: 固定長テキストもダメですか‥‥ -->
<!--X-From: Yoshihiro Hanahara <hanahara@meiko.co.jp> -->
<!--X-Date: Tue, 15 Jun 99 11:47:58 +0900 -->
<!--X-Message-Id: 199906150248.LAA20659@sakura.meiko.co.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 01BEB6D3.81BF38A0@max1&#45;ppp40.nagaoka.sannet.ne.jp -->
<!--X-Reference-Id: 3765A9E2.1EA35483@mba.nifty.ne.jp -->
<!--X-Head-End-->
<HTML>
<HEAD>
<TITLE>[pgsql-jp 8840] Re: 固定長テキストもダメですか‥‥ </TITLE>
<LINK REV="made" HREF="mailto:hanahara@meiko.co.jp">
</HEAD>
<BODY BGCOLOR="#ffffff">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00272.html">Date Prev</A>][<A HREF="msg00275.html">Date Next</A>][<A HREF="msg00273.html">Thread Prev</A>][<A HREF="msg00278.html">Thread Next</A>][<A HREF="index.html#00274">Date Index</A>][<A HREF="threads.html#00274">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[pgsql-jp 8840] Re: 固定長テキストもダメですか‥‥</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><em>From</em>: Yoshihiro Hanahara &lt;<A HREF="mailto:hanahara@meiko.co.jp">hanahara@meiko.co.jp</A>&gt;</LI>
<LI><em>Date</em>: Tue, 15 Jun 99 11:47:58 +0900</LI>
<LI><em>References</em>: &lt;<A HREF="msg00269.html">01BEB6D3.81BF38A0@max1-ppp40.nagaoka.sannet.ne.jp</A>&gt;&lt;<A HREF="msg00273.html">3765A9E2.1EA35483@mba.nifty.ne.jp</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
花原@明宏です。

毎回Subject:を変えないで下さい(^_^;)。
話題を追跡するのが難しくなります。
Mozilla 4.5には[返信]ボタンはないのでしょうか?
どうも、毎回新規メールを作成されてるような... (他の人の返信を^_^;)。


In &lt;<A HREF="msg00273.html">3765A9E2.1EA35483@mba.nifty.ne.jp</A>&gt;,
lpk_kanto_yoshikawa@mba.nifty.ne.jp wrote:

&gt; 田中　様
&gt;
&gt;
&gt; &gt; う〜ん。固定長が直接読める方法があれば、私が聞きたいくらいですね（＾＾；
&gt;
&gt; 　あ、ダメですか‥‥
&gt; 　光明が見えたと思ったら、すぐ暗転ですね‥‥

ダメなんじゃなくて、ツールがあればなんとでもなるレベルの簡単な事です。
ただ、汎用的なツールがないか、あるけど知らないだけかもしれません
(きっとすでにあると思う)。なけりゃ作ればいい。

田中さんのいわれるように、Perlなんかを使ってフィールドに分解すれば
あとは、perlのインターフェイスでレコードを登録していけば
いいのでは。まあ、Perl勉強しなくてはなりませんけど...。
勉強して損はないです。


&gt; 　でも、固定長っていう事は、長さと位置は決まっている訳ですから、スクリプトなど
&gt; で分解していけば良いというアイデアを頂けたのは前進だと思います。
&gt;
&gt; 　また、直接の書き込みが可能ならば、運用上はPostgreSQLに固定長の読込をさせられ
&gt; るのと同義になりますし‥‥

あと、VBAをお使いになるということで、VBなどのLine Input文で
固定長レコードを読んで、文字列処理してフィールドを取りだし、
psqlに食わせるsql文なりpg_dumpが出力するテキストファイルと
同じものをつくるというのはどうでしょう?
(ただし、位置の指定にバイト数をつかうのならVBではMidB()や
StrConv()を使う必要があるかもしれません。VBの内部文字列は
Unicodeですから)。

ただ、70万件もあるということなので、ディスクがあふれるというのを
心配しないといけないかもしれません。
でも最近、ディスク安いから心配ないかもしれませんね。


P.S.
固定長ってやっぱり、ASCII文字は1バイト、漢字は2バイトってなるんですよね。
Unicodeのような文字コード体系だと、破綻しません?
固定長より、CSV(Comma Separated Value、CVSではない ^_^;)の方がまだ
面倒がなくていいですね。

---
hanahara@meiko.co.jp (Yoshihiro Hanahara)
</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00278" HREF="msg00278.html">[pgsql-jp 8844] 固定長テキストもダメですか‥‥</A></STRONG>
<UL><LI><EM>From:</EM> lpk_kanto_yoshikawa@mba.nifty.ne.jp</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00269" HREF="msg00269.html">[pgsql-jp 8835] RE: 固定長テキストを読むことは出来ますか？</A></STRONG>
<UL><LI><EM>From:</EM> Ikuo Tanaka &lt;ikuo_ml@sannet.ne.jp&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00273" HREF="msg00273.html">[pgsql-jp 8839] 固定長テキストもダメですか‥‥</A></STRONG>
<UL><LI><EM>From:</EM> lpk_kanto_yoshikawa@mba.nifty.ne.jp</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00272.html">[pgsql-jp 8838] はじめまして，インストール時の不具合</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00275.html">[pgsql-jp 8841] Re: はじめまして，インストール 時の不具合</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00273.html">[pgsql-jp 8839] 固定長テキストもダメですか‥‥</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00278.html">[pgsql-jp 8844] 固定長テキストもダメですか‥‥</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00274"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00274"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
