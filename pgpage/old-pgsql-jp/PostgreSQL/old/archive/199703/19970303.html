<A NAME="14">
<PRE><B>
From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
Date: Mon, 3 Mar 1997 18:26:54 +0900 (JST)
Subject: [postgres95 1514] Re: Self introduction.
Message-Id: &lt;199703030926.SAA00348@dummy.yklab.sei.co.jp&gt;
</A>
</B></PRE>
<PRE>

&lt;199703030526.OAA20528@sekine.densi.gifu-u.ac.jp&gt;の記事において
JST時間1997年03月03日(月)14時26分28秒頃、power@sekine.densi.gifu-u.ac.jpさんは書きました。

  &gt;&gt;いしかわ＠ぎふだいです
  &gt;&gt;解決しているかもしれないですが、また外しているかもしれません。
  &gt;&gt;
  &gt;&gt;From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
  &gt;&gt;Subject: [postgres95 1491] Re: Self introduction.
  &gt;&gt;Date: Fri, 28 Feb 1997 19:16:58 +0900 (JST)
  &gt;&gt;Message-ID: &lt;199702281016.TAA00253@dummy.yklab.sei.co.jp&gt;
  &gt;&gt;
  &gt;&gt;&gt; でも、あらたなちめいてきもんだいがふじょうしてきました。なんと、かんじ
  &gt;&gt;&gt; をかくことができません。
  &gt;&gt;&gt; 
  &gt;&gt;&gt; もともと canna をたちあげていましたが、postgreSQL のいんすとーるがおわっ
  &gt;&gt;&gt; たついでに、reboot させたら、Can't socket bind といわれ、/etc/services 
  &gt;&gt;&gt; に port のせっていがない、といわれました。
  &gt;&gt;&gt; 
  &gt;&gt;&gt; canna がばぐったとおもって、きゅうきょ Wnn にいれかえてたちあげてみた
  &gt;&gt;&gt; のですが、やっぱり Can't bind といわれます。cap もあがっていたのですが、
  &gt;&gt;&gt; それもおとしてみましたが、やはりだめでした。
  &gt;&gt;
  &gt;&gt;cannaとpostmasterが両方5432(?)を使っているのでは？
  &gt;&gt;
  &gt;&gt;End Of Message.  

Thanks for your kindness.(today,i've gotten to be that i can't use
japanese at last.)

And ,yeah,of course ,still both canna and wnn have not work.but in
/etc/services, i write canna to use the port number 5860.futher , the
postmaster isn't working now.

thanks
<HR>
</PRE>
<A NAME="13">
<PRE><B>
From: Toyoji Matsumoto &lt;matumoto@genair.ipc.kanazawa-u.ac.jp&gt;
Date: Mon, 3 Mar 1997 17:38:15 +0900
Subject: [postgres95 1513] Re: 6.0 on SunOS
Message-Id: &lt;199703030838.RAA09222@genair.ipc.kanazawa-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

石井様

金沢大学の松本です。

頂いたパッチの報告の続報です。

まったくあたらしくソースを展開し、今回のパッチをあててコンパイル
した結果コンパイルが完了しました。


環境：
東芝AS4075(ss-2)
SUNOS4.1.4+JLE
gcc Ver.2.7.2.1
make Ver.3.75

&gt; うーむ、jp.patch ですかね。こちらではまだ jp.patch を当てたテストはし
&gt; ていないのです。
やはり、jp.patchを当てたらだめなようです。

松本＠金沢大学
matumoto@genair.ipc.kanazawa-u.ac.jp
<HR>
</PRE>
<A NAME="12">
<PRE><B>
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
Date: Mon, 03 Mar 1997 16:02:32 +0900
Subject: [postgres95 1512] Re: 6.0 on SunOS 
Message-Id: &lt;199703030702.QAA11970@srashd.sra.co.jp&gt;
</A>
</B></PRE>
<PRE>

&gt;石井様
&gt;
&gt;金沢大学の松本です。
&gt;
&gt;頂いたパッチの報告です。

&gt;まったくあたらしくソースを展開し、jp.patchと今回のパッチをあててコンパイル
&gt;した結果、以下のように未定義エラーがldででます。
&gt;
&gt;
&gt;ld:Undifined symbol
&gt;   _memmove
&gt; make[1]: *** [postgres] Error1
&gt; make[1]:leaving directory `/home/local/pgsql/src/backend'
&gt; make: *** [all] Error 2
&gt; 
&gt; コンパイルした環境
&gt; 
&gt;環境：
&gt;東芝AS4075(ss-2)
&gt;SUNOS4.1.4+JLE
&gt;gcc Ver.2.7.2.1
&gt;make Ver.3.75
&gt;
&gt;以上報告まで。
&gt;夜にss-5でもコンパイルしてみて報告します。

うーむ、jp.patch ですかね。こちらではまだ jp.patch を当てたテストはし
ていないのです。
---
t-ishii@sra.co.jp	石井達夫
（株）ＳＲＡ
<HR>
</PRE>
<A NAME="11">
<PRE><B>
From: Toyoji Matsumoto &lt;matumoto@genair.ipc.kanazawa-u.ac.jp&gt;
Date: Mon, 3 Mar 1997 15:49:03 +0900
Subject: [postgres95 1511] Re: 6.0 on SunOS
Message-Id: &lt;199703030649.PAA07734@genair.ipc.kanazawa-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

石井様

金沢大学の松本です。

頂いたパッチの報告です。

&gt; &gt;念のため、SunOS 4.1.3+JLE で recompile、regression してみました。
&gt; &gt;するとなんと、今度は落ちません！コンパイラのバージョンも一緒なんですが。
&gt; &gt;(gcc 2.7.2)もしかしたら、4.1.4 のマシンの shared memory が少ないとか、
&gt; &gt;そういうマシン環境の違いによるのかもしれません。
&gt; &gt;月曜日にでもパッチを公開しますので、よろしかったらテストしてみてください。
&gt; 
&gt; というわけで、パッチです。使い方ですが、
&gt; 
&gt; 6.0 のソースを展開した後、そのディレクトリ(src の一つ上)に行って、
&gt; 
&gt; 	% patch -p1 &lt; パッチファイル
&gt; 
&gt; として下さい。後は普通に src/customize を起動するだけですが、port name 
&gt; は sparc を選んで下さい。また、
&gt; 
&gt; 	Specify C compiler: [cc] 
&gt; 
&gt; の質問には、gcc と答えて下さい。
&gt; ---
&gt; t-ishii@sra.co.jp	石井達夫
&gt; （株）ＳＲＡ
まったくあたらしくソースを展開し、jp.patchと今回のパッチをあててコンパイル
した結果、以下のように未定義エラーがldででます。


ld:Undifined symbol
   _memmove
 make[1]: *** [postgres] Error1
 make[1]:leaving directory `/home/local/pgsql/src/backend'
 make: *** [all] Error 2
 
 コンパイルした環境
 
環境：
東芝AS4075(ss-2)
SUNOS4.1.4+JLE
gcc Ver.2.7.2.1
make Ver.3.75

以上報告まで。
夜にss-5でもコンパイルしてみて報告します。


松本＠金沢大学
matumoto@genair.ipc.kanazawa-u.ac.jp
 
 
<HR>
</PRE>
<A NAME="10">
<PRE><B>
From: Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt;
Date: Mon, 3 Mar 97 14:45:48 JST
Subject: [postgres95 1510] Re:  [PHP/HELP] can't compile PHP/FI + kanji2.0b10.mb.patch on SunOS
Message-Id: &lt;9703030545.AA04201@void.lib.tokushima-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

庫元＠徳島大学附属図書館です。

おみつ@Tramp 様

どうもありがとうございました。うまくコンパイルできました。

石井様からもSunOS(PostgreSQL6.0)のパッチが公表されたので、
これで、PostgreSQL + PHP/FI + apache の環境が作れそうです。

おみつ様、石井様、桑村様 どうもご苦労さまでした。今後とも
SunOSをよろしくお願いします。


 &gt;
 &gt;どうも私、configure スクリプトで生成される結果による
 &gt;「HAVE_REGCOMP」へのトラップを入れていなかったようです m(.)m
 &gt;
 &gt;# 近い内にパッチの修正も致します。
 &gt;
 &gt;On Mon, 3 Mar 97 12:52:52 JST
 &gt;Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt; wrote:
 &gt;&gt; 
 &gt;&gt; /* Define if you have the symlink function.  */
 &gt;&gt; #define HAVE_SYMLINK 1
 &gt;&gt; 
 &gt;&gt; /* Define if you have the regcomp function.  */
 &gt;&gt; /* #undef HAVE_REGCOMP */
 &gt;&gt; 
 &gt;&gt; という具合になっています。
 &gt;
 &gt;とりあえず、この
 &gt;
 &gt;/* #undef HAVE_REGCOMP */
 &gt;
 &gt;を
 &gt;
 &gt;#define HAVE_REGCOMP 1
 &gt;
 &gt;にしてみて下さい。

------------------------------------------------------------
kuramoto@lib.tokushima-u.ac.jp
<HR>
</PRE>
<A NAME="9">
<PRE><B>
From: Satoshi Ishikawa &lt;power@sekine.densi.gifu-u.ac.jp&gt;
Date: Mon, 03 Mar 1997 14:26:28 +0900
Subject: [postgres95 1509] Re: Self introduction.
Message-Id: &lt;199703030526.OAA20528@sekine.densi.gifu-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

いしかわ＠ぎふだいです
解決しているかもしれないですが、また外しているかもしれません。

From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
Subject: [postgres95 1491] Re: Self introduction.
Date: Fri, 28 Feb 1997 19:16:58 +0900 (JST)
Message-ID: &lt;199702281016.TAA00253@dummy.yklab.sei.co.jp&gt;

&gt; でも、あらたなちめいてきもんだいがふじょうしてきました。なんと、かんじ
&gt; をかくことができません。
&gt; 
&gt; もともと canna をたちあげていましたが、postgreSQL のいんすとーるがおわっ
&gt; たついでに、reboot させたら、Can't socket bind といわれ、/etc/services 
&gt; に port のせっていがない、といわれました。
&gt; 
&gt; canna がばぐったとおもって、きゅうきょ Wnn にいれかえてたちあげてみた
&gt; のですが、やっぱり Can't bind といわれます。cap もあがっていたのですが、
&gt; それもおとしてみましたが、やはりだめでした。

cannaとpostmasterが両方5432(?)を使っているのでは？

End Of Message.  
----- ----- ----- ----- ----- ----- ----- ----- ----- ----- -----
石川 諭 （いしかわ さとし）power@densi.gifu-u.ac.jp
Key fingerprint = 53 12 86 DF BF 21 6D BE  DC A4 7B 31 C0 8D E2 F9

<HR>
</PRE>
<A NAME="8">
<PRE><B>
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
Date: Mon, 03 Mar 1997 14:13:49 +0900
Subject: [postgres95 1508] Re: 6.0 on SunOS 
Message-Id: &lt;199703030513.OAA01985@srashd.sra.co.jp&gt;
</A>
</B></PRE>
<PRE>

石井です。

&gt;というわけで、パッチです。使い方ですが、

大変済みません。パッチに抜けがありました。前のは捨てて下さい。
---
t-ishii@sra.co.jp	石井達夫
（株）ＳＲＡ

-------------------------- cut here ------------------------------
Index: postgresql/src/Makefile.global
diff -c postgresql/src/Makefile.global:1.1.1.1 postgresql/src/Makefile.global:1.2
*** postgresql/src/Makefile.global:1.1.1.1	Mon Feb  3 10:15:02 1997
--- postgresql/src/Makefile.global	Mon Mar  3 13:15:46 1997
***************
*** 615,621 ****
  
  #---------------------------------------------------------------------------
  
! ifeq ($(PORTNAME), sunos4)
  # cc won't work!
  CC= gcc
  
--- 615,621 ----
  
  #---------------------------------------------------------------------------
  
! ifeq ($(PORTNAME), sparc)
  # cc won't work!
  CC= gcc
  
Index: postgresql/src/customize
diff -c postgresql/src/customize:1.1.1.1 postgresql/src/customize:1.2
*** postgresql/src/customize:1.1.1.1	Mon Feb  3 10:15:02 1997
--- postgresql/src/customize	Mon Mar  3 13:15:44 1997
***************
*** 91,97 ****
  echo &quot;   linux          Intel x86 on Linux 1.2 and Linux ELF&quot;
  echo &quot;   nextstep       Motorola MC68K or Intel x86 on NeXTSTEP 3.2&quot;
  echo &quot;   sparc_solaris  SUN SPARC on Solaris 2.4&quot;
! echo &quot;   sunos4         SUN SPARC on SunOS 4.1.3&quot;
  echo &quot;   svr4           Intel x86 on Intel SVR4&quot;
  echo &quot;   ultrix4        DEC MIPS on Ultrix 4.4&quot;
  
--- 91,97 ----
  echo &quot;   linux          Intel x86 on Linux 1.2 and Linux ELF&quot;
  echo &quot;   nextstep       Motorola MC68K or Intel x86 on NeXTSTEP 3.2&quot;
  echo &quot;   sparc_solaris  SUN SPARC on Solaris 2.4&quot;
! echo &quot;   sparc          SUN SPARC on SunOS 4.1.3&quot;
  echo &quot;   svr4           Intel x86 on Intel SVR4&quot;
  echo &quot;   ultrix4        DEC MIPS on Ultrix 4.4&quot;
  
Index: postgresql/src/backend/port/Makefile
diff -c postgresql/src/backend/port/Makefile:1.1.1.1 postgresql/src/backend/port/Makefile:1.2
*** postgresql/src/backend/port/Makefile:1.1.1.1	Mon Feb  3 10:15:23 1997
--- postgresql/src/backend/port/Makefile	Mon Mar  3 14:07:52 1997
***************
*** 22,27 ****
--- 22,29 ----
  #    $Header: /usr/local/cvsroot/postgres95/src/backend/port/Makefile,v 1.9 1997/01/23 15:58:34 scrappy Exp $
  #
  #-------------------------------------------------------------------------
+ SRCDIR = ../..
+ include ../../Makefile.global
  
  ifndef PORTNAME
  .DEFAULT all: 
***************
*** 31,37 ****
  
  OBJS = $(PORTNAME)/SUBSYS.o
  
! ifneq (,$(findstring /$(PORTNAME)/, /i386_solaris/sparc_solaris/ultrix4/nextstep/svr4))
  # Other ports get the inet_aton() function from their standard C libraries.
  OBJS += inet_aton.o
  endif
--- 33,39 ----
  
  OBJS = $(PORTNAME)/SUBSYS.o
  
! ifneq (,$(findstring /$(PORTNAME)/, /i386_solaris/sparc/sparc_solaris/ultrix4/nextstep/svr4))
  # Other ports get the inet_aton() function from their standard C libraries.
  OBJS += inet_aton.o
  endif
Index: postgresql/src/include/c.h
diff -c postgresql/src/include/c.h:1.1.1.1 postgresql/src/include/c.h:1.2
*** postgresql/src/include/c.h:1.1.1.1	Mon Feb  3 10:15:48 1997
--- postgresql/src/include/c.h	Mon Mar  3 13:16:46 1997
***************
*** 737,744 ****
  #include &quot;port/hpux/fixade.h&quot;		/* for 8.07 unaligned access fixup */
  #endif /* hpux */
  
! #if defined(sunos4)
  #define	memmove(d, s, l)	bcopy(s, d, l)
  #endif
  
  /* These are for things that are one way on Unix and another on NT */
--- 737,747 ----
  #include &quot;port/hpux/fixade.h&quot;		/* for 8.07 unaligned access fixup */
  #endif /* hpux */
  
! #if defined(sparc) &amp;&amp; !defined(__svr4)
  #define	memmove(d, s, l)	bcopy(s, d, l)
+ #include &lt;unistd.h&gt;
+ extern char *sys_errlist[];
+ #define strerror(A) (sys_errlist[(A)])
  #endif
  
  /* These are for things that are one way on Unix and another on NT */
Index: postgresql/src/include/config.h
diff -c postgresql/src/include/config.h:1.1.1.1 postgresql/src/include/config.h:1.2
*** postgresql/src/include/config.h:1.1.1.1	Mon Feb  3 10:15:48 1997
--- postgresql/src/include/config.h	Mon Mar  3 13:16:47 1997
***************
*** 206,214 ****
  typedef unsigned char slock_t;
  #endif
  
! #if defined(sunos4)
  #  define USE_POSIX_TIME
  #  undef HAVE_MEMMOVE
  #endif
  
  #if defined(svr4) 
--- 206,215 ----
  typedef unsigned char slock_t;
  #endif
  
! #if defined(sparc) &amp;&amp; !defined(__svr4)
  #  define USE_POSIX_TIME
  #  undef HAVE_MEMMOVE
+ #  undef HAVE_SYS_SELECT_H
  #endif
  
  #if defined(svr4) 
Index: postgresql/src/include/regex/utils.h
diff -c postgresql/src/include/regex/utils.h:1.1.1.1 postgresql/src/include/regex/utils.h:1.2
*** postgresql/src/include/regex/utils.h:1.1.1.1	Mon Feb  3 10:16:00 1997
--- postgresql/src/include/regex/utils.h	Mon Mar  3 13:17:00 1997
***************
*** 53,58 ****
  #endif
  
  /* for old systems with bcopy() but no memmove() */
! #if !defined(HAVE_MEMMOVE)
  #define	memmove(d, s, c)	bcopy(s, d, c)
  #endif
--- 53,58 ----
  #endif
  
  /* for old systems with bcopy() but no memmove() */
! #if !defined(memmove) &amp;&amp; !defined(HAVE_MEMMOVE)
  #define	memmove(d, s, c)	bcopy(s, d, c)
  #endif
Index: postgresql/src/libpq/libpq-fe.h
diff -c postgresql/src/libpq/libpq-fe.h:1.1.1.1 postgresql/src/libpq/libpq-fe.h:1.2
*** postgresql/src/libpq/libpq-fe.h:1.1.1.1	Mon Feb  3 10:16:07 1997
--- postgresql/src/libpq/libpq-fe.h	Mon Mar  3 13:17:35 1997
***************
*** 304,314 ****
  #define palloc malloc
  #define pfree free
  
- #if defined(sunos4)
- extern char *sys_errlist[];
- #define strerror(A) (sys_errlist[(A)])
- #endif /* sunos4 */
- 
  #ifdef __cplusplus
  };
  #endif
--- 304,309 ----
<HR>
</PRE>
<A NAME="7">
<PRE><B>
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
Date: Mon, 03 Mar 1997 14:01:23 +0900
Subject: [postgres95 1507] Re: 6.0 on SunOS 
Message-Id: &lt;199703030501.OAA01242@srashd.sra.co.jp&gt;
</A>
</B></PRE>
<PRE>

石井です。

&gt;念のため、SunOS 4.1.3+JLE で recompile、regression してみました。
&gt;するとなんと、今度は落ちません！コンパイラのバージョンも一緒なんですが。
&gt;(gcc 2.7.2)もしかしたら、4.1.4 のマシンの shared memory が少ないとか、
&gt;そういうマシン環境の違いによるのかもしれません。
&gt;月曜日にでもパッチを公開しますので、よろしかったらテストしてみてください。

というわけで、パッチです。使い方ですが、

6.0 のソースを展開した後、そのディレクトリ(src の一つ上)に行って、

	% patch -p1 &lt; パッチファイル

として下さい。後は普通に src/customize を起動するだけですが、port name 
は sparc を選んで下さい。また、

	Specify C compiler: [cc] 

の質問には、gcc と答えて下さい。
---
t-ishii@sra.co.jp	石井達夫
（株）ＳＲＡ

---------------------------- cut here -----------------------------------
Index: postgresql/src/Makefile.global
diff -c postgresql/src/Makefile.global:1.1.1.1 postgresql/src/Makefile.global:1.2
*** postgresql/src/Makefile.global:1.1.1.1	Mon Feb  3 10:15:02 1997
--- postgresql/src/Makefile.global	Mon Mar  3 13:15:46 1997
***************
*** 615,621 ****
  
  #---------------------------------------------------------------------------
  
! ifeq ($(PORTNAME), sunos4)
  # cc won't work!
  CC= gcc
  
--- 615,621 ----
  
  #---------------------------------------------------------------------------
  
! ifeq ($(PORTNAME), sparc)
  # cc won't work!
  CC= gcc
  
Index: postgresql/src/customize
diff -c postgresql/src/customize:1.1.1.1 postgresql/src/customize:1.2
*** postgresql/src/customize:1.1.1.1	Mon Feb  3 10:15:02 1997
--- postgresql/src/customize	Mon Mar  3 13:15:44 1997
***************
*** 91,97 ****
  echo &quot;   linux          Intel x86 on Linux 1.2 and Linux ELF&quot;
  echo &quot;   nextstep       Motorola MC68K or Intel x86 on NeXTSTEP 3.2&quot;
  echo &quot;   sparc_solaris  SUN SPARC on Solaris 2.4&quot;
! echo &quot;   sunos4         SUN SPARC on SunOS 4.1.3&quot;
  echo &quot;   svr4           Intel x86 on Intel SVR4&quot;
  echo &quot;   ultrix4        DEC MIPS on Ultrix 4.4&quot;
  
--- 91,97 ----
  echo &quot;   linux          Intel x86 on Linux 1.2 and Linux ELF&quot;
  echo &quot;   nextstep       Motorola MC68K or Intel x86 on NeXTSTEP 3.2&quot;
  echo &quot;   sparc_solaris  SUN SPARC on Solaris 2.4&quot;
! echo &quot;   sparc          SUN SPARC on SunOS 4.1.3&quot;
  echo &quot;   svr4           Intel x86 on Intel SVR4&quot;
  echo &quot;   ultrix4        DEC MIPS on Ultrix 4.4&quot;
  
Index: postgresql/src/include/c.h
diff -c postgresql/src/include/c.h:1.1.1.1 postgresql/src/include/c.h:1.2
*** postgresql/src/include/c.h:1.1.1.1	Mon Feb  3 10:15:48 1997
--- postgresql/src/include/c.h	Mon Mar  3 13:16:46 1997
***************
*** 737,744 ****
  #include &quot;port/hpux/fixade.h&quot;		/* for 8.07 unaligned access fixup */
  #endif /* hpux */
  
! #if defined(sunos4)
  #define	memmove(d, s, l)	bcopy(s, d, l)
  #endif
  
  /* These are for things that are one way on Unix and another on NT */
--- 737,747 ----
  #include &quot;port/hpux/fixade.h&quot;		/* for 8.07 unaligned access fixup */
  #endif /* hpux */
  
! #if defined(sparc) &amp;&amp; !defined(__svr4)
  #define	memmove(d, s, l)	bcopy(s, d, l)
+ #include &lt;unistd.h&gt;
+ extern char *sys_errlist[];
+ #define strerror(A) (sys_errlist[(A)])
  #endif
  
  /* These are for things that are one way on Unix and another on NT */
Index: postgresql/src/include/config.h
diff -c postgresql/src/include/config.h:1.1.1.1 postgresql/src/include/config.h:1.2
*** postgresql/src/include/config.h:1.1.1.1	Mon Feb  3 10:15:48 1997
--- postgresql/src/include/config.h	Mon Mar  3 13:16:47 1997
***************
*** 206,214 ****
  typedef unsigned char slock_t;
  #endif
  
! #if defined(sunos4)
  #  define USE_POSIX_TIME
  #  undef HAVE_MEMMOVE
  #endif
  
  #if defined(svr4) 
--- 206,215 ----
  typedef unsigned char slock_t;
  #endif
  
! #if defined(sparc) &amp;&amp; !defined(__svr4)
  #  define USE_POSIX_TIME
  #  undef HAVE_MEMMOVE
+ #  undef HAVE_SYS_SELECT_H
  #endif
  
  #if defined(svr4) 
Index: postgresql/src/include/regex/utils.h
diff -c postgresql/src/include/regex/utils.h:1.1.1.1 postgresql/src/include/regex/utils.h:1.2
*** postgresql/src/include/regex/utils.h:1.1.1.1	Mon Feb  3 10:16:00 1997
--- postgresql/src/include/regex/utils.h	Mon Mar  3 13:17:00 1997
***************
*** 53,58 ****
  #endif
  
  /* for old systems with bcopy() but no memmove() */
! #if !defined(HAVE_MEMMOVE)
  #define	memmove(d, s, c)	bcopy(s, d, c)
  #endif
--- 53,58 ----
  #endif
  
  /* for old systems with bcopy() but no memmove() */
! #if !defined(memmove) &amp;&amp; !defined(HAVE_MEMMOVE)
  #define	memmove(d, s, c)	bcopy(s, d, c)
  #endif
Index: postgresql/src/libpq/libpq-fe.h
diff -c postgresql/src/libpq/libpq-fe.h:1.1.1.1 postgresql/src/libpq/libpq-fe.h:1.2
*** postgresql/src/libpq/libpq-fe.h:1.1.1.1	Mon Feb  3 10:16:07 1997
--- postgresql/src/libpq/libpq-fe.h	Mon Mar  3 13:17:35 1997
***************
*** 304,314 ****
  #define palloc malloc
  #define pfree free
  
- #if defined(sunos4)
- extern char *sys_errlist[];
- #define strerror(A) (sys_errlist[(A)])
- #endif /* sunos4 */
- 
  #ifdef __cplusplus
  };
  #endif
--- 304,309 ----
<HR>
</PRE>
<A NAME="6">
<PRE><B>
From: Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt;
Date: Mon, 03 Mar 1997 14:05:53 +0900
Subject: [postgres95 1506] Re: [PHP/HELP] can't compile PHP/FI + kanji2.0b10.mb.patch
Message-Id: &lt;199703030505.OAA04231@log.tramp.co.jp&gt;
</A>
</B></PRE>
<PRE>

おみつ@Tramp です。

どうも私、configure スクリプトで生成される結果による
「HAVE_REGCOMP」へのトラップを入れていなかったようです m(.)m

# 近い内にパッチの修正も致します。

On Mon, 3 Mar 97 12:52:52 JST
Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt; wrote:
&gt; 
&gt; /* Define if you have the symlink function.  */
&gt; #define HAVE_SYMLINK 1
&gt; 
&gt; /* Define if you have the regcomp function.  */
&gt; /* #undef HAVE_REGCOMP */
&gt; 
&gt; という具合になっています。

とりあえず、この

/* #undef HAVE_REGCOMP */

を

#define HAVE_REGCOMP 1

にしてみて下さい。

== おみつ
<HR>
</PRE>
<A NAME="5">
<PRE><B>
From: Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt;
Date: Mon, 3 Mar 97 12:52:52 JST
Subject: [postgres95 1505] Re:  [PHP/HELP] can't compile PHP/FI + kanji2.0b10.mb.patch on SunOS
Message-Id: &lt;9703030352.AA01488@void.lib.tokushima-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

庫元＠徳島大学附属図書館です。

お手数をおかけします。

 &gt;
 &gt;PHPのソースディレクトリ(.../php-2.0b??/) に config.h というファイル
 &gt;があると思いますが、そこで 
 &gt;
 &gt;	#define HAVE_REGCOMP 1
 &gt;
 &gt;という行があるでしょうか?
 &gt;

/* Define if you have the symlink function.  */
#define HAVE_SYMLINK 1

/* Define if you have the regcomp function.  */
/* #undef HAVE_REGCOMP */

という具合になっています。

 &gt;&gt; 
 &gt;&gt; #define REG_STARTEND    00004(60行目)
 &gt;&gt; 
 &gt;&gt; をreg.cの頭の部分にコピーすると、一様コンパイルは出来たのですが、この
 &gt;&gt; 処理でうまくphpが動くかどうかわからないし、jp.regrexのディレクトリのヘッダ
 &gt;&gt; ーファイルを読みにいっているので本来そちらのほうで何かしないといけないよう
 &gt;&gt; な気がします。(もしかすると、何か間違ったことをやっているかもしれませんが....)
 &gt;
 &gt;これはまずいと思います。
 &gt;jp.regex 以下のファイルは、配布 regex パッケージとは違うものですので、
 &gt;regex 関連の関数群は jp.regex 以下のファイルで完結しなくてはならないはずです。

わかりました。やはりダメでしたね!!

-------------------------------------------------------------
kuramoto@lib.tokushima-u.ac.jp
<HR>
</PRE>
<A NAME="4">
<PRE><B>
From: Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt;
Date: Mon, 03 Mar 1997 12:57:42 +0900
Subject: [postgres95 1504] Re: [PHP/HELP] can't compile PHP/FI + kanji2.0b10.mb.patch
Message-Id: &lt;199703030357.MAA04108@log.tramp.co.jp&gt;
</A>
</B></PRE>
<PRE>

おみつ@Tramp です。

On Mon, 3 Mar 97 12:23:45 JST
Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt; wrote:
&gt;
&gt; reg.c: In function `_RegReplace':
&gt; reg.c:262: `REG_STARTEND' undeclared (first use this function)
&gt; reg.c:262: (Each undeclared identifier is reported only once
&gt; reg.c:262: for each function it appears in.)
&gt; reg.c: In function `_ERegReplace':
&gt; reg.c:562: `REG_STARTEND' undeclared (first use this function)
&gt; gmake: *** [reg.o] Error 1
&gt; 
&gt; となってしまいます。

PHPのソースディレクトリ(.../php-2.0b??/) に config.h というファイル
があると思いますが、そこで 

	#define HAVE_REGCOMP 1

という行があるでしょうか?

REG_STARTEND を読みに行っているということは、reg.c 中で
#ifndef HAVE_REGCOMP
 ^^^^^^
をプリプロセッサが解釈したということですし... :-)

&gt; src/regex/regex.hの
&gt; 
&gt; #define REG_STARTEND    00004(60行目)
&gt; 
&gt; をreg.cの頭の部分にコピーすると、一様コンパイルは出来たのですが、この
&gt; 処理でうまくphpが動くかどうかわからないし、jp.regrexのディレクトリのヘッダ
&gt; ーファイルを読みにいっているので本来そちらのほうで何かしないといけないよう
&gt; な気がします。(もしかすると、何か間違ったことをやっているかもしれませんが....)

これはまずいと思います。
jp.regex 以下のファイルは、配布 regex パッケージとは違うものですので、
regex 関連の関数群は jp.regex 以下のファイルで完結しなくてはならないはずです。

== おみつ
<HR>
</PRE>
<A NAME="3">
<PRE><B>
From: Kuramoto Takafumi &lt;kuramoto@lib.tokushima-u.ac.jp&gt;
Date: Mon, 3 Mar 97 12:23:45 JST
Subject: [postgres95 1503] [PHP/HELP] can't compile PHP/FI + kanji2.0b10.mb.patch on SunOS
Message-Id: &lt;9703030323.AA01448@void.lib.tokushima-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>


庫元＠徳島大学附属図書館です。

Postgres95 MLの皆様へ

いつもお世話になります。

PHPのコンパイルの件でアドバイスをお願いします。

SunOS4.1.4 JLE

PHP/FI2.0b10
kanji2.0b10.mb.patch
apache_1.2b7
postgreSQL(jp.patch)

gcc2.7.2.1
gmake 3.75

上記環境でコンパイルしてみたのですが、

gcc -O   -DPHPSENDMAIL=1 -DSENDMAIL=\&quot;&quot;/usr/lib/sendmail -t&quot;\&quot;    -I./jp.regex -I.
-I/usr/local/pgsql/include -DHAVE_LIBPQ=1
-I/home/kuramoto/ARCHIVES/www/apache/apache_
1.2b7/src -DACCESS_CONTROL -DACCESS_DIR=\&quot;/home/www/http/cgi-data\&quot; -DLOGGING=1
-DLOG_DIR=
\&quot;/home/www/http/cgi-data\&quot;  -DFILE_UPLOAD -DAPACHE=1 -DAPACHE_NEWAPI=1   -c sybsql.c
gcc -O   -DPHPSENDMAIL=1 -DSENDMAIL=\&quot;&quot;/usr/lib/sendmail -t&quot;\&quot;    -I./jp.regex -I.
-I/usr/local/pgsql/include -DHAVE_LIBPQ=1
-I/home/kuramoto/ARCHIVES/www/apache/apache_
1.2b7/src -DACCESS_CONTROL -DACCESS_DIR=\&quot;/home/www/http/cgi-data\&quot; -DLOGGING=1
-DLOG_DIR=
\&quot;/home/www/http/cgi-data\&quot;  -DFILE_UPLOAD -DAPACHE=1 -DAPACHE_NEWAPI=1   -c reg.c
reg.c: In function `_RegReplace':
reg.c:262: `REG_STARTEND' undeclared (first use this function)
reg.c:262: (Each undeclared identifier is reported only once
reg.c:262: for each function it appears in.)
reg.c: In function `_ERegReplace':
reg.c:562: `REG_STARTEND' undeclared (first use this function)
gmake: *** [reg.o] Error 1

となってしまいます。


src/regex/regex.hの

#define REG_STARTEND    00004(60行目)

をreg.cの頭の部分にコピーすると、一様コンパイルは出来たのですが、この
処理でうまくphpが動くかどうかわからないし、jp.regrexのディレクトリのヘッダ
ーファイルを読みにいっているので本来そちらのほうで何かしないといけないよう
な気がします。(もしかすると、何か間違ったことをやっているかもしれませんが....)
どなたか、SunOS4.xでうまくコンパイル出来ている方がおられましたら、ここを
こうしたよと言うアドバイスをいただければ幸いです。
よろしく、お願いします。

-------------------------------------------------------------------
kuramoto@lib.tokushima-u.ac.jp

<HR>
</PRE>
<A NAME="2">
<PRE><B>
From: Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt;
Date: Mon, 03 Mar 1997 12:31:21 +0900
Subject: [postgres95 1502] Re: copy etc. new feature in 6.0 
Message-Id: &lt;199703030331.MAA04062@log.tramp.co.jp&gt;
</A>
</B></PRE>
<PRE>

おみつ@Tramp 自己フォローです。

On Fri, 28 Feb 1997 22:19:18 +0900
Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt; wrote:
&gt; 
&gt; もう少し日付関係について検証してみようと思ったのですが、
&gt; はたとつまずいてしまいました。「日付 - 日付」が変な答えになってしまいます。
&gt; 
&gt; ...snip...
&gt; # どうもバグちっく... ;-) 
&gt; 

こちらの方 BUG レポートとして本家に送らせて頂いたところ、
やはりバグだったようです。

6.1 のベータソースでは変更が加えられていましたが、
未だ完全ではなさそうです。
# 今度はまた違う条件でバグってました ;-)

日付用の関数をどれだけ必要とされているかわかりませんが、
6.1 がリリースされるまでの暫定的パッチを添付します。
( .../src/backend/utils/adt/datetime.c に対するパッチです。)

# 時系列分析では日付の関数は重要だったりして...と勝手に思い込んで :-)

-----ここから-----------------------------------------------------------------
*** datetimes.c.org     Mon Mar  3 12:00:59 1997
--- datetimes.c Mon Mar  3 12:02:36 1997
***************
*** 244,249 ****
--- 244,252 ----
    int32 days = 0;
    int i;
  
+   if(date_lt(dateVal1, dateVal2))
+     return(-date_mi(dateVal2, dateVal1));
+ 
    date1 = (DateADT *) &amp;dateVal1;
    date2 = (DateADT *) &amp;dateVal2;
  
***************
*** 266,271 ****
--- 269,277 ----
  
    /* Add in day of month of date2.  */
    days += date2-&gt;day;
+ 
+   if(date1-&gt;year == date2-&gt;year)
+     days = (isleap(date1-&gt;year)?366:365) - days;
  
    return (days);
  }
-----ここまで-----------------------------------------------------------------
<HR>
</PRE>
<A NAME="1">
<PRE><B>
From: Jun Kuwamura &lt;juk@rccm.co.jp&gt;
Date: Mon, 3 Mar 1997 11:33:26 +0900 (JST)
Subject: [postgres95 1501] Re: New member 
Message-Id: &lt;Pine.LNX.3.91LJ1.0.4.970303112742.18495A-100000@earth.astea.rccm.co.jp&gt;
</A>
</B></PRE>
<PRE>

桑村です。

&gt; 石井です。

&gt; # juk@rccm.co.jp さんの [postgres95 1430] を参考にさせていただきました。
&gt; # ただし、lib44bsd.a を使わない方針なのと、趣味の問題で portname は 
&gt; # sparc にしてますが:-)

  以前失敗した時に出したメールで触れたと思いますが、sparc の方が正解の
ようです。
＃混乱させてすみません。

 Jun Kuwamura
rC Cm	Research Center of Computational Mechanics, Inc.
  ^		E-Mail: JuK@rccm.co.jp
  ~


<HR>
</PRE>
<A NAME="0">
<PRE><B>
From: Toyoji Matsumoto &lt;matumoto@genair.ipc.kanazawa-u.ac.jp&gt;
Date: Mon, 3 Mar 1997 08:16:37 +0900
Subject: [postgres95 1500] Re: 6.0 on SunOS
Message-Id: &lt;199703022316.IAA01827@genair.ipc.kanazawa-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

石井様

金沢大学の松本です。

 
&gt; At  5:35 PM 97.2.28 +0900, Tatsuo Ishii wrote:
&gt; &gt;石井です。
&gt; &gt;
&gt; &gt;&gt;&gt;&gt; もうちょっとお待ち下さい。当方も SunOS 4.1.4+JLE でコンパイル中です。
&gt; &gt;&gt;&gt;&gt; 多分今日中にはパッチを出せると思います。
&gt; &gt;&gt;&gt;うれしいですね！　待ってます。
&gt; &gt;&gt;
&gt; &gt;&gt;今 regression してる最中です。これでOKならパッチ出せます。
&gt; &gt;
&gt; &gt;残念ながらOKじゃないです。regression の最中に backend (postgres サーバ)
&gt; &gt;が死ぬと言う、最悪のパターンです。
&gt; 
&gt; 念のため、SunOS 4.1.3+JLE で recompile、regression してみました。
&gt; するとなんと、今度は落ちません！コンパイラのバージョンも一緒なんですが。
&gt; (gcc 2.7.2)もしかしたら、4.1.4 のマシンの shared memory が少ないとか、
&gt; そういうマシン環境の違いによるのかもしれません。
&gt; 月曜日にでもパッチを公開しますので、よろしかったらテストしてみてください。
楽しみにしています。入手できしだいテストしたいと思っています(ただし、私は
まったく素人で、テストするのみの能力しかありません）。


松本＠金沢大学
matumoto@genair.ipc.kanazawa-u.acjp
<HR>
</PRE>
