<A NAME="6">
<PRE><B>
From: caco@mxg.meshnet.or.jp (Chikako Ishii)
Date: Tue, 18 Mar 1997 23:01:19 +0900
Subject: [postgres95 1593] Re: query 32 (Re: Benchmark test)
Message-Id: &lt;199703181401.XAA14739@meshsv26.tk.mesh.ad.jp&gt;
</A>
</B></PRE>
<PRE>

今晩は。石井＠自宅です。

At  9:56 AM 97.3.18 +0900, Satoshi Ishikawa wrote:
&gt;いしかわ＠ぎふだいです
&gt;いつもいつも、ごくろうさまです。

どういたしまして。

&gt;私にはここまで原因を追求する根性はありませんが、

単にしつこいだけなのですが:-)

&gt;t-ishii&gt; もし今から修正データを申告する根性のある方は、runwisc.sh の最後にある
&gt;
&gt;これぐらいの根性はあります;-)。

わかっております:-)

&gt;なるべく負荷はかけないようにしてあります。
&gt;
&gt;Linux/SparcClassic(MicroSPARC 50MHz) 32MB RAM + アサーション
&gt;なし + JP patch です

早速明日にでも反映させておきます。

ところで、Sparc/Linux のパッチを作って 6.1 の正式サポート対象に
してしまう計画はどうなりましたでしょう？
# 私はこれを密かに SLIP (Sparc/Linux In Postgres)計画と
# 呼んでおります:-) 

---
石井千賀子（CHIKAKO  ISHII）
caco@mxg.meshnet.or.jp

<HR>
</PRE>
<A NAME="5">
<PRE><B>
From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
Date: Tue, 18 Mar 1997 07:06:58 GMT
Subject: [postgres95 1592] Re: I can't use &quot;CREATE TABLE weather&quot;.
Message-Id: &lt;199703180706.HAA13160@spider.yklab.sei.co.jp&gt;
</A>
</B></PRE>
<PRE>

&lt;199703180821.RAA29995@log.tramp.co.jp&gt;の記事において
JST時間1997年03月18日(火)17時21分16秒頃、mitsu@tramp.co.jpさんは書きました。

  &gt;&gt;おみつ@Tramp です。
  &gt;&gt;
  &gt;&gt;On Tue, 18 Mar 1997 06:27:21 GMT
  &gt;&gt;yamasita@yklab.sei.co.jp (Yamashita Taiichirou) wrote:
  &gt;&gt;&gt; 
  &gt;&gt;&gt; 山下＠度々申し訳ないです です。
  &gt;&gt;
  &gt;&gt;とんでもないです :-)
  &gt;&gt;
  &gt;&gt;&gt;   &gt;&gt;
  &gt;&gt;&gt;   &gt;&gt;解決方法としまして、
  &gt;&gt;&gt;   &gt;&gt;postgreSQL のスーパーユーザーで
  &gt;&gt;
  &gt;&gt;      かなり略。
  &gt;&gt;
  &gt;&gt;
  &gt;&gt;となれば OK です。

無事、完了致しました。ありがとうございます。で、これって、一度おこなっ
たら、ずっと(リブートしても)この設定は生きていますよね？

  &gt;&gt;&gt; これは、perl のソースは特に必要無いんですよね。README を読む限りそうで
  &gt;&gt;&gt; すね。
  &gt;&gt;
  &gt;&gt;どうも perl ではモジュールのようなものをロードできるみたいですね。
  &gt;&gt;私は全然 perl など使わない人なので詳しくはわからないですけど...
  &gt;&gt;
  &gt;&gt;# 全部 C と PHP/FI でこと足りてたりして ;P
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ますます、perl を学ぶ気が無くなって行くー。まあ、いっか。どのみち、う
ちの課で使おうと思ったら、WWW ブラウザを使うしかないし(私以外皆 Win95)。

以上



<HR>
</PRE>
<A NAME="4">
<PRE><B>
From: Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt;
Date: Tue, 18 Mar 1997 17:21:16 +0900
Subject: [postgres95 1591] Re: I can't use &quot;CREATE TABLE weather&quot;.
Message-Id: &lt;199703180821.RAA29995@log.tramp.co.jp&gt;
</A>
</B></PRE>
<PRE>

おみつ@Tramp です。

On Tue, 18 Mar 1997 06:27:21 GMT
yamasita@yklab.sei.co.jp (Yamashita Taiichirou) wrote:
&gt; 
&gt; 山下＠度々申し訳ないです です。

とんでもないです :-)

&gt;   &gt;&gt;
&gt;   &gt;&gt;解決方法としまして、
&gt;   &gt;&gt;postgreSQL のスーパーユーザーで
&gt;   &gt;&gt;
&gt;   &gt;&gt;	grant delete on pg_database to public;
&gt;   &gt;&gt;
&gt;   &gt;&gt;などとしても、問題はないと思いますがいかがでしょう?
&gt; 
&gt; それは、どのディレクトリで、どのような事をするのでしょうか？ grant 自
&gt; 体は、postgreSQL のコマンドですよね、多分(マニュアルによる)。select と
&gt; かと同等ですね。ということは、データベース管理者になって、psql を立ち
&gt; 上げて、そのプロンプト上で、上記文を入力するのですか？でも、psql を立
&gt; ち上げるためには何かのデータベースが必要ですし、そこには、pg_database 
&gt; はないですよね。どうやってアクセスするのでしょうか？

# 私の文章力のなさが暴露されてしまったような ^^;

仰せの通りスーパーユーザーになって psql を立ち上げ上記 SQL を実行します。
Postgresデータベースシステムに必ずある template1 に接続することになります。
(スーパーユーザーで template1 に接続できないことはありませんし ... :-)

% psql template1
...メッセージ...
template1=&gt; grant delete on pg_database to public;
CHANGE
template1=&gt; 

となれば OK です。

&gt; これは、perl のソースは特に必要無いんですよね。README を読む限りそうで
&gt; すね。

どうも perl ではモジュールのようなものをロードできるみたいですね。
私は全然 perl など使わない人なので詳しくはわからないですけど...

# 全部 C と PHP/FI でこと足りてたりして ;P

== おみつ

<HR>
</PRE>
<A NAME="3">
<PRE><B>
From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
Date: Tue, 18 Mar 1997 06:27:21 GMT
Subject: [postgres95 1590] Re: I can't use &quot;CREATE TABLE weather&quot;.
Message-Id: &lt;199703180627.GAA12749@spider.yklab.sei.co.jp&gt;
</A>
</B></PRE>
<PRE>

&lt;199703180524.OAA29785@log.tramp.co.jp&gt;の記事において
JST時間1997年03月18日(火)14時24分06秒頃、mitsu@tramp.co.jpさんは書きました。

  &gt;&gt;おみつ@Tramp です。
  &gt;&gt;

山下＠度々申し訳ないです です。

  &gt;&gt;On Tue, 18 Mar 1997 02:46:16 GMT
  &gt;&gt;yamasita@yklab.sei.co.jp (Yamashita Taiichirou) wrote:
  &gt;&gt;&gt; 
  &gt;&gt;&gt; いま、ユーザ pgsql (postgreSQL のスーパユーザです)で、destroydb を実行
  &gt;&gt;&gt; すると、mydb を消す事が出来ました。ということは、データベースを消去す
  &gt;&gt;&gt; る事は、スーパーユーザにしか出来ない、と言う事なのでしょうか？データベー
  &gt;&gt;&gt; スを作成した本人にも消せない、と言うのはちょっと、、、
  &gt;&gt;
  &gt;&gt;こちらでも試してみました。
  &gt;&gt;確かに pg_user クラスで usesuper がセットされていないユーザーでは
  &gt;&gt;destroydb ができないようですね... 
  &gt;&gt;
  &gt;&gt;# 仕様なのか何なのか ;-)
  &gt;&gt;
  &gt;&gt;
  &gt;&gt;解決方法としまして、
  &gt;&gt;postgreSQL のスーパーユーザーで
  &gt;&gt;
  &gt;&gt;	grant delete on pg_database to public;
  &gt;&gt;
  &gt;&gt;などとしても、問題はないと思いますがいかがでしょう?

それは、どのディレクトリで、どのような事をするのでしょうか？ grant 自
体は、postgreSQL のコマンドですよね、多分(マニュアルによる)。select と
かと同等ですね。ということは、データベース管理者になって、psql を立ち
上げて、そのプロンプト上で、上記文を入力するのですか？でも、psql を立
ち上げるためには何かのデータベースが必要ですし、そこには、pg_database 
はないですよね。どうやってアクセスするのでしょうか？

  &gt;&gt;&gt; ところで、ML の過去の記事を読んでいて、pg95perl (でしたっけ？)、が有る
  &gt;&gt;&gt; と言う事で、しかも、C ライクだそうで、C しか知らない私には有りがたい存
  &gt;&gt;&gt; 在のようなのですが、これってどこに有ります？
  &gt;&gt;
  &gt;&gt;配布パッケージのソースの下の、
  &gt;&gt;.../src/pg95perl5/ にあります :-)

これは、perl のソースは特に必要無いんですよね。README を読む限りそうで
すね。

とりあえず、遊んでみます。

以上
<HR>
</PRE>
<A NAME="2">
<PRE><B>
From: Mitsuhiro Maeda &lt;mitsu@tramp.co.jp&gt;
Date: Tue, 18 Mar 1997 14:24:06 +0900
Subject: [postgres95 1589] Re: I can't use &quot;CREATE TABLE weather&quot;.
Message-Id: &lt;199703180524.OAA29785@log.tramp.co.jp&gt;
</A>
</B></PRE>
<PRE>

おみつ@Tramp です。

On Tue, 18 Mar 1997 02:46:16 GMT
yamasita@yklab.sei.co.jp (Yamashita Taiichirou) wrote:
&gt; 
&gt;   &gt;&gt;あとは、インストールしたユーザーと initdb を実行したユーザーとが違うとか...??
&gt;   &gt;&gt;
&gt; 
&gt; いま、ユーザ pgsql (postgreSQL のスーパユーザです)で、destroydb を実行
&gt; すると、mydb を消す事が出来ました。ということは、データベースを消去す
&gt; る事は、スーパーユーザにしか出来ない、と言う事なのでしょうか？データベー
&gt; スを作成した本人にも消せない、と言うのはちょっと、、、

こちらでも試してみました。
確かに pg_user クラスで usesuper がセットされていないユーザーでは
destroydb ができないようですね... 

# 仕様なのか何なのか ;-)


解決方法としまして、
postgreSQL のスーパーユーザーで

	grant delete on pg_database to public;

などとしても、問題はないと思いますがいかがでしょう?

一応usecreatedb がセットされていないユーザーに関しましては、
createdb/destroydb ともに蹴られますし。
( public が恐ければ特定のユーザーにでも :-)

&gt; ＃ではなぜ、/usr/local/pgsql/src/tutorial/basic.sql が動作しないのでしょ
&gt; ＃う。
これも、やってみました :-)

どうも、(Postgres95 までは大丈夫だったのですけど...)
1つのクエリ要求には、1つのクエリしかできないみたいですね。

つまり、basics.sql の内容で、
CREATE TABLE weather (
        city            varchar(80),
        temp_lo         int,            -- low temperature
        temp_hi         int,            -- high temperature
        prcp            float8,         -- precipitation
        date            date
)
^^
ここを、
);
^^
として、クエリが完結するようにすればいいかと思います。

basics.sql 中の修正箇所は、3箇所だけですので、
手動でできると思います。

 行
l.26 CREATE TABLE weather ...
l.43 INSERT INTO weather ...
l.53 INSERT INTO weather ... 

&gt; ところで、ML の過去の記事を読んでいて、pg95perl (でしたっけ？)、が有る
&gt; と言う事で、しかも、C ライクだそうで、C しか知らない私には有りがたい存
&gt; 在のようなのですが、これってどこに有ります？

配布パッケージのソースの下の、
.../src/pg95perl5/ にあります :-)

== おみつ

<HR>
</PRE>
<A NAME="1">
<PRE><B>
From: yamasita@yklab.sei.co.jp (Yamashita Taiichirou)
Date: Tue, 18 Mar 1997 02:46:16 GMT
Subject: [postgres95 1588] Re: I can't use &quot;CREATE TABLE weather&quot;.
Message-Id: &lt;199703180246.CAA10329@spider.yklab.sei.co.jp&gt;
</A>
</B></PRE>
<PRE>

&lt;199703170944.SAA28440@log.tramp.co.jp&gt;の記事において
JST時間1997年03月17日(月)18時44分10秒頃、mitsu@tramp.co.jpさんは書きました。

  &gt;&gt;おみつ@Tramp です。

山下＠住電です。

  &gt;&gt;&gt;   &gt;&gt;「psql template1」 として接続できるかどうか試してはいかがでしょう。
  &gt;&gt;&gt; 
  &gt;&gt;&gt; これは当然のように接続できました。
  &gt;&gt;&gt; 
  &gt;&gt;&gt; が、destroydb がけられます。pg_database が無いので消せません、と言われ
  &gt;&gt;&gt; ます。これはなぜでしょうか？
  &gt;&gt;
  &gt;&gt;/usr/local/pgsql/data 以下にはどのようなファイルがあるのでしょうか。
  &gt;&gt;もし pg_database というファイルがないとなれば、
  &gt;&gt;インストールの失敗ということになるかと思います。
  &gt;&gt;
  &gt;&gt;ちなみにここには、
  &gt;&gt;
  &gt;&gt;PG_VERSION   pg_database  pg_demon     pg_hba.conf
  &gt;&gt;pg_log       pg_server    pg_user      pg_defaults
  &gt;&gt;pg_group     pg_hosts     pg_magic     pg_time      
  &gt;&gt;pg_variable
  &gt;&gt;
  &gt;&gt;というファイルと、baseというディレクトリがあります。

それはすべて揃っています。

  &gt;&gt;あとは、インストールしたユーザーと initdb を実行したユーザーとが違うとか...??
  &gt;&gt;

いま、ユーザ pgsql (postgreSQL のスーパユーザです)で、destroydb を実行
すると、mydb を消す事が出来ました。ということは、データベースを消去す
る事は、スーパーユーザにしか出来ない、と言う事なのでしょうか？データベー
スを作成した本人にも消せない、と言うのはちょっと、、、

  &gt;&gt;# むむむ... 私のところでは、Linux kernel 2.0.27, 1.2.13 両方とも 
  &gt;&gt;# make 一発でうまく行ってしまいましたので、結構 ??? な気分です...

ということで、destroydb に関しては上記のような動作が正しいのであれば、
やはり私も make 一発でうまく行っている、と言う事です。

＃ではなぜ、/usr/local/pgsql/src/tutorial/basic.sql が動作しないのでしょ
＃う。

ところで、ML の過去の記事を読んでいて、pg95perl (でしたっけ？)、が有る
と言う事で、しかも、C ライクだそうで、C しか知らない私には有りがたい存
在のようなのですが、これってどこに有ります？

＃とりあえず、あとは、apache と PHP/FI を組み込んで、かつ、perl 5.00* 
＃を取って来るだけ。はー。

以上
<HR>
</PRE>
<A NAME="0">
<PRE><B>
From: Satoshi Ishikawa &lt;power@sekine.densi.gifu-u.ac.jp&gt;
Date: Tue, 18 Mar 1997 09:56:24 +0900
Subject: [postgres95 1587] Re: query 32 (Re: Benchmark test)
Message-Id: &lt;199703180056.JAA23254@sekine.densi.gifu-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

いしかわ＠ぎふだいです

t-ishii&gt; &gt;でも、Linuxはplatformに関係なく query32 遅いんですよねぇ。
t-ishii&gt; &gt;
t-ishii&gt; &gt;Linux自体からくる遅さなのか、postgreSQLのコードからくるのかなぁ
t-ishii&gt; 
t-ishii&gt; あれから調べてみたところ、bench mark script のバグ（というか、予期せぬ
t-ishii&gt; データが入った）のと Linux 特有の time コマンドの出力フォーマットがが
t-ishii&gt; 原因で Linux に限って不当に:-)query 32 の結果が悪く出てることがわかり
t-ishii&gt; ました。つまり、ベンチマークのスクリプトである perquery では、

いつもいつも、ごくろうさまです。
私にはここまで原因を追求する根性はありませんが、

t-ishii&gt; もし今から修正データを申告する根性のある方は、runwisc.sh の最後にある

これぐらいの根性はあります;-)。
なるべく負荷はかけないようにしてあります。

Linux/SparcClassic(MicroSPARC 50MHz) 32MB RAM + アサーション
なし + JP patch です

query  0:   0.003 real   0.000 user   0.000 sys
query  1:   0.884 real   0.820 user   0.040 sys
query  2:   4.002 real   2.440 user   0.670 sys
query  3:   0.761 real   0.730 user   0.040 sys
query  4:   3.800 real   2.370 user   0.730 sys
query  5:   0.799 real   0.760 user   0.030 sys
query  6:   2.247 real   2.140 user   0.110 sys
query  7:   0.112 real   0.100 user   0.020 sys
query  8:   1.653 real   1.580 user   0.060 sys
query  9:  23.825 real  20.540 user   0.740 sys
query 10:  20.298 real  18.260 user   0.510 sys
query 11:  11.828 real  10.970 user   0.270 sys
query 12:  23.605 real  20.530 user   0.900 sys
query 13:  20.205 real  18.320 user   0.400 sys
query 14:  11.929 real  11.040 user   0.180 sys
query 15:  25.003 real  21.080 user   1.430 sys
query 16:  20.378 real  18.410 user   0.520 sys
query 17:  15.559 real  11.560 user   1.740 sys
query 18:  11.561 real   9.730 user   0.740 sys
query 19:   1.906 real   1.820 user   0.100 sys
query 20:   0.003 real   0.000 user   0.000 sys
query 21:   0.003 real   0.000 user   0.000 sys
query 22:   0.003 real   0.010 user   0.000 sys
query 23:   0.003 real   0.010 user   0.000 sys
query 24:   0.003 real   0.010 user   0.000 sys
query 25:   0.003 real   0.010 user   0.000 sys
query 26:   0.003 real   0.000 user   0.000 sys
query 27:   0.047 real   0.040 user   0.020 sys
query 28:   0.196 real   0.180 user   0.000 sys
query 29:   0.003 real   0.000 user   0.000 sys
query 30:   0.040 real   0.030 user   0.000 sys
query 31:   0.155 real   0.150 user   0.000 sys
query 32:   0.151 real   0.140 user   0.010 sys


End Of Message.  
----- ----- ----- ----- ----- ----- ----- ----- ----- ----- -----
石川 諭 （いしかわ さとし）power@densi.gifu-u.ac.jp
Key fingerprint = 53 12 86 DF BF 21 6D BE  DC A4 7B 31 C0 8D E2 F9

<HR>
</PRE>
