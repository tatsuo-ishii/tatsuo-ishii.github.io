<A NAME="5">
<PRE><B>
From: sakamoto@cec.co.jp (Kazuki Sakamoto)
Date: Mon, 17 Feb 97 17:05:18 JST
Subject: [postgres95 1396] Re: [Q}PHP/FI &amp; postgres Ver6.0
Message-Id: &lt;9702170805.AA15603@mugi.cec.co.jp&gt;
</A>
</B></PRE>
<PRE>

坂本＠中央電子です。

&lt;9702170602.AA00117@mebius.air.akita-u.ac.jp&gt;の記事にて
1997年02月17日(月)、yoshio@Air.akita-u.ac.jpさんの記述は:
 &gt; で、ご質問なんですが、Ver6.0のpostgreSQLはPHP/FI対応なんでしょうか？
 &gt; やっと苦労してpostgres95 Ver1.09+jp.patchでPHP/FIからアクセスできる
 &gt; 環境を構築したと思ったらpostgres Ver6.0・・・

試しにpostgres95 Ver1.07(だったかな)を、
postgreSQL Ver6.0 + jp.patch に置き換えてみましたけど、そのまんま動きました。

PHP/FIのバージョンは2.0b8です。
PHP/FIのスクリプトも、postgreSQLにデータをつっこむスクリプトも、
全部そのまんまで、特に問題は出てないです(多分)。

# PHP/FIの新しいのも試してみなければ…

sakamoto@cec.co.jp
<HR>
</PRE>
<A NAME="4">
<PRE><B>
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
Date: Mon, 17 Feb 1997 17:04:24 +0900
Subject: [postgres95 1395] Re: [Q}PHP/FI &amp; postgres Ver6.0 
Message-Id: &lt;199702170804.RAA15472@srashd.sra.co.jp&gt;
</A>
</B></PRE>
<PRE>

石井です。

&gt;船木＠秋田県立図書館です。
&gt;巷では、postgres6.0のベンチマークが話題になっているようですが
&gt;PC9801BX2+DX4 ODP75Mhzじゃ比べようと言う気にもならないんで・・・・

そう言わずにお願いします:-)

&gt;で、ご質問なんですが、Ver6.0のpostgreSQLはPHP/FI対応なんでしょうか？
&gt;やっと苦労してpostgres95 Ver1.09+jp.patchでPHP/FIからアクセスできる
&gt;環境を構築したと思ったらpostgres Ver6.0・・・

以前別のメールでお知らせしたように、

	MkLinux DR2 + postgresql 6.0 (with JP patch) + apache-1.1.1 +
	PHP/FI-2.0b10 + kanji2.0b10.patch

で動いています。作り方も 1.09 と一緒です。多分他の環境でも問題ないでしょ
う。

&gt;apache+PHP/FI+postgres95という環境はけっこう強力で、私の考えていた
&gt;理想の姿に近いのですが、悲しい性ともうしましょうか、新しいバージョンが出ると
&gt;どうしてもそちらの方が気になってしまうので・・・・

特におみつさんの日本語対応 PHP/FI との組合せは最強と言えましょう:-)
---
t-ishii@sra.co.jp	石井達夫
（株）ＳＲＡ
<HR>
</PRE>
<A NAME="3">
<PRE><B>
From: Yoshio Funaki &lt;yoshio@Air.akita-u.ac.jp&gt;
Date: Mon, 17 Feb 1997 15:02:39 +0900
Subject: [postgres95 1394] [Q}PHP/FI &amp; postgres Ver6.0
Message-Id: &lt;9702170602.AA00117@mebius.air.akita-u.ac.jp&gt;
</A>
</B></PRE>
<PRE>

船木＠秋田県立図書館です。
巷では、postgres6.0のベンチマークが話題になっているようですが
PC9801BX2+DX4 ODP75Mhzじゃ比べようと言う気にもならないんで・・・・

で、ご質問なんですが、Ver6.0のpostgreSQLはPHP/FI対応なんでしょうか？
やっと苦労してpostgres95 Ver1.09+jp.patchでPHP/FIからアクセスできる
環境を構築したと思ったらpostgres Ver6.0・・・

apache+PHP/FI+postgres95という環境はけっこう強力で、私の考えていた
理想の姿に近いのですが、悲しい性ともうしましょうか、新しいバージョンが出ると
どうしてもそちらの方が気になってしまうので・・・・

よろしくご教示下さい。

船木　喜夫　yoshio@air.akita-u.ac.jp

<HR>
</PRE>
<A NAME="2">
<PRE><B>
From: Tatsuo Ishii &lt;t-ishii@sra.co.jp&gt;
Date: Mon, 17 Feb 1997 16:09:54 +0900
Subject: [postgres95 1393] Re: [Q] table design 
Message-Id: &lt;199702170709.QAA14465@srashd.sra.co.jp&gt;
</A>
</B></PRE>
<PRE>

石井です。

&gt;田仲@ケイケンです。

&gt;データベースのメーリングリスト db_ml に出てきそうな質問です
&gt;ね。あやうく、「使用しているDBはなんですか」と書いて顰蹙を買
&gt;うところでした。

受けました、これ:-)

&gt;kane&gt; にしてしまうと、材料A と 材料B を使っている製品は？との問で
&gt;
&gt;これには、
&gt;38* select distinct 製品名 from 使用材料 where 材料名 = 'a' or 材料名 = 'b' ;
&gt;製品名
&gt;
&gt;A
&gt;B
&gt;
&gt;ですね。

これだと、材料A だけ、あるいは材料B だけを使っている製品も引っかかって
しまいますね。元の質問の意図は、「材料Aと材料Bの両方を使っている製品」
だと思いますが。

&gt;ほんとは「材料名 in ('a', 'b')」と書きたいところです
&gt;が postgres には in とか、リストを返す関数は無いですね(ほん
&gt;とかな?)。

postgresql6.0 から in もサポートされています。

&gt;なお、postgres で試した時は、&lt;= や &gt;= がfloat8型をサポートし
&gt;てない、というようなエラーが出ました。演算子のテーブルを見た
&gt;ら、float4 &lt;= float8 のように使うらしい(なぜ ?_?)。

これも 6.0 では直ってると思いますよ。
---
t-ishii@sra.co.jp	石井達夫
（株）ＳＲＡ
<HR>
</PRE>
<A NAME="1">
<PRE><B>
From: &quot;Yukihiko Noguchi&quot; &lt;nog@dragon.osaka.ish.cae.ntt.jp&gt;
Date: Mon, 17 Feb 1997 12:15:58 +0900
Subject: [postgres95 1392] (No Subject in original)
Message-Id: &lt;199702170309.MAA18388@dragon.osaka.ish.cae.ntt.jp&gt;
</A>
</B></PRE>
<PRE>

#guide

<HR>
</PRE>
<A NAME="0">
<PRE><B>
From: Tanaka Minoru &lt;green@keiken.co.jp&gt;
Date: Sat, 15 Feb 1997 19:39:21 +0900
Subject: [postgres95 1391] Re: [Q] table design 
Message-Id: &lt;9702151039.AA01138@onbashira&gt;
</A>
</B></PRE>
<PRE>

田仲@ケイケンです。
最近、postgres使う暇がなくて悲しい。

Hideki KANEBAKO &lt;kane@kane.shimosuwa.nagano.jp&gt;さん：
kane&gt; 金箱と申します。
kane&gt; 
kane&gt; SQL はまだ始めたばかりです。

データベースのメーリングリスト db_ml に出てきそうな質問です
ね。あやうく、「使用しているDBはなんですか」と書いて顰蹙を買
うところでした。

kane&gt; いま、製品とそこに使われている材料およびその使用量のデータベースを
kane&gt; 作ろうと思っているのですが、どのようなテーブルにしたらよいのか悩んでい
kane&gt; ます。
...
kane&gt; このような要求にはどのように TABLE を構成したら良いのでしょう？
kane&gt; 
kane&gt; どなたかアドバイスお願いします。

postgres(バージョンがえらく古いまま)で試そうとしたのですが、いろい
ろ引っかかってしまったので、別のでやってみました。

テーブル構成は、「製品」と「材料」と「使用材料(製品構成? 材
料構成?)」に分けるのが普通だと思います。


32* display 製品;
***  Table: 製品  ***

  Attributes:
    名                                char(10,1)

33* display 使用材料;
***  Table: 使用材料  ***

  Attributes:
    製品名                            char(10,1)
    材料名                            char(10,1)
    使用量                            int

材料テーブルは、省略しました。説明抜きでカット&amp;ペーストして
ますけど、だいたい意味わかりますよね ^_^;)

テーブル内容は、以下のとおりです。

34* select from 製品;
名

A
B

35* select from 使用材料;
製品名      材料名      使用量

A           a               10
A           b               10
A           c               10
B           a               50
B           c                5
B           d                5
B           e                5


kane&gt; にしてしまうと、材料A と 材料B を使っている製品は？との問で

これには、
38* select distinct 製品名 from 使用材料 where 材料名 = 'a' or 材料名 = 'b' ;
製品名

A
B

ですね。ほんとは「材料名 in ('a', 'b')」と書きたいところです
が postgres には in とか、リストを返す関数は無いですね(ほん
とかな?)。

kane&gt; このデータベースでは主に、材料A をxxx以上、材料C をxxx以下使っている
kane&gt; 製品は？ との問に答えたいのです。

こちらは次のようにしてみました(複雑…)。

39* select 名 from 製品
      where
      exists ( select 材料名 from 使用材料 
                where 製品名 = 製品.名 and 材料名 = 'a' and 使用量 &gt;= 30)
      and 
      exists ( select 材料名 from 使用材料 
                where 製品名 = 製品.名 and 材料名 = 'c' and 使用量 &lt;= 10) ;

名

B

もっと他にもやりかたがあるかも知れません。この方法を 
postgres でやるには上のサブセレクトのところを関数にする必要
がありますね。
	exists ( select ...) 
というのは 
	0 &lt; ( select count ... )
というのと同じ(選択条件に合致するものが存在する)です。

おっと、馬目さんのメールが…
MANOME Tomonori &lt;manome@itlb.te.noda.sut.ac.jp&gt;さん：
manome&gt; 馬目％訂正です。
...
manome&gt; このような問い合わせであれば、元のテーブルのままで、テーブル
manome&gt; 自己自身とのジョインをとってやればいいと思います。
manome&gt; 
manome&gt; SELECT a.product FROM Samples a, Samples b
manome&gt;      WHERE a.product = b.product
manome&gt;        AND a.material = '材料A'
manome&gt;        AND a.quantity &gt;= ?????
manome&gt;        AND b.material = '材料C'
manome&gt;        AND b.quantity &lt;= ?????;
manome&gt; 
manome&gt; です。

やってみました。

43* run;
select a.製品名 from 使用材料 a, 使用材料 b
where
a.製品名 = b.製品名
and a.材料名 = 'a' and a.使用量 &gt;= 30
and b.材料名 = 'c' and b.使用量 &lt;= 10 ;

製品名

B

はい、OKです。実は、この方法も試したんだけどうまくできません
でした(修行が足りん!)。この方が、余計な手間がなくてすっきり
してますね。比較する「材料」が増えると、ちょっと複雑かな(負
け惜しみ)。

なお、postgres で試した時は、&lt;= や &gt;= がfloat8型をサポートし
てない、というようなエラーが出ました。演算子のテーブルを見た
ら、float4 &lt;= float8 のように使うらしい(なぜ ?_?)。
-
田仲 稔 (Tanaka Minoru)  （株）ケイケンエンジニアリングシステム 諏訪支社

<HR>
</PRE>
