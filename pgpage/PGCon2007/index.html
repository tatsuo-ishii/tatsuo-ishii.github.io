<h1>PostgreSQL Conference 2007参加レポート</h1>
<p>
by 石井達夫(ishii at postgresql.org)
</p>
<p>
5月21日から24日にかけて，2回目になるPostgreSQLコンファレンスがカナダの
オタワで開催された．昨年はカナダのトロントだったので，これで2回続けて
カナダで開催されたことになる．
</p>

<p>
オタワはカナダの首都だが，人口は81万人ほどで，日本で言えば地方都市程度
の規模の街だ．中心部は十分歩いて回ることができ，散策ついでに街の中心を
流れるリドー運河やオタワ川の風景をゆっくりと楽しむことができる．市内に
は古い建物が多く，その代表格は国会議事堂だ．
</p>
<p>
<a href="dscn3822.jpg"><img src="small-dscn3822.jpg"></a>
写真1: オタワ川の対岸から国会議事堂の建物をのぞむ
</p>

<p>
コンファレンスが行われたのはオタワの中心部に程近いオタワ大学．キャンパ
スは緑が多く，なかなかよい環境のようだ．オタワは自転車道が充実している
せいか，自転車に乗っている人を多く見掛ける．走る場所がなく，自転車が歩
道通行を強いられている日本とは雲泥の差だ．環境に優しい自転車の積極利用
について，もう少し日本の政治家が真剣に考えてくれれば良いのだが...
</p>

<p>
<a href="dscn3620.jpg"><img src="small-dscn3620.jpg"></a>
写真2: キャンパスの中を自転車でさっそうと移動する学生
</p>

<p>
コンファレンスのすべてのセッションはカフェテリアがある建物の会議室で行
われた．カフェテリアには無線LANと電源が設置，会議室も無線LANが完備して
いて，快適この上ない環境だ．
</p>
<p>
<a href="dscn3623.jpg"><img src="small-dscn3623.jpg"></a>
写真3: コンファレンス会場に設定されたSITEビルの外観
</p>

<p>
コンファレンスで受付を済ますと，バッグやTシャツなどのグッズが渡さ
れる．外国のコンファレンスではこれが結構楽しみ．
</p>

<p>
<a href="dscn3915.jpg"><img src="small-dscn3915.jpg"></a>
写真4: コンファレンスでの「収穫」物
</p>

<p>
今回は手提げ袋とTシャツがメインだった．その他Googlから提供されたメモ帳
などもあった．更に直前まで開催していたBSDConの手提げ袋やボールペンも頂
いてしまった(PGConの主催者のDan氏は，地元カナダのBSDコミュニティの大
物で，BSDConの主催者でもある)．
</p>
<p>
<a href="dscn3917.jpg"><img src="small-dscn3917.jpg"></a>
写真5: PGConとBSDConで配布されたボールペンの数々．一番上のアイスブルー
がPGCon，それ以外は歴代のBSDConで配布されたものらしい
</p>

<p>
<a href="dscn3916.jpg"><img src="small-dscn3916.jpg"></a>
写真6: Tシャツの裏には講演者の名前が入る．三谷氏の名前も見える
</p>

<p>
日本から日本PostgreSQLユーザ会の理事が何名か参加しており，理事の方々が
持参された会報や「カメシール」も受付で配布されていた．
</p>

<p>
<a href="dscn3640.jpg"><img src="small-dscn3640.jpg"></a>
写真7: 受付で配布されたカメシール
</p>

<h2>基調講演</h2>
<p>
筆者は23日と24日のセミナーセッションに参加した(21と22日はチュートリア
ル)．23日はコアメンバーの一人Bruce Momjian氏の基調講演で幕を開けた．ご
存じのように，氏は一貫してPostgreSQL開発プロジェクトのコーディネータ的
役割を果たしており，今回の講演では人類の月着陸のビデオを引用しながら，
PostgreSQLのような大規模プロジェクトの運営の難しさを歴史を追って解説し
ていた．
</p>
<p>
基調講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/30-great_steps.pdf">こちら</a>
</p>
<p>
<a href="dscn3627.jpg"><img src="small-dscn3627.jpg"></a>
写真8: 基調講演を行うBruce Momjian氏
</p>

<p>
基調講演の後は，セッションは2トラックに別れ，聞きたいものをチョイスす
ることになる．
</p>

<h2>SMPシステムにおけるPostgreSQLのスケーラビリティ</h2>
<p>
PostgreSQLは近年エンタープライズ向の性能改良が著しく，とくに8.1以降の
SMP(Symmetrical Multi Processor)システムにおけるスケーラビリティの向上
には目を見張るものがある．UNISYSのDoug Tolbert氏によって行われた
"Scaling PostgreSQL on SMP Architectures -- An Update"と題したセッショ
ンでは，UNISYSの大型Linuxシステム(32プロセッサ)での8.0，8.1，8.2での
SMP性能の向上を検証していた．また，PostgreSQL 8.2をベースに，UNISYSが
独自に改良を行ったバージョンの性能について解説していた．
</p>
<p>
<a href="dscn3630.jpg"><img src="small-dscn3630.jpg"></a>
写真9: PostgreSQLのスケーラビリティについて講演を行うDoug Tolvert氏
</p>
<p>
UNISYSの行った改良はハードウェアに依存する部分もあるので，どこまで一般
的に適用できるのかは未知数の部分もあるが，今後オープンソースで公開され
る予定もあるとのことで，期待したい．
</p>
<p>
講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/22-Scaling%20PostgreSQL%20on%20SMP%20Architectures%20--%20An%20Update">こちら</a>で公開されている．
</p>

<h2>PostgreSQLのレプリケーションサベイ</h2>
<p>
"PostgreSQL replication strategies: Understanding High Availability
and choosing the right solution"と題したEmmanuel Cecchet氏による講演．
</p>
<p>
<a href="dscn3644.jpg"><img src="small-dscn3644.jpg"></a>
写真10: PostgreSQLのレプリケーションについて講演を行うEmmanuel Cecchet氏
</p>

<p>
現在手に入る代表的なPostgreSQLのオープンソースクラスタ／レプリケーショ
ンソリューションである，pgpool，pgpool-II，PGCluster，PGCluster-II，
Slony-I，Sequoiaについて横ならびで比較し，目的に応じて適切なソリューショ
ンを選択する手助けにしてもらう，という主旨の講演だ．こうしてみると，取
り上げられた6つのソフトのうち4つまでが日本発のソフトで，ちょっぴり誇ら
しい気持になった．
</p>
<p>
セミナーの聴衆には一般ユーザだけでなく，それぞれのソフトの開発者も多数
見受けられた．"Add node on the fly"(クラスタを構成するDBノードを動的に
追加できるかどうか) の説明に対してPGCluster開発者の三谷氏が自ら突っ込
みを入れ，その場(on the fly)で講演者がOHPを修正する一幕もあり，多いに
会場は盛り上がっていた．
</p>
<p>
講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/19-20070523Cecchet_PGCon2007.pdf">こちら</a>で公開されている．

<h2>コンファレンスの食料事情</h2>
<p>
外国のコンファレンスでは飲み物や軽食が提供されることが多い．今回のコン
ファレンスでは，朝と午後に飲み物，昼はランチボックスが配布された．朝食
は各自調達となるが，今回は大学のカフェテリアが利用できる環境だったので，
朝食をカフェテリアで頂いた．とても感じの良い女性シェフが丁寧に作ってく
れた朝食を頬張りつつ，無線LAN経由でメールを取り込み，今日のセッション
の受講計画を立てた．
</p>
<p>
<a href="dscn3677.jpg"><img src="small-dscn3677.jpg"></a>
写真11: 笑顔のすてきなカフェテリアの女性シェフ
</p>
<p>
<a href="dscn3678.jpg"><img src="small-dscn3678.jpg"></a>
写真12: 彼女が作ってくれた朝食
</p>

<p>
初日の夕食はEnterpriseDB社提供のディナーパーティがダウンタウンで開催さ
れたので，筆者も参加した．

おそらく100人近くもの人が参加した大規模なパーティーで，大変な盛況だっ
た．
</p>
<p>
この会場でたまたま前の席に座っていたのがJeff Davis氏．

本家のメーリングリストでは時々みかけるが，お会いするのははじめて．最近
は8.3に向けて"Synchronized Scan"というアイデアを実装中である．
</p>
<p>
<a href="dscn3674.jpg"><img src="small-dscn3674.jpg"></a>
写真13: Synchronized Scanの開発者Jeff Davis氏．日本から持参したシーラカンスをプレゼントした．
最近はpgpoolの開発メーリングリストにも顔を出している．
</p>
<p>
複数のセッションからバッファに乗りきれないような大きなテーブルを順スキャ
ンすると，それぞれのセッションが少ないバッファを奪い合う形になり性能が
出ない．そこでそのような場合にお互いに協調することによって，バッファを
効率よく使おうと言うのが"Synchronized Scan"のアイデアだ．たとえば，あ
るセッションでテーブルの1/4 を読み込んでいたら，別のセッションではその
後から読み込むことにして，お互いに読み込み済のデータをうまく活用しよう
というアイデアである．
</p>
<p>
これを考えたDavis氏はPostgreSQL歴こそ6年位だが，すごいのは最初に
PostgreSQLに出会ったのが19歳だったというところ．このような若手がばりば
りPostgreSQLのエンジンを改良するようなコードを書いているところに欧米の
開発者の層の厚さを感じる．
</p>

<h2>2日目のセッション</h2>

<h2>PostgreSQLのXML対応</h2>
<p>
PGConの最終日24日はまず，"The Road to the XML Type" というセッションに
参加した．発表はPostgreSQLのコアメンバであるPeter Eisentraut氏と，開発
者のNikolay Samokhvalov氏によって行われた．これはPostgreSQL 8.3に向け
て開発されているXML対応の現状報告である．
</p>
<p>
<a href="dscn3704.jpg"><img src="small-dscn3704.jpg"></a>
写真14: PostgreSQLのXML対応に関する講演を行うPeter Eisentraut氏(写真左)
と，Nikolay Samokhvalov氏(右)
</p>

<p>
PostgreSQL 8.3では，以下のようなXML対応が行われる予定である．
</p>
<p>
<ul>
<li>SQL:2003のXML機能(ISO/IEC 9075-14)のサポート
<li>XPathサポート(libxml2が必要)
</ul>
</p>

<p>
これらの機能がサポートされることにより，テーブル定義やデータをXMLの形
で出力したり，XMLデータのエレメントに対して問い合わせを発行することが
できるようになる．ただし，XQueryのサポートはまだのようだ．
</p>
<p>講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/15-roadtoxmltype.pdf">こちら</a>で公開されている．

<h2>PostgreSQLでストリームデータベース</h2>
<p>
最近のデータベース界の「流行り」の一つに「ストリームデータベース」とい
うものがある．ストリームデータベースとは，簡単に言うとデータをハードディ
スクなどの記憶装置に蓄積することなくデータ検索を可能にする仕組みである．
検索言語にはSQLを少し拡張したものを使う．
</p>
<p>
たとえば，以下のような問い合わせでは，過去1秒間の株式の取引額の総額が
連続的に表示される．
</p>
<pre>
SELECT sum(volume) AS volume, advance_agg(qtime) AS windowtime
FROM trades < VISIBLE '1 second' ADVANCE '1 second';
</pre>
<p>
ストリームデータベースでは，大量のデータが高速に入力され，一定時間メモ
リ上に蓄えられては捨てられていく．ストリームデータベースを使えば，そう
したデータに対して，繰り返し問い合わせを行い，あらかじめ設定された条件
を満たしたときに一定のアクションを起す(たとえばある銘柄の株を買う)よう
なシステムが容易に構築できる．
</p>
<p>
ストリームデータベースは，株式の取引データや，センサーからの入力を扱う
ような用途に向いている．
</p>
<p>
本講演では，PostgreSQL開発者のNeil Conway氏が，PostgreSQLをベースに，
ストリームデータベースを実装した報告が行われた．このような試みはおそら
く世界ではじめてであろう．とても興味深く聴講した．
</p>
<p>
<a href="dscn3705.jpg"><img src="small-dscn3705.jpg"></a>
写真15: ストリームデータベースに関する講演を行うNeil Conway氏
</p>
<p>
講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/17-stream_intro.pdf">こちら</a>で公開されている．
</p>

<h2>PGCluster</h2>
<p>
共有ディスクを前提とした新しいPGClusterの開発報告である．各々独立した
ディスク装置を前提としたクラスタに比べると，検索性能だけでなく，更新性
能の向上も期待できると言う．
</p>
<p>
<a href="dscn3750.jpg"><img src="small-dscn3750.jpg"></a>
写真16: PGClusterに関する講演を行う三谷氏
</p>
<p>
講演資料は<a href="http://www.pgcon.org/2007/schedule/attachments/26-pgcluster2pgcon.pdf">こちら</a>で公開されている．

<h2>クロージング</h2>
<p>
PGConの締めくくりは，主催者のDan Langille氏が行った．まず書籍や余った
グッズが競りにかけられた．会場に置き忘れられたジャケットが競りにかけら
れ，持ち主が買い戻す一幕もあって，ユーモアに溢れた楽しいクロージングに
なった．
</p>
<p>
<a href="dscn3803.jpg"><img src="small-dscn3803.jpg"></a>
写真17: クロージングを行うDan Langille氏

<h2>最後に</h2>
<p>
今回で2回目を迎えたPostgreSQL Conferenceだが，開発者のためのお祭りと
いう性格は変っていない．開発者は確実に増えており，また若い世代がどんど
ん参加してPostgreSQLの開発を本当に楽しんでいることが実感として感じられ，
とてもたのもしく思えた．
</p>
<p>
日本で行われているような，PostgreSQLの使い方や管理，DBアプリケーション
の開発に関するセミナーもそれはそれで重要だと思うが，できれば日本でも
PostgreSQL Conferenceのような，開発者向のイベントが欲しいと切に思った．
そうしたコンファレンスに参加した若手が刺激を受けて，次世代のPostgreSQL 
を担っていくようになれば最高だ．
</p>
